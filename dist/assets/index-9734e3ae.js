import{_ as e}from"./VModal.vue_vue_type_style_index_0_lang-b0507e96.js";import{_ as t}from"./SubmitButton.vue_vue_type_script_setup_true_lang-e5001c63.js";import{_ as a}from"./VFlex.vue_vue_type_style_index_0_lang-0938e556.js";import{_ as l}from"./VInput.vue_vue_type_script_setup_true_lang-29181b77.js";import{_ as n}from"./VFlexItem.vue_vue_type_style_index_0_lang-ff50e60d.js";import{_ as s,a as o}from"./VControl-fc151345.js";import{_ as i}from"./IMaskDateInput.vue_vue_type_script_setup_true_lang-5ce26ef4.js";import{a as r,b as u,r as d,o as p,w as _,s as m,l as c,t as v,q as y,Q as g,V as b,X as f,p as h,v as j,u as V,c as x,ac as $,m as D,y as w,M as k,W as M,i as O,$ as F,a0 as S}from"./chunk-BGPNDDXN-dcda8805.js";import{m as C}from"./moment-e00bdeae.js";import{u as U}from"./chunk-3UEUFEGV-d557e6b1.js";import{u as Y}from"./useNotyf-1536ae84.js";import{g as P}from"./additional-e5508e19.js";import{s as B,p as I}from"./index-423938b0.js";import{_ as N,a as q,b as A}from"./VFlexTable.vue_vue_type_style_index_0_lang-f8ff2f75.js";import{_ as L,a as z,b as E,c as G,d as Q}from"./search-7-dark-f0facebe.js";import{_ as T}from"./VCard.vue_vue_type_script_setup_true_lang-a9232da9.js";import{_ as W}from"./VButton.vue_vue_type_style_index_0_lang-27d6885c.js";import{p as X}from"./patient-3eef0e53.js";import{_ as H}from"./VBreadcrumb.vue_vue_type_style_index_0_lang-d3c7c667.js";import{u as R}from"./chunk-DRAQDPQ2-4514f14e.js";import{f as J}from"./@vueuse_core-098eb702.js";import{u as K}from"./@vueuse_head-0d019878.js";import{u as Z}from"./main-a3a6220c.js";import{u as ee}from"./viewWrapper-c60f0ce7.js";import{_ as te}from"./_plugin-vue_export-helper-1b428a4d.js";import"./VIMaskInput.vue_vue_type_script_lang-06d40a07.js";import"./userSession-0c0e9684.js";import"./pinia-3af6ce52.js";import"./VPlaceload-2a65ae53.js";const ae={class:"columns"},le={class:"column"},ne={class:"is-size-5 has-text-weight-medium"},se={class:"column"},oe={class:"is-size-5 has-text-weight-medium"},ie={class:"table"},re=["onSubmit"],ue={class:"is-size-5 has-text-weight-medium"},de={class:"table is-fullwidth"},pe={class:"help has-text-danger"},_e={class:"help has-text-danger"},me={class:"help has-text-danger"},ce=C.__esModule?C.default:C,ve=r({__name:"PrimaryScreeningFormModal",props:{isOpen:{type:Boolean,default:!1},patient:null},emits:["update:isOpen","update:list"],setup(r,{emit:V}){const x=r,$=Y(),{t:D}=U(),w=u(D("Primary_screening_form")),k=u(!1),M=u([]),O=u([{value:"normal",label:D("Normal")},{value:"below_normal",label:D("Below_normal")},{value:"above_normal",label:D("Above_normal")}]),F=d({date:ce().format("YYYY-MM-DD"),blood_type_id:null,type:"normal",value:""}),S=d({date:[],blood_type_id:[],type:[],value:[]});async function C(){var e,t,a,l,n,s;try{k.value=!0,await B(null==(t=null==(e=x.patient)?void 0:e.last_visit)?void 0:t.id,F),$.success(D("Data_saved_successfully")),V("update:list"),I()}catch(o){(null==(a=o.response)?void 0:a.data.error)?$.error(null==(l=o.response)?void 0:l.data.error):Object.assign(S,null==(s=null==(n=o.response)?void 0:n.data)?void 0:s.errors)}finally{k.value=!1}}function I(){Object.assign(F,{date:ce().format("YYYY-MM-DD"),blood_type_id:null,type:"normal",value:""}),Object.assign(S,{date:[],blood_type_id:[],type:[],value:[]}),V("update:isOpen",!1)}return p((async()=>{const e=await P();M.value=e.result})),_((()=>x.patient.last_visit),(e=>{e&&Object.assign(F,e)})),(u,d)=>{const p=i,_=s,V=o,x=m("Multiselect"),$=n,D=l,U=a,Y=t,P=e;return c(),v(P,{open:r.isOpen,size:"big",title:w.value,actions:"right",onClose:I},{content:y((()=>{var e;return[g("div",ae,[g("div",le,[g("h5",ne,b(u.$t("Information_about_donor"))+" # "+b(r.patient.id),1)]),g("div",se,[g("h5",oe,b(u.$t("Visit_date"))+": "+b(r.patient.created_at),1)])]),g("table",ie,[g("tbody",null,[g("tr",null,[g("th",null,b(u.$t("Last_name")),1),g("td",null,b(r.patient.last_name),1)]),g("tr",null,[g("th",null,b(u.$t("First_name")),1),g("td",null,b(r.patient.first_name),1)]),g("tr",null,[g("th",null,b(u.$t("Middlename")),1),g("td",null,b(r.patient.father_name),1)]),g("tr",null,[g("th",null,b(u.$t("Date-of-birth")),1),g("td",null,b(r.patient.birth_date),1)]),g("tr",null,[g("th",null,b(u.$t("Gender")),1),g("td",null,b(r.patient.gender),1)]),g("tr",null,[g("th",null,b(u.$t("Visit_type")),1),g("td",null,b(null==(e=r.patient.visit)?void 0:e.visit_type),1)]),g("tr",null,[g("th",null,b(u.$t("Donor_category")),1),g("td",null,b(r.patient.patient_category_id),1)]),g("tr",null,[g("th",null,b(u.$t("Passport_series_number")),1),g("td",null,b(r.patient.passport_series)+b(r.patient.passport_number)+", "+b(r.patient.issued_by)+", "+b(r.patient.when_issued),1)])])]),g("form",{id:"primary-screening-form",class:"modal-form",onSubmit:f(C,["prevent"])},[g("h5",ue,b(u.$t("Primary_screening_results")),1),g("table",de,[g("tbody",null,[g("tr",null,[g("th",null,b(u.$t("Date_of_an_analysis")),1),g("td",null,[h(V,{required:""},{default:y((()=>[h(_,null,{default:y((()=>[h(p,{modelValue:F.date,"onUpdate:modelValue":d[0]||(d[0]=e=>F.date=e)},null,8,["modelValue"]),g("p",pe,b(S.date[0]),1)])),_:1})])),_:1})])]),g("tr",null,[g("th",null,b(u.$t("Preliminary_blood_type")),1),g("td",null,[h(V,{required:""},{default:y((()=>[h(_,null,{default:y((()=>[h(x,{modelValue:F.blood_type_id,"onUpdate:modelValue":d[1]||(d[1]=e=>F.blood_type_id=e),options:M.value,placeholder:u.$t("Select"),"value-prop":"id"},null,8,["modelValue","options","placeholder"]),g("p",_e,b(S.blood_type_id[0]),1)])),_:1})])),_:1})])]),g("tr",null,[g("th",null,b(u.$t("Hemoglobin")),1),g("td",null,[h(V,{required:""},{default:y((()=>[h(_,null,{default:y((()=>[h(U,{"column-gap":"1rem","align-items":"center"},{default:y((()=>[h($,{"flex-grow":1},{default:y((()=>[h(x,{modelValue:F.type,"onUpdate:modelValue":d[2]||(d[2]=e=>F.type=e),options:O.value},null,8,["modelValue","options"])])),_:1}),h($,null,{default:y((()=>[h(D,{modelValue:F.value,"onUpdate:modelValue":d[3]||(d[3]=e=>F.value=e),type:"text"},null,8,["modelValue"])])),_:1}),h($,null,{default:y((()=>[j(b(u.$t("g/l")),1)])),_:1})])),_:1}),g("p",me,b(S.value[0]),1)])),_:1})])),_:1})])])])])],40,re)]})),action:y((()=>[h(Y,{loading:k.value,form:"primary-screening-form"},null,8,["loading"])])),_:1},8,["open","title"])}}}),ye=["onSubmit"],ge={class:"columns"},be={class:"column"},fe={class:"help has-text-danger"},he={class:"column"},je={class:"help has-text-danger"},Ve={class:"column"},xe={class:"help has-text-danger"},$e={class:"navigation-buttons"},De={class:"buttons is-right"},we=r({__name:"ForScreeningDonorsFilterForm",props:{isLoading:{type:Boolean},errors:null},emits:["search","clearError","clearForm"],setup(e,{emit:t}){const{t:a}=U();Y();const l=d({donor_category_id:"",visit_type:"",donation_type_id:""}),n=u([]),i=u([{value:"gratuitous",label:a("Gratuitous")},{value:"chargeable",label:a("Chargeable")}]),r=u([{id:1,name:a("Whole_blood_donation")},{id:2,name:a("Plasmapheresis")},{id:3,name:a("Plateletpheresis")}]);p((async()=>{n.value=await X().then((e=>e.result))}));const _=async()=>{t("search",l)},x=async()=>{Object.assign(l,{donor_category_id:"",visit_type:"",donation_type_id:""}),t("clearForm")};return(t,a)=>{const u=m("Multiselect"),d=s,p=o,$=W,D=T;return c(),v(D,null,{default:y((()=>[g("form",{onSubmit:f(_,["prevent"])},[g("div",ge,[g("div",be,[h(p,{class:"is-curved-select",label:t.$t("Donor_categories")},{default:y((({id:s})=>[h(d,null,{default:y((()=>[h(u,{modelValue:V(l).donor_category_id,"onUpdate:modelValue":a[0]||(a[0]=e=>V(l).donor_category_id=e),attrs:{id:s},options:V(n),placeholder:t.$t("All"),label:"name","value-prop":"id"},null,8,["modelValue","attrs","options","placeholder"]),g("p",fe,b(e.errors.donor_category_id[0]),1)])),_:2},1024)])),_:1},8,["label"])]),g("div",he,[h(p,{class:"is-curved-select",label:t.$t("Visit_type")},{default:y((({id:n})=>[h(d,null,{default:y((()=>[h(u,{modelValue:V(l).visit_type,"onUpdate:modelValue":a[1]||(a[1]=e=>V(l).visit_type=e),attrs:{id:n},options:V(i),placeholder:t.$t("All")},null,8,["modelValue","attrs","options","placeholder"]),g("p",je,b(e.errors.visit_type[0]),1)])),_:2},1024)])),_:1},8,["label"])]),g("div",Ve,[h(p,{class:"is-curved-select",label:t.$t("Donation_type")},{default:y((({id:n})=>[h(d,null,{default:y((()=>[h(u,{modelValue:V(l).donation_type_id,"onUpdate:modelValue":a[2]||(a[2]=e=>V(l).donation_type_id=e),attrs:{id:n},options:V(r),placeholder:t.$t("All"),label:"name","value-prop":"id"},null,8,["modelValue","attrs","options","placeholder"]),g("p",xe,b(e.errors.donation_type_id[0]),1)])),_:2},1024)])),_:1},8,["label"])])]),g("div",$e,[g("div",De,[h($,{type:"button",color:"warning",bold:"",disabled:e.isLoading,tabindex:"0",onClick:x},{default:y((()=>[j(b(t.$t("Clear")),1)])),_:1},8,["disabled"]),h($,{type:"submit",color:"primary",bold:"",loading:e.isLoading,tabindex:"0"},{default:y((()=>[j(b(t.$t("Search")),1)])),_:1},8,["loading"])])])],40,ye)])),_:1})}}}),ke=e=>(F("data-v-d15f44bb"),e=e(),S(),e),Me={class:"page-content-inner"},Oe={class:"columns mb-3"},Fe={class:"column"},Se={class:"columns mt-1"},Ce={class:"column"},Ue={class:"columns"},Ye={class:"column is-12"},Pe=["textContent"],Be={key:0,class:"flex-list-inner"},Ie={key:1,class:"flex-list-inner"},Ne=ke((()=>g("img",{class:"light-image",src:G,alt:""},null,-1))),qe=ke((()=>g("img",{class:"dark-image",src:Q,alt:""},null,-1))),Ae=["onClick"],Le=te(r({__name:"index",async setup(e){let t,a;R(),Y();const{t:l}=U(),n=Z(),s=u(!1);ee().setPageTitle(l("Screening")),K({title:`${l("Donors-list-for-primary-screening")} - ${n.app.name}`});const o=d({data:[],pagination:{total:10,count:10,per_page:10,current_page:1,total_pages:1}}),i=x({get:()=>o.pagination.current_page,set:async e=>{_.page=e,await j(_)}}),r={orderNumber:{format:(e,t,a)=>`${a+1}`},name:{label:l("Fullname")},birth_date:{label:l("Date-of-birth")},visit_date:{label:l("Visit_date"),format:(e,t)=>{var a,l;return(null==(a=t.last_visit)?void 0:a.created_at)&&J(new Date(null==(l=t.last_visit)?void 0:l.created_at),"YYYY-MM-DD")}},visit_type:{label:l("Visit_type"),format:(e,t)=>{var a,n;return(null==(a=t.last_visit)?void 0:a.visit_type)&&l(null==(n=t.last_visit)?void 0:n.visit_type)}},donation_type:{label:l("Donation_type"),format:(e,t)=>{var a,l;return null==(l=null==(a=t.last_visit)?void 0:a.donation_type)?void 0:l.name}},donor_category:{label:l("Donor_category"),format:(e,t)=>{var a;return null==(a=t.category)?void 0:a.name}}};u();const p=d({donor_category_id:[],visit_type:[],donation_type_id:[]}),_=d({page:1}),m=d({}),f=u(!1);async function j(e){var t,a;try{Object.assign(_,e),s.value=!0;const t=await I(e);Object.assign(o,t.result)}catch(l){Object.assign(p,null==(a=null==(t=l.response)?void 0:t.data)?void 0:a.errors)}finally{s.value=!1}}function F(e){p[e]=""}async function S(){o.data=[]}return[t,a]=$((()=>j(_))),await t,a(),(e,t)=>{const a=H,l=we,u=L,d=N,_=z,x=q,$=E,C=A,U=ve;return c(),D("div",Me,[g("div",Oe,[g("div",Fe,[h(a,{"with-icons":"",separator:"bullet",items:[{label:V(n).app.name,hideLabel:!0,icon:"feather:home",to:{name:"/app/dashboard"}},{label:e.$t("Screening")},{label:e.$t("Donors-list-for-primary-screening")}]},null,8,["items"])])]),g("div",Se,[g("div",Ce,[h(l,{"is-loading":V(s),errors:V(p),onSearch:j,onClearForm:S,onClearError:F},null,8,["is-loading","errors"])])]),g("div",Ue,[g("div",Ye,[h(C,{columns:V(r),data:V(o).data,limit:V(o).pagination.per_page,total:V(o).pagination.total},{default:y((()=>[h(x,{rounded:"","no-header":!V(s)&&0===V(o).data.length},{"header-column":y((({column:t})=>["orderNumber"===t.key?(c(),D("span",{key:0,textContent:b(e.$t("donor_no"))},null,8,Pe)):w("",!0)])),body:y((()=>[V(s)?(c(),D("div",Be,[(c(!0),D(k,null,M(V(o).pagination.per_page,(e=>(c(),D("div",{key:e,class:"flex-table-item"},[h(d,null,{default:y((()=>[h(u,{lines:2,"last-line-width":"70%",class:"mx-2"})])),_:1})])))),128))])):w("",!0),0===V(o).data.length?(c(),D("div",Ie,[h(_,{title:e.$t("No_data"),subtitle:e.$t("There_is_no_data_that_match_your_query"),class:"my-6"},{image:y((()=>[Ne,qe])),_:1},8,["title","subtitle"])])):w("",!0)])),"body-cell":y((({row:e,column:t})=>["name"===t.key?(c(),D("a",{key:0,href:"javascript:;",class:"has-text-primary",onClick:t=>{return a=e,Object.assign(m,a),void(f.value=!0);var a}},b(e.first_name)+" "+b(e.last_name)+" "+b(e.father_name)+" ",9,Ae)):w("",!0)])),_:1},8,["no-header"]),V(o).data.length?(c(),v($,{key:0,"current-page":V(i),"onUpdate:current-page":t[0]||(t[0]=e=>O(i)?i.value=e:null),class:"mt-5","item-per-page":V(o).pagination.per_page,"total-items":V(o).pagination.total,"no-router":""},null,8,["current-page","item-per-page","total-items"])):w("",!0)])),_:1},8,["columns","data","limit","total"])])]),h(U,{"is-open":V(f),"onUpdate:is-open":t[1]||(t[1]=e=>O(f)?f.value=e:null),patient:V(m),"onUpdate:list":j},null,8,["is-open","patient"])])}}}),[["__scopeId","data-v-d15f44bb"]]);export{Le as default};
