import{_ as t}from"./VModal.vue_vue_type_style_index_0_lang-7e83e39e.js";import{_ as a}from"./SubmitButton.vue_vue_type_script_setup_true_lang-6ac3b45a.js";import{_ as e}from"./VFlex.vue_vue_type_style_index_0_lang-71ef6e79.js";import{_ as l,a as n}from"./VControl-786e135c.js";import{_ as s}from"./IMaskDateInput.vue_vue_type_script_setup_true_lang-3b830ff4.js";import{_ as i}from"./VFlexItem.vue_vue_type_style_index_0_lang-fd71fae1.js";import{a6 as o,q as r,H as d,C as u,x as _,r as p,o as m,a as c,w as v,e as h,t as g,K as b,a7 as f,m as y,k as $,i as V,A as j,j as x,E as Y,J as D,c as w,a8 as M,d as k,g as B,F as C,l as O,S as F,L as S,M as U}from"./index-e3f64991.js";import{m as I}from"./moment-e3587e24.js";import{_ as z,a as L,b as q}from"./VFlexTable.vue_vue_type_style_index_0_lang-963b0d23.js";import{_ as E,a as P,b as T,c as A,d as N}from"./search-7-dark-47707eb8.js";import{_ as G}from"./VCard.vue_vue_type_script_setup_true_lang-31199b72.js";import{_ as H}from"./VButton.vue_vue_type_style_index_0_lang-43587e05.js";import{_ as J}from"./VInput.vue_vue_type_script_setup_true_lang-705097fe.js";import{v as K}from"./additionals-431474b3.js";import{f as W}from"./additional-14b8c762.js";import{_ as Z}from"./VBreadcrumb.vue_vue_type_style_index_0_lang-09742679.js";import{_ as Q}from"./lodash-040388dd.js";import{u as R}from"./main-7469f747.js";import{u as X}from"./viewWrapper-5fb27d85.js";import{_ as tt}from"./_plugin-vue_export-helper-1b428a4d.js";import"./VIMaskInput.vue_vue_type_script_lang-112dd082.js";import"./VPlaceload-d2cb982c.js";const at=o();const et={class:"columns"},lt={class:"column"},nt={class:"is-size-5 has-text-weight-medium"},st={class:"column"},it={class:"is-size-5 has-text-weight-medium"},ot={class:"columns"},rt={class:"column"},dt={class:"table"},ut=["onSubmit"],_t={class:"is-size-5 has-text-weight-medium"},pt=h("br",null,null,-1),mt={class:"help has-text-danger"},ct=h("br",null,null,-1),vt={class:"table is-fullwidth"},ht={class:"help has-text-danger"},gt={class:"help has-text-danger"},bt=I.__esModule?I.default:I,ft=r({__name:"BloodSamplingFormModal",props:{isOpen:{type:Boolean,default:!1},patient:null},emits:["update:isOpen","update:list"],setup(o,{emit:r}){const j=o,x=d(),{t:Y}=u(),D=_(Y("Sampling_data_entry_form")),w=_(!1),M=p({date:bt().format("YYYY-MM-DD"),hemotransmissible_date:bt().format("YYYY-MM-DD"),chemical_date:bt().format("YYYY-MM-DD")}),k=p({date:[],hemotransmissible_date:[],chemical_date:[]});async function B(){var t,a,e,l,n,s;try{w.value=!0,await async function(t,a){try{const{data:e}=await at({url:`/visit-cards/${t}/blood-samples`,method:"POST",data:a});return e}catch(e){throw e}}(null==(a=null==(t=j.patient)?void 0:t.last_visit)?void 0:a.id,M),r("update:list"),C()}catch(i){(null==(e=i.response)?void 0:e.data.error)?x.error(null==(l=i.response)?void 0:l.data.error):Object.assign(k,null==(s=null==(n=i.response)?void 0:n.data)?void 0:s.errors)}finally{w.value=!1}}function C(){Object.assign(M,{date:bt().format("YYYY-MM-DD"),hemotransmissible_date:bt().format("YYYY-MM-DD"),chemical_date:bt().format("YYYY-MM-DD")}),Object.assign(k,{date:[],hemotransmissible_date:[],chemical_date:[]}),r("update:isOpen",!1)}return(r,d)=>{const u=i,_=s,p=l,j=n,x=e,Y=a,O=t;return m(),c(O,{open:o.isOpen,size:"big",title:D.value,actions:"right",onClose:C},{content:v((()=>{var t,a,e,l,n,s,i;return[h("div",et,[h("div",lt,[h("h5",nt,g(r.$t("Donor_information"))+" # "+g(o.patient.id),1)]),h("div",st,[h("h5",it,g(r.$t("Visit_date"))+": "+g(b(f)(new Date(o.patient.created_at),"YYYY-MM-DD")),1)])]),h("div",ot,[h("div",rt,[h("table",dt,[h("tbody",null,[h("tr",null,[h("th",null,g(r.$t("Last_name")),1),h("td",null,g(o.patient.last_name),1)]),h("tr",null,[h("th",null,g(r.$t("First_name")),1),h("td",null,g(o.patient.first_name),1)]),h("tr",null,[h("th",null,g(r.$t("Middlename")),1),h("td",null,g(o.patient.father_name),1)]),h("tr",null,[h("th",null,g(r.$t("Date-of-birth")),1),h("td",null,g(o.patient.birth_date),1)]),h("tr",null,[h("th",null,g(r.$t("Gender")),1),h("td",null,g(o.patient.gender&&r.$t(o.patient.gender)),1)]),h("tr",null,[h("th",null,g(r.$t("Visit_type")),1),h("td",null,g((null==(t=o.patient.last_visit)?void 0:t.visit_type)&&r.$t(null==(a=o.patient.last_visit)?void 0:a.visit_type)),1)]),h("tr",null,[h("th",null,g(r.$t("Donation_type")),1),h("td",null,g((null==(l=null==(e=o.patient.last_visit)?void 0:e.donation_type)?void 0:l.name)&&r.$t(null==(s=null==(n=o.patient.last_visit)?void 0:n.donation_type)?void 0:s.name)),1)]),h("tr",null,[h("th",null,g(r.$t("Donor_category")),1),h("td",null,g(null==(i=o.patient.category)?void 0:i.name),1)]),h("tr",null,[h("th",null,g(r.$t("Passport_series_number")),1),h("td",null,g(o.patient.passport_series)+g(o.patient.passport_number)+", "+g(o.patient.issued_by)+", "+g(o.patient.when_issued),1)])])])])]),h("form",{id:"blood-sampling-form",class:"modal-form",onSubmit:y(B,["prevent"])},[h("h5",_t,g(r.$t("Information_about_blood_sampling")),1),pt,$(x,{"column-gap":"1rem","align-items":"center"},{default:v((()=>[$(u,null,{default:v((()=>[V(g(r.$t("Blood_sampling_date")),1)])),_:1}),$(u,null,{default:v((()=>[$(j,null,{default:v((()=>[$(p,null,{default:v((()=>[$(_,{modelValue:M.date,"onUpdate:modelValue":d[0]||(d[0]=t=>M.date=t)},null,8,["modelValue"]),h("p",mt,g(k.date[0]),1)])),_:1})])),_:1})])),_:1})])),_:1}),ct,h("table",vt,[h("thead",null,[h("tr",null,[h("th",null,g(r.$t("Blood_sample_transferred_where")),1),h("th",null,g(r.$t("Blood_sample_transferred_when")),1)])]),h("tbody",null,[h("tr",null,[h("td",null,g(r.$t("Bloodborne-infections-laboratory")),1),h("td",null,[$(j,{required:""},{default:v((()=>[$(p,null,{default:v((()=>[$(_,{modelValue:M.hemotransmissible_date,"onUpdate:modelValue":d[1]||(d[1]=t=>M.hemotransmissible_date=t)},null,8,["modelValue"]),h("p",ht,g(k.hemotransmissible_date[0]),1)])),_:1})])),_:1})])]),h("tr",null,[h("td",null,g(r.$t("Clinical-biochemical-laboratory")),1),h("td",null,[$(j,{required:""},{default:v((()=>[$(p,null,{default:v((()=>[$(_,{modelValue:M.chemical_date,"onUpdate:modelValue":d[2]||(d[2]=t=>M.chemical_date=t)},null,8,["modelValue"]),h("p",gt,g(k.chemical_date[0]),1)])),_:1})])),_:1})])])])])],40,ut)]})),action:v((()=>[$(Y,{loading:w.value,form:"blood-sampling-form"},null,8,["loading"])])),_:1},8,["open","title"])}}}),yt=["onSubmit"],$t={class:"columns"},Vt={class:"column is-3"},jt={class:"help has-text-danger"},xt={class:"column is-3"},Yt={class:"help has-text-danger"},Dt={class:"column is-3"},wt={class:"help has-text-danger"},Mt={class:"navigation-buttons"},kt={class:"buttons is-right"},Bt=r({__name:"BloodSamplingFilterForm",props:{isLoading:{type:Boolean},errors:null},emits:["search","clearError","clearForm"],setup(t,{emit:a}){u(),d();const e=p({visit_type:"",donation_type_id:null,donation_code:""}),s=_([]);j((async()=>{const t=await W();s.value=t.result}));const i=async()=>{a("search",e)},o=async()=>{Object.assign(e,{visit_type:"",donation_type_id:null,donation_code:""}),a("clearForm")};return(a,r)=>{const d=x("Multiselect"),u=l,_=n,p=J,f=H,j=G;return m(),c(j,null,{default:v((()=>[h("form",{onSubmit:y(i,["prevent"])},[h("div",$t,[h("div",Vt,[$(_,{class:"is-curved-select",label:a.$t("Visit_type")},{default:v((({id:l})=>[$(u,null,{default:v((()=>[$(d,{modelValue:b(e).visit_type,"onUpdate:modelValue":r[0]||(r[0]=t=>b(e).visit_type=t),attrs:{id:l},options:b(K),placeholder:a.$t("All")},null,8,["modelValue","attrs","options","placeholder"]),h("p",jt,g(t.errors.visit_type[0]),1)])),_:2},1024)])),_:1},8,["label"])]),h("div",xt,[$(_,{class:"is-curved-select",label:a.$t("Donation_type")},{default:v((({id:l})=>[$(u,null,{default:v((()=>[$(d,{modelValue:b(e).donation_type_id,"onUpdate:modelValue":r[1]||(r[1]=t=>b(e).donation_type_id=t),attrs:{id:l},options:b(s),placeholder:a.$t("All"),label:"name","value-prop":"id"},null,8,["modelValue","attrs","options","placeholder"]),h("p",Yt,g(t.errors.donation_type_id[0]),1)])),_:2},1024)])),_:1},8,["label"])]),h("div",Dt,[$(_,{class:"is-curved-select",label:a.$t("Donation_code")},{default:v((({id:l})=>[$(u,null,{default:v((()=>[$(p,{modelValue:b(e).donation_code,"onUpdate:modelValue":r[2]||(r[2]=t=>b(e).donation_code=t),attrs:{id:l},placeholder:a.$t("Donation_code")},null,8,["modelValue","attrs","placeholder"]),h("p",wt,g(t.errors.donation_code[0]),1)])),_:2},1024)])),_:1},8,["label"])])]),h("div",Mt,[h("div",kt,[$(f,{type:"button",color:"warning",bold:"",disabled:t.isLoading,tabindex:"0",onClick:o},{default:v((()=>[V(g(a.$t("Clear")),1)])),_:1},8,["disabled"]),$(f,{type:"submit",color:"primary",bold:"",loading:t.isLoading,tabindex:"0"},{default:v((()=>[V(g(a.$t("Search")),1)])),_:1},8,["loading"])])])],40,yt)])),_:1})}}}),Ct=t=>(S("data-v-9a0bb4d6"),t=t(),U(),t),Ot={class:"page-content-inner"},Ft={class:"columns mb-3"},St={class:"column"},Ut={class:"columns mt-1"},It={class:"column"},zt={class:"columns"},Lt={class:"column is-12"},qt={key:0,class:"is-flex-grow-0",textContent:"#"},Et={key:0,class:"flex-list-inner"},Pt={key:1,class:"flex-list-inner"},Tt=Ct((()=>h("img",{class:"light-image",src:A,alt:""},null,-1))),At=Ct((()=>h("img",{class:"dark-image",src:N,alt:""},null,-1))),Nt=["onClick"],Gt=Q.isEmpty,Ht=tt(r({__name:"index",async setup(t){let a,e;Y();const l=d(),{t:n}=u(),s=R(),i=_(!1);X().setPageTitle(n("Blood_sampling")),D({title:`${n("Donor_list_for_blood_sampling")} - ${s.app.name}`});const o=p({data:[],pagination:{total:10,count:10,per_page:10,current_page:1,total_pages:1}}),r=w({get:()=>o.pagination.current_page,set:async t=>{j.page=t,await U(j)}}),y={orderNumber:{format:(t,a,e)=>`${e+1}`,cellClass:"is-flex-grow-0"},name:{label:n("Fullname")},birth_date:{label:n("Date-of-birth")},visit_date:{label:n("Visit_date"),format:(t,a)=>{var e,l;return(null==(e=a.last_visit)?void 0:e.created_at)&&f(new Date(null==(l=a.last_visit)?void 0:l.created_at),"YYYY-MM-DD")}},visit_type:{label:n("Visit_type"),format:(t,a)=>{var e,l;return(null==(e=a.last_visit)?void 0:e.visit_type)&&n(null==(l=a.last_visit)?void 0:l.visit_type)}},donation_type:{label:n("Donation_type"),format:(t,a)=>{var e;return null==(e=a.last_visit)?void 0:e.personalized_donation}},donation_number:{label:n("Donation_number"),format:(t,a)=>{var e;return null==(e=a.last_visit)?void 0:e.personalized_donation}}};_();const V=p({visit_type:[],donation_type_id:[],donation_code:[]}),j=p({page:1}),x=p({}),S=_(!1);async function U(t){var a,e;try{Object.assign(j,t),i.value=!0;const a=await async function(t){try{const{data:a}=await at({url:"/patients/blood-samples",params:t});return a}catch(a){throw a}}(t);Object.assign(o,a.result),Gt(a.result.data)&&l.warning(n("Data_not_found"))}catch(s){Object.assign(V,null==(e=null==(a=s.response)?void 0:a.data)?void 0:e.errors)}finally{i.value=!1}}function I(t){V[t]=""}async function A(){o.data=[]}return[a,e]=M((()=>U(j))),await a,e(),(t,a)=>{const e=Z,l=Bt,n=E,d=z,u=P,_=L,p=T,f=q,Y=ft;return m(),k("div",Ot,[h("div",Ft,[h("div",St,[$(e,{"with-icons":"",separator:"bullet",items:[{label:b(s).app.name,hideLabel:!0,icon:"feather:home",to:{name:"/app/dashboard"}},{label:t.$t("Blood_sampling")},{label:t.$t("Donor_list_for_blood_sampling")}]},null,8,["items"])])]),h("div",Ut,[h("div",It,[$(l,{"is-loading":b(i),errors:b(V),onSearch:U,onClearForm:A,onClearError:I},null,8,["is-loading","errors"])])]),h("div",zt,[h("div",Lt,[$(f,{columns:b(y),data:b(o).data,limit:b(o).pagination.per_page,total:b(o).pagination.total},{default:v((()=>[$(_,{rounded:"","no-header":!b(i)&&0===b(o).data.length},{"header-column":v((({column:t})=>["orderNumber"===t.key?(m(),k("span",qt)):B("",!0)])),body:v((()=>[b(i)?(m(),k("div",Et,[(m(!0),k(C,null,O(b(o).pagination.per_page,(t=>(m(),k("div",{key:t,class:"flex-table-item"},[$(d,null,{default:v((()=>[$(n,{lines:2,"last-line-width":"70%",class:"mx-2"})])),_:1})])))),128))])):B("",!0),0===b(o).data.length?(m(),k("div",Pt,[$(u,{title:t.$t("No_data"),subtitle:t.$t("There_is_no_data_that_match_your_query"),class:"my-6"},{image:v((()=>[Tt,At])),_:1},8,["title","subtitle"])])):B("",!0)])),"body-cell":v((({row:t,column:a})=>["name"===a.key?(m(),k("a",{key:0,href:"javascript:;",class:"has-text-primary",onClick:a=>{return e=t,Object.assign(x,e),void(S.value=!0);var e}},g(t.first_name)+" "+g(t.last_name)+" "+g(t.father_name)+" ",9,Nt)):B("",!0)])),_:1},8,["no-header"]),b(o).data.length?(m(),c(p,{key:0,"current-page":b(r),"onUpdate:current-page":a[0]||(a[0]=t=>F(r)?r.value=t:null),class:"mt-5","item-per-page":b(o).pagination.per_page,"total-items":b(o).pagination.total,"no-router":""},null,8,["current-page","item-per-page","total-items"])):B("",!0)])),_:1},8,["columns","data","limit","total"])])]),$(Y,{"is-open":b(S),"onUpdate:is-open":a[1]||(a[1]=t=>F(S)?S.value=t:null),patient:b(x),"onUpdate:list":a[2]||(a[2]=t=>U(b(j)))},null,8,["is-open","patient"])])}}}),[["__scopeId","data-v-9a0bb4d6"]]);export{Ht as default};
