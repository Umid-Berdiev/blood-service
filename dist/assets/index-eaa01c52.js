import{_ as t}from"./VModal.vue_vue_type_style_index_0_lang-bd9f4090.js";import{_ as a}from"./SubmitButton.vue_vue_type_script_setup_true_lang-cc65dbea.js";import{_ as e}from"./VFlex.vue_vue_type_style_index_0_lang-89cd9c2c.js";import{_ as l,a as n}from"./VControl-6db07387.js";import{_ as o}from"./IMaskDateInput.vue_vue_type_script_setup_true_lang-e7f94dfc.js";import{_ as s}from"./VFlexItem.vue_vue_type_style_index_0_lang-abff2e0f.js";import{a6 as i,q as r,H as d,C as u,x as _,r as m,a7 as p,o as c,a as v,w as b,e as g,t as h,K as y,m as f,k as Y,i as D,A as V,j as $,E as x,J as j,c as M,a8 as w,d as k,g as B,F as C,l as O,U as F,L as U,M as S}from"./index-f93ac3f8.js";import{_ as I,a as q,b as z}from"./VFlexTable.vue_vue_type_style_index_0_lang-0b6ebd63.js";import{_ as L,a as E,b as T,c as A,d as N}from"./search-7-dark-c4e05ee5.js";import{_ as P}from"./VCard.vue_vue_type_script_setup_true_lang-34c1a38f.js";import{_ as G}from"./VButton.vue_vue_type_style_index_0_lang-2943ff29.js";import{_ as H}from"./VInput.vue_vue_type_script_setup_true_lang-264b74aa.js";import{v as J}from"./additionals-ec1b7c23.js";import{f as K}from"./additional-bd476d98.js";import{_ as R}from"./VBreadcrumb.vue_vue_type_style_index_0_lang-8b18b9a3.js";import{_ as W}from"./lodash-798323ff.js";import{u as Z}from"./main-ee2e6726.js";import{u as Q}from"./viewWrapper-1e6038f3.js";import{_ as X}from"./_plugin-vue_export-helper-1b428a4d.js";import"./VIMaskInput.vue_vue_type_script_lang-a1ff201b.js";import"./moment-c7f2cea7.js";const tt=i();const at={class:"columns"},et={class:"column"},lt={class:"is-size-5 has-text-weight-medium"},nt={class:"column"},ot={class:"is-size-5 has-text-weight-medium"},st={class:"columns"},it={class:"column"},rt={class:"table"},dt=["onSubmit"],ut={class:"is-size-5 has-text-weight-medium"},_t=g("br",null,null,-1),mt={class:"help has-text-danger"},pt=g("br",null,null,-1),ct={class:"table is-fullwidth"},vt={class:"help has-text-danger"},bt={class:"help has-text-danger"},gt={class:"help has-text-danger"},ht={class:"help has-text-danger"},yt=r({__name:"BloodSamplingFormModal",props:{isOpen:{type:Boolean,default:!1},patient:null},emits:["update:isOpen","update:list"],setup(i,{emit:r}){const V=i,$=new Date,x=d(),{t:j}=u(),M=_(j("Sampling_data_entry_form")),w=_(!1),k=m({date:p($,"DD.MM.YYYY"),hemotransmissible_date:p($,"DD.MM.YYYY"),chemical_date:p($,"DD.MM.YYYY"),buck_laboratory_date:p($,"DD.MM.YYYY"),immunological_laboratory_date:p($,"DD.MM.YYYY")}),B=m({date:[],hemotransmissible_date:[],chemical_date:[],buck_laboratory_date:[],immunological_laboratory_date:[]});async function C(){var t,a,e,l,n,o;try{w.value=!0,await async function(t,a){try{const{data:e}=await tt({url:`/visit-cards/${t}/blood-samples`,method:"POST",data:a});return e}catch(e){throw e}}(null==(a=null==(t=V.patient)?void 0:t.last_visit)?void 0:a.id,k),r("update:list"),O()}catch(s){(null==(e=s.response)?void 0:e.data.error)?x.error(null==(l=s.response)?void 0:l.data.error):Object.assign(B,null==(o=null==(n=s.response)?void 0:n.data)?void 0:o.errors)}finally{w.value=!1}}function O(){Object.assign(k,{date:p($,"DD.MM.YYYY"),hemotransmissible_date:p($,"DD.MM.YYYY"),chemical_date:p($,"DD.MM.YYYY"),buck_laboratory_date:p($,"DD.MM.YYYY"),immunological_laboratory_date:p($,"DD.MM.YYYY")}),Object.assign(B,{date:[],hemotransmissible_date:[],chemical_date:[],buck_laboratory_date:[],immunological_laboratory_date:[]}),r("update:isOpen",!1)}return(r,d)=>{const u=s,_=o,m=l,V=n,$=e,x=a,j=t;return c(),v(j,{open:i.isOpen,size:"big",title:M.value,actions:"right",onClose:O},{content:b((()=>{var t,a,e,l,n,o,s;return[g("div",at,[g("div",et,[g("h5",lt,h(r.$t("Donor_information"))+" # "+h(i.patient.id),1)]),g("div",nt,[g("h5",ot,h(r.$t("Visit_date"))+": "+h(y(p)(new Date(i.patient.created_at),"DD.MM.YYYY")),1)])]),g("div",st,[g("div",it,[g("table",rt,[g("tbody",null,[g("tr",null,[g("th",null,h(r.$t("Last_name")),1),g("td",null,h(i.patient.last_name),1)]),g("tr",null,[g("th",null,h(r.$t("First_name")),1),g("td",null,h(i.patient.first_name),1)]),g("tr",null,[g("th",null,h(r.$t("Middlename")),1),g("td",null,h(i.patient.father_name),1)]),g("tr",null,[g("th",null,h(r.$t("Date-of-birth")),1),g("td",null,h(i.patient.birth_date),1)]),g("tr",null,[g("th",null,h(r.$t("Gender")),1),g("td",null,h(i.patient.gender&&r.$t(i.patient.gender)),1)]),g("tr",null,[g("th",null,h(r.$t("Visit_type")),1),g("td",null,h((null==(t=i.patient.last_visit)?void 0:t.visit_type)&&r.$t(null==(a=i.patient.last_visit)?void 0:a.visit_type)),1)]),g("tr",null,[g("th",null,h(r.$t("Donation_type")),1),g("td",null,h((null==(l=null==(e=i.patient.last_visit)?void 0:e.donation_type)?void 0:l.name)&&r.$t(null==(o=null==(n=i.patient.last_visit)?void 0:n.donation_type)?void 0:o.name)),1)]),g("tr",null,[g("th",null,h(r.$t("Donor_category")),1),g("td",null,h(null==(s=i.patient.category)?void 0:s.name),1)]),g("tr",null,[g("th",null,h(r.$t("Passport_series_number")),1),g("td",null,h(i.patient.passport_series)+h(i.patient.passport_number)+", "+h(i.patient.issued_by)+", "+h(i.patient.when_issued),1)])])])])]),g("form",{id:"blood-sampling-form",class:"modal-form",onSubmit:f(C,["prevent"])},[g("h5",ut,h(r.$t("Information_about_blood_sampling")),1),_t,Y($,{"column-gap":"1rem","align-items":"center"},{default:b((()=>[Y(u,null,{default:b((()=>[D(h(r.$t("Blood_sampling_date")),1)])),_:1}),Y(u,null,{default:b((()=>[Y(V,null,{default:b((()=>[Y(m,null,{default:b((()=>[Y(_,{modelValue:k.date,"onUpdate:modelValue":d[0]||(d[0]=t=>k.date=t)},null,8,["modelValue"]),g("p",mt,h(B.date[0]),1)])),_:1})])),_:1})])),_:1})])),_:1}),pt,g("table",ct,[g("thead",null,[g("tr",null,[g("th",null,h(r.$t("Blood_sample_transferred_where")),1),g("th",null,h(r.$t("Blood_sample_transferred_when")),1)])]),g("tbody",null,[g("tr",null,[g("td",null,h(r.$t("Bloodborne-infections-laboratory")),1),g("td",null,[Y(V,{required:""},{default:b((()=>[Y(m,null,{default:b((()=>[Y(_,{modelValue:k.hemotransmissible_date,"onUpdate:modelValue":d[1]||(d[1]=t=>k.hemotransmissible_date=t)},null,8,["modelValue"]),g("p",vt,h(B.hemotransmissible_date[0]),1)])),_:1})])),_:1})])]),g("tr",null,[g("td",null,h(r.$t("Clinical-biochemical-laboratory")),1),g("td",null,[Y(V,{required:""},{default:b((()=>[Y(m,null,{default:b((()=>[Y(_,{modelValue:k.chemical_date,"onUpdate:modelValue":d[2]||(d[2]=t=>k.chemical_date=t)},null,8,["modelValue"]),g("p",bt,h(B.chemical_date[0]),1)])),_:1})])),_:1})])]),g("tr",null,[g("td",null,h(r.$t("Buck-laboratory")),1),g("td",null,[Y(V,{required:""},{default:b((()=>[Y(m,null,{default:b((()=>[Y(_,{modelValue:k.buck_laboratory_date,"onUpdate:modelValue":d[3]||(d[3]=t=>k.buck_laboratory_date=t)},null,8,["modelValue"]),g("p",gt,h(B.buck_laboratory_date[0]),1)])),_:1})])),_:1})])]),g("tr",null,[g("td",null,h(r.$t("Immunological-Research-Department")),1),g("td",null,[Y(V,{required:""},{default:b((()=>[Y(m,null,{default:b((()=>[Y(_,{modelValue:k.immunological_laboratory_date,"onUpdate:modelValue":d[4]||(d[4]=t=>k.immunological_laboratory_date=t)},null,8,["modelValue"]),g("p",ht,h(B.immunological_laboratory_date[0]),1)])),_:1})])),_:1})])])])])],40,dt)]})),action:b((()=>[Y(x,{loading:w.value,form:"blood-sampling-form"},null,8,["loading"])])),_:1},8,["open","title"])}}}),ft=["onSubmit"],Yt={class:"columns"},Dt={class:"column is-3"},Vt={class:"help has-text-danger"},$t={class:"column is-3"},xt={class:"help has-text-danger"},jt={class:"column is-3"},Mt={class:"help has-text-danger"},wt={class:"navigation-buttons"},kt={class:"buttons is-right"},Bt=r({__name:"BloodSamplingFilterForm",props:{isLoading:{type:Boolean},errors:null},emits:["search","clearError","clearForm"],setup(t,{emit:a}){u(),d();const e=m({visit_type:"",donation_type_id:null,donation_code:""}),o=_([]);V((async()=>{const t=await K();o.value=t.result}));const s=async()=>{a("search",e)},i=async()=>{Object.assign(e,{visit_type:"",donation_type_id:null,donation_code:""}),a("clearForm")};return(a,r)=>{const d=$("Multiselect"),u=l,_=n,m=H,p=G,V=P;return c(),v(V,null,{default:b((()=>[g("form",{onSubmit:f(s,["prevent"])},[g("div",Yt,[g("div",Dt,[Y(_,{class:"is-curved-select",label:a.$t("Visit_type")},{default:b((({id:l})=>[Y(u,null,{default:b((()=>[Y(d,{modelValue:y(e).visit_type,"onUpdate:modelValue":r[0]||(r[0]=t=>y(e).visit_type=t),attrs:{id:l},options:y(J),placeholder:a.$t("All")},null,8,["modelValue","attrs","options","placeholder"]),g("p",Vt,h(t.errors.visit_type[0]),1)])),_:2},1024)])),_:1},8,["label"])]),g("div",$t,[Y(_,{class:"is-curved-select",label:a.$t("Donation_type")},{default:b((({id:l})=>[Y(u,null,{default:b((()=>[Y(d,{modelValue:y(e).donation_type_id,"onUpdate:modelValue":r[1]||(r[1]=t=>y(e).donation_type_id=t),attrs:{id:l},options:y(o),placeholder:a.$t("All"),label:"name","value-prop":"id"},null,8,["modelValue","attrs","options","placeholder"]),g("p",xt,h(t.errors.donation_type_id[0]),1)])),_:2},1024)])),_:1},8,["label"])]),g("div",jt,[Y(_,{class:"is-curved-select",label:a.$t("Donation_code")},{default:b((({id:l})=>[Y(u,null,{default:b((()=>[Y(m,{modelValue:y(e).donation_code,"onUpdate:modelValue":r[2]||(r[2]=t=>y(e).donation_code=t),attrs:{id:l},placeholder:a.$t("Donation_code")},null,8,["modelValue","attrs","placeholder"]),g("p",Mt,h(t.errors.donation_code[0]),1)])),_:2},1024)])),_:1},8,["label"])])]),g("div",wt,[g("div",kt,[Y(p,{type:"button",color:"warning",bold:"",disabled:t.isLoading,tabindex:"0",onClick:i},{default:b((()=>[D(h(a.$t("Clear")),1)])),_:1},8,["disabled"]),Y(p,{type:"submit",color:"primary",bold:"",loading:t.isLoading,tabindex:"0"},{default:b((()=>[D(h(a.$t("Search")),1)])),_:1},8,["loading"])])])],40,ft)])),_:1})}}}),Ct=t=>(U("data-v-5c05d329"),t=t(),S(),t),Ot={class:"page-content-inner"},Ft={class:"columns mb-3"},Ut={class:"column"},St={class:"columns mt-1"},It={class:"column"},qt={class:"columns"},zt={class:"column is-12"},Lt={key:0,class:"is-flex-grow-0",textContent:"#"},Et={key:0,class:"flex-list-inner"},Tt={key:1,class:"flex-list-inner"},At=Ct((()=>g("img",{class:"light-image",src:A,alt:""},null,-1))),Nt=Ct((()=>g("img",{class:"dark-image",src:N,alt:""},null,-1))),Pt=["onClick"],Gt=W.isEmpty,Ht=X(r({__name:"index",async setup(t){let a,e;x();const l=d(),{t:n}=u(),o=Z(),s=_(!1);Q().setPageTitle(n("Blood_sampling")),j({title:`${n("Donor_list_for_blood_sampling")} - ${o.app.name}`});const i=m({data:[],pagination:{total:10,count:10,per_page:10,current_page:1,total_pages:1}}),r=M({get:()=>i.pagination.current_page,set:async t=>{V.page=t,await S(V)}}),f={orderNumber:{format:(t,a,e)=>`${e+1}`,cellClass:"is-flex-grow-0"},name:{label:n("Fullname")},birth_date:{label:n("Date-of-birth")},visit_date:{label:n("Visit_date"),format:(t,a)=>{var e,l;return(null==(e=a.last_visit)?void 0:e.created_at)&&p(new Date(null==(l=a.last_visit)?void 0:l.created_at),"DD.MM.YYYY")}},visit_type:{label:n("Visit_type"),format:(t,a)=>{var e,l;return(null==(e=a.last_visit)?void 0:e.visit_type)&&n(null==(l=a.last_visit)?void 0:l.visit_type)}},donation_type:{label:n("Donation_type"),format:(t,a)=>{var e;return null==(e=a.last_visit)?void 0:e.personalized_donation}},donation_number:{label:n("Donation_number"),format:(t,a)=>{var e;return null==(e=a.last_visit)?void 0:e.personalized_donation}}};_();const D=m({visit_type:[],donation_type_id:[],donation_code:[]}),V=m({page:1}),$=m({}),U=_(!1);async function S(t){var a,e;try{Object.assign(V,t),s.value=!0;const a=await async function(t){try{const{data:a}=await tt({url:"/patients/blood-samples",params:t});return a}catch(a){throw a}}(t);Object.assign(i,a.result),Gt(a.result.data)&&l.warning(n("Data_not_found"))}catch(o){Object.assign(D,null==(e=null==(a=o.response)?void 0:a.data)?void 0:e.errors)}finally{s.value=!1}}function A(t){D[t]=""}async function N(){i.data=[]}return[a,e]=w((()=>S(V))),await a,e(),(t,a)=>{const e=R,l=Bt,n=L,d=I,u=E,_=q,m=T,p=z,x=yt;return c(),k("div",Ot,[g("div",Ft,[g("div",Ut,[Y(e,{"with-icons":"",separator:"bullet",items:[{label:y(o).app.name,hideLabel:!0,icon:"feather:home",to:{name:"/app/dashboard"}},{label:t.$t("Blood_sampling")},{label:t.$t("Donor_list_for_blood_sampling")}]},null,8,["items"])])]),g("div",St,[g("div",It,[Y(l,{"is-loading":y(s),errors:y(D),onSearch:S,onClearForm:N,onClearError:A},null,8,["is-loading","errors"])])]),g("div",qt,[g("div",zt,[Y(p,{columns:y(f),data:y(i).data,limit:y(i).pagination.per_page,total:y(i).pagination.total},{default:b((()=>[Y(_,{rounded:"","no-header":!y(s)&&0===y(i).data.length},{"header-column":b((({column:t})=>["orderNumber"===t.key?(c(),k("span",Lt)):B("",!0)])),body:b((()=>[y(s)?(c(),k("div",Et,[(c(!0),k(C,null,O(y(i).pagination.per_page,(t=>(c(),k("div",{key:t,class:"flex-table-item"},[Y(d,null,{default:b((()=>[Y(n,{lines:2,"last-line-width":"70%",class:"mx-2"})])),_:1})])))),128))])):B("",!0),0===y(i).data.length?(c(),k("div",Tt,[Y(u,{title:t.$t("No_data"),subtitle:t.$t("There_is_no_data_that_match_your_query"),class:"my-6"},{image:b((()=>[At,Nt])),_:1},8,["title","subtitle"])])):B("",!0)])),"body-cell":b((({row:t,column:a})=>["name"===a.key?(c(),k("a",{key:0,href:"javascript:;",class:"has-text-primary",onClick:a=>{return e=t,Object.assign($,e),void(U.value=!0);var e}},h(t.first_name)+" "+h(t.last_name)+" "+h(t.father_name)+" ",9,Pt)):B("",!0)])),_:1},8,["no-header"]),y(i).data.length?(c(),v(m,{key:0,"current-page":y(r),"onUpdate:current-page":a[0]||(a[0]=t=>F(r)?r.value=t:null),class:"mt-5","item-per-page":y(i).pagination.per_page,"total-items":y(i).pagination.total,"no-router":""},null,8,["current-page","item-per-page","total-items"])):B("",!0)])),_:1},8,["columns","data","limit","total"])])]),Y(x,{"is-open":y(U),"onUpdate:is-open":a[1]||(a[1]=t=>F(U)?U.value=t:null),patient:y($),"onUpdate:list":a[2]||(a[2]=t=>S(y(V)))},null,8,["is-open","patient"])])}}}),[["__scopeId","data-v-5c05d329"]]);export{Ht as default};
