import{_ as e,a,b as t}from"./VFlexTable.vue_vue_type_style_index_0_lang-0fb083a3.js";import{_ as l,a as s}from"./VPlaceloadText.vue_vue_type_style_index_0_lang-1679fcf5.js";import{_ as n}from"./NoDataPlaceholder-02547c33.js";import{_ as i}from"./VCard.vue_vue_type_script_setup_true_lang-9ddefd9d.js";import{_ as r}from"./SubmitButton.vue_vue_type_script_setup_true_lang-9075dd9c.js";import{_ as o}from"./ClearButton.vue_vue_type_script_setup_true_lang-e2cdf555.js";import{b as _,a as d,_ as u}from"./VControl-c4bfd6d4.js";import{_ as p}from"./DateRangePicker.vue_vue_type_script_setup_true_lang-cdf6f465.js";import{q as c,C as m,H as v,r as g,ag as y,x as b,y as f,j as h,o as j,a as x,w as V,e as $,m as k,k as w,i as C,t as S,K as D,E as F,J as P,a7 as O,d as B,g as L,F as U,l as M}from"./index-c5546e3f.js";import{p as Y}from"./patient-9225403a.js";import{_ as N}from"./VBreadcrumb.vue_vue_type_style_index_0_lang-d20f193a.js";import{u as T}from"./main-94385ff1.js";import{u as A}from"./viewWrapper-911093a6.js";import{f as H}from"./index-4fa1fc31.js";import{_ as q}from"./_plugin-vue_export-helper-1b428a4d.js";import"./VFlex.vue_vue_type_style_index_0_lang-84415715.js";import"./VButton.vue_vue_type_style_index_0_lang-6deaaf11.js";import"./ClientOnly.vue_vue_type_script_lang-fed4a332.js";const E=["onSubmit"],G={class:"columns"},I={class:"column"},J={class:"column"},K={class:"column"},R={class:"navigation-buttons"},W={class:"buttons is-right"},Z=c({__name:"ScreeningPassedDonorsFilterForm",props:{isLoading:{type:Boolean}},emits:["search","clearForm"],async setup(e,{emit:a}){let t,l;const{t:s}=m();v();const n=g({start_date:"",end_date:"",donor_category_id:"",visit_type_id:""}),c=([t,l]=y((()=>Y().then((e=>e.result)))),t=await t,l(),t),F=b([{value:"gratuitous",label:s("Gratuitous")},{value:"chargeable",label:s("Chargeable")}]),P=b(!1);f(n,(e=>{e&&(P.value=Object.values(e).some((e=>!!e)))}),{deep:!0});const O=async()=>{a("search",n)},B=async()=>{Object.assign(n,{start_date:"",end_date:"",donor_category_id:"",visit_type_id:""}),a("clearForm")};return(a,t)=>{const l=_,s=p,m=d,v=h("Multiselect"),g=u,y=o,b=r,f=i;return j(),x(f,null,{default:V((()=>[$("form",{onSubmit:k(O,["prevent"])},[$("div",G,[$("div",I,[w(m,null,{default:V((()=>[w(l,null,{default:V((()=>[C(S(a.$t("Period")),1)])),_:1}),w(s,{start:D(n).start_date,"onUpdate:start":t[0]||(t[0]=e=>D(n).start_date=e),end:D(n).end_date,"onUpdate:end":t[1]||(t[1]=e=>D(n).end_date=e)},null,8,["start","end"])])),_:1})]),$("div",J,[w(m,{class:"is-curved-select",label:a.$t("Donor_categories")},{default:V((({id:e})=>[w(g,null,{default:V((()=>[w(v,{modelValue:D(n).donor_category_id,"onUpdate:modelValue":t[2]||(t[2]=e=>D(n).donor_category_id=e),attrs:{id:e},options:D(c),placeholder:a.$t("All"),label:"name","value-prop":"id"},null,8,["modelValue","attrs","options","placeholder"])])),_:2},1024)])),_:1},8,["label"])]),$("div",K,[w(m,{class:"is-curved-select",label:a.$t("Visit_type")},{default:V((({id:e})=>[w(g,null,{default:V((()=>[w(v,{modelValue:D(n).visit_type_id,"onUpdate:modelValue":t[3]||(t[3]=e=>D(n).visit_type_id=e),attrs:{id:e},options:D(F),placeholder:a.$t("All")},null,8,["modelValue","attrs","options","placeholder"])])),_:2},1024)])),_:1},8,["label"])])]),$("div",R,[$("div",W,[w(y,{disabled:e.isLoading||!D(P),onClear:B},null,8,["disabled"]),w(b,{loading:e.isLoading},{default:V((()=>[C(S(a.$t("Search")),1)])),_:1},8,["loading"])])])],40,E)])),_:1})}}}),z={class:"page-content-inner"},Q={class:"columns mb-3"},X={class:"column"},ee={class:"columns mt-1"},ae={class:"column"},te={class:"columns"},le={class:"column is-12"},se=["textContent"],ne={key:0,class:"flex-list-inner"},ie={key:0},re=q(c({__name:"index",async setup(i){let r,o;F(),v();const{t:_}=m(),d=T(),u=b(!1);A().setPageTitle(_("Screening")),P({title:`${_("Screening-passed-donors-list")} - ${d.app.name}`});const p=g({data:[],pagination:{total:10,count:10,per_page:10,current_page:1,total_pages:1}}),c={orderNumber:{format:(e,a,t)=>`${t+1}`,align:"center"},screening_date:{label:_("Screening_date"),format:(e,a)=>{var t,l,s;return(null==(t=a.last_visit)?void 0:t.primary_screening_result)&&O(new Date(null==(s=null==(l=a.last_visit)?void 0:l.primary_screening_result)?void 0:s.created_at),"YYYY-MM-DD")}},name:{label:_("Donor_fullname")},birth_date:{label:_("Date-of-birth")},visit_date:{label:_("Visit_date"),format:(e,a)=>{var t;return null==(t=a.last_visit)?void 0:t.created_at}},visit_type:{label:_("Visit_type"),format:(e,a)=>{var t,l;return(null==(t=a.last_visit)?void 0:t.visit_type)&&_(null==(l=a.last_visit)?void 0:l.visit_type)}},hemoglobin:{label:`${_("Hemoglobin")}, ${_("g/l")}`,format:(e,a)=>{var t,l;return null==(l=null==(t=a.last_visit)?void 0:t.primary_screening_result)?void 0:l.value},align:"center"},preliminary_blood_type:{label:_("Preliminary_blood_type"),format:(e,a)=>{var t,l,s;return null==(s=null==(l=null==(t=a.last_visit)?void 0:t.primary_screening_result)?void 0:l.blood_type)?void 0:s.label},align:"center"},laboratory_assistant_fullname:{label:_("Laboratory_assistant_fullname"),format:(e,a)=>{var t,l;return null==(l=null==(t=a.last_visit)?void 0:t.primary_screening_result)?void 0:l.created_by}}},h=g({start_date:[],end_date:[],donor_category_id:[],visit_type_id:[]}),k=g({page:1});async function C(e){var a,t;try{u.value=!0,Object.assign(k,e);const a=await H(e);Object.assign(p,a.result)}catch(l){Object.assign(h,null==(t=null==(a=l.response)?void 0:a.data)?void 0:t.errors)}finally{u.value=!1}}async function Y(){await C(k)}return[r,o]=y((()=>C(k))),await r,o(),f((()=>p.pagination.current_page),(async e=>{e&&(k.page=e,await C(k))})),(i,r)=>{const o=N,_=Z,m=l,v=e,g=n,y=a,b=s,f=t;return j(),B("div",z,[$("div",Q,[$("div",X,[w(o,{"with-icons":"",separator:"bullet",items:[{label:D(d).app.name,hideLabel:!0,icon:"feather:home",to:{name:"/app/dashboard"}},{label:i.$t("Screening")},{label:i.$t("Screening-passed-donors-list")}]},null,8,["items"])])]),$("div",ee,[$("div",ae,[w(_,{"is-loading":D(u),onSearch:C,onClearForm:Y},null,8,["is-loading"])])]),$("div",te,[$("div",le,[w(f,{columns:D(c),data:D(p).data,limit:D(p).pagination.per_page,total:D(p).pagination.total},{default:V((()=>[w(y,{rounded:"","no-header":!D(u)&&0===D(p).data.length},{"header-column":V((({column:e})=>["orderNumber"===e.key?(j(),B("span",{key:0,textContent:S(i.$t("donor_no"))},null,8,se)):L("",!0)])),body:V((()=>[D(u)?(j(),B("div",ne,[(j(!0),B(U,null,M(D(p).pagination.per_page,(e=>(j(),B("div",{key:e,class:"flex-table-item"},[w(v,null,{default:V((()=>[w(m,{lines:2,"last-line-width":"70%",class:"mx-2"})])),_:1})])))),128))])):L("",!0),0===D(p).data.length?(j(),x(g,{key:1})):L("",!0)])),"body-cell":V((({row:e,column:a})=>["name"===a.key?(j(),B("span",ie,S(e.first_name)+" "+S(e.last_name)+" "+S(e.father_name),1)):L("",!0)])),_:1},8,["no-header"]),D(p).data.length?(j(),x(b,{key:0,"current-page":D(p).pagination.current_page,"onUpdate:current-page":r[0]||(r[0]=e=>D(p).pagination.current_page=e),class:"mt-5","item-per-page":D(p).pagination.per_page,"total-items":D(p).pagination.total,"no-router":""},null,8,["current-page","item-per-page","total-items"])):L("",!0)])),_:1},8,["columns","data","limit","total"])])])])}}}),[["__scopeId","data-v-9b2dc229"]]);export{re as default};
