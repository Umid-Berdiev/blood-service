import{_ as t}from"./VModal.vue_vue_type_style_index_0_lang-98b95306.js";import{_ as e}from"./SubmitButton.vue_vue_type_script_setup_true_lang-dc9d0236.js";import{_ as a}from"./VCheckbox.vue_vue_type_style_index_0_lang-b85a5492.js";import{_ as l,a as o}from"./VControl-90e6c9df.js";import{_ as n}from"./VInput.vue_vue_type_script_setup_true_lang-6aad6843.js";import{a6 as s,q as r,H as u,C as i,x as d,r as _,A as c,y as p,o as m,a as y,w as v,d as g,F as h,e as f,t as b,k as V,K as j,U as $,l as x,g as w,L as k,M as U,E as D,J as C}from"./index-202d6ef0.js";import{a as q}from"./additional-b8f03a9c.js";import{_ as P}from"./_plugin-vue_export-helper-1b428a4d.js";import{_ as F}from"./VCard.vue_vue_type_script_setup_true_lang-8d45bf90.js";import{_ as O,a as z}from"./VPlaceloadText.vue_vue_type_style_index_0_lang-8916ac45.js";import{_ as B}from"./NoDataPlaceholder-50105cc5.js";import{_ as I}from"./DonationForProcessingFilter.vue_vue_type_script_setup_true_lang-befc21d3.js";import{_ as M}from"./VBreadcrumb.vue_vue_type_style_index_0_lang-e8162493.js";import{u as S}from"./main-1fdef032.js";import{u as T}from"./viewWrapper-93d6f948.js";import"./VButton.vue_vue_type_style_index_0_lang-8a17f68b.js";import"./VFlex.vue_vue_type_style_index_0_lang-5c9a78f5.js";import"./ClearButton.vue_vue_type_script_setup_true_lang-422ea292.js";const E=s();const L=t=>(k("data-v-737a9ce7"),t=t(),U(),t),A={class:"box"},H={class:"table is-fullwidth"},J={class:""},K={class:"has-text-info"},N={class:""},Q={class:"has-text-info"},W={class:""},Z={class:"has-text-info"},G={class:""},R={class:"has-text-info"},X={class:""},Y={class:"has-text-info"},tt=L((()=>f("hr",{class:"is-divider"},null,-1))),et={class:"box"},at={class:"is-size-5"},lt=L((()=>f("br",null,null,-1))),ot={class:"table is-fullwidth"},nt={class:""},st={class:"mr-3"},rt={class:"mb-3"},ut={class:"mr-3"},it={class:"mr-3"},dt={class:"mr-3"},_t={class:"mr-3"},ct=P(r({__name:"ProcessingCardModal",props:{product:null,isOpen:{type:Boolean,default:!1}},emits:["update:isOpen","update:status"],setup(s,{emit:r}){const k=s,U=u(),{t:D}=i(),C=d(!1),P=d(D("Processing_card")),F=d(1),O=d({plasma:0,sent_to_quality_control:!1,erythrocyte:0,erythrocyte_sent_to_quality_control:!1,erythrocyte_sent_to_sterility_control:!1,doses:[0]}),z=_({plasma:[],sent_to_quality_control:[],erythrocyte:[],erythrocyte_sent_to_quality_control:[],erythrocyte_sent_to_sterility_control:[],doses:[]}),B=d([]);async function I(){var t,e,a;try{C.value=!0,await async function(t,e){try{const{data:a}=await E({url:`/visit-cards/donation-results/${t}/recycling`,method:"PUT",data:e});return a}catch(a){throw a}}(null==(t=k.product)?void 0:t.id,O.value),U.success(D("Data_saved_successfully")),M()}catch(l){U.error(l.message),Object.assign(z,null==(a=null==(e=l.response)?void 0:e.data)?void 0:a.errors)}finally{C.value=!1}}function M(){r("update:isOpen",!1)}return c((async()=>{await q().then((t=>B.value=t.result))})),p((()=>{var t;return null==(t=k.product)?void 0:t.id}),(async t=>{})),p((()=>{var t;return null==(t=k.product)?void 0:t.amount}),(async t=>{t&&(O.value.plasma=Math.ceil(1*t/2),O.value.erythrocyte=Math.floor(1*t/2)),O.value.doses[0]=O.value.plasma})),p(F,(function(t){const e=O.value.doses.length;if(e>t&&(O.value.doses.pop(),O.value.doses=O.value.doses.map(((t,e)=>0===e?O.value.plasma:0))),e<t){let a=t-e;for(;a>0;)O.value.doses.push(0),a--}})),(r,u)=>{const i=n,d=l,_=o,c=a,p=e,U=t;return m(),y(U,{open:s.isOpen,size:"big",title:j(P),actions:"right",onClose:M},{content:v((()=>{var t,e,a;return[s.product?(m(),g(h,{key:0},[f("div",A,[f("table",H,[f("tbody",null,[f("tr",null,[f("td",null,[f("span",J,b(r.$t("Donation_type"))+": ",1),f("span",K,b(null==(t=s.product.donation_type)?void 0:t.name),1)]),f("td",null,[f("span",N,b(r.$t("Donation_code"))+": ",1),f("span",Q,b(s.product.donation_code),1)])]),f("tr",null,[f("td",null,[f("span",W,b(r.$t("Donation_date"))+": ",1),f("span",Z,b(s.product.date),1)]),f("td",null,[f("span",G,b(r.$t("Visit_type"))+": ",1),f("span",R,b(r.$t(s.product.visit_type)),1)])]),f("tr",null,[f("td",null,[f("span",X,b(r.$t("Quantity_ml"))+": ",1),f("span",Y,b(s.product.amount),1)])])])])]),tt,f("div",et,[3===(null==(e=s.product.donation_type)?void 0:e.id)?(m(),g(h,{key:0},[f("h5",at,b(r.$t("Components_received"))+":",1),lt,f("table",ot,[f("tbody",null,[f("tr",null,[f("td",nt,[V(_,{horizontal:"",class:"is-align-items-center"},{default:v((()=>[f("h5",st,b(r.$t("Plasma_FFP_ml"))+":",1),V(d,null,{default:v((()=>[V(i,{modelValue:j(O).plasma,"onUpdate:modelValue":u[0]||(u[0]=t=>j(O).plasma=t),type:"number",min:1,onInput:u[1]||(u[1]=t=>{return e=t.target.value,void(O.value.erythrocyte=k.product.amount-e);var e})},null,8,["modelValue"])])),_:1})])),_:1}),f("div",rt,[V(_,{horizontal:"",class:"is-align-items-center"},{default:v((()=>[f("h5",ut,b(r.$t("Divided_into_doses"))+":",1),V(d,null,{default:v((()=>[V(i,{modelValue:j(F),"onUpdate:modelValue":u[2]||(u[2]=t=>$(F)?F.value=t:null),type:"number",min:1,max:4,style:{width:"5rem"}},null,8,["modelValue"])])),_:1})])),_:1})]),(m(!0),g(h,null,x(j(F),((t,e)=>(m(),y(_,{key:e,horizontal:"",class:"is-align-items-center"},{default:v((()=>[f("h5",it,b(t)+"-"+b(r.$t("Dose")),1),V(d,{raw:"",subcontrol:""},{default:v((()=>[V(i,{modelValue:j(O).doses[e],"onUpdate:modelValue":t=>j(O).doses[e]=t,type:"number",min:1},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024)])),_:2},1024)))),128)),V(_,null,{default:v((()=>[V(d,{raw:"",subcontrol:""},{default:v((()=>[V(c,{modelValue:j(O).sent_to_quality_control,"onUpdate:modelValue":u[3]||(u[3]=t=>j(O).sent_to_quality_control=t),label:r.$t("Sample_sent_for_quality_control")},null,8,["modelValue","label"])])),_:1})])),_:1})])]),f("tr",null,[f("td",null,[V(_,{horizontal:"",class:"is-align-items-center"},{default:v((()=>[f("h5",dt,b(r.$t("Erythrocyte_mass_ml")),1),V(d,null,{default:v((()=>[V(i,{modelValue:j(O).erythrocyte,"onUpdate:modelValue":u[4]||(u[4]=t=>j(O).erythrocyte=t),type:"number",min:1,onInput:u[5]||(u[5]=t=>{return e=t.target.value,void(O.value.plasma=k.product.amount-e);var e})},null,8,["modelValue"])])),_:1}),V(d,{raw:"",subcontrol:""},{default:v((()=>[V(c,{modelValue:j(O).erythrocyte_sent_to_quality_control,"onUpdate:modelValue":u[6]||(u[6]=t=>j(O).erythrocyte_sent_to_quality_control=t),label:r.$t("Sample_sent_for_quality_control")},null,8,["modelValue","label"])])),_:1}),V(d,{raw:"",subcontrol:""},{default:v((()=>[V(c,{modelValue:j(O).erythrocyte_sent_to_sterility_control,"onUpdate:modelValue":u[7]||(u[7]=t=>j(O).erythrocyte_sent_to_sterility_control=t),label:r.$t("Sample_sent_for_sterility_control")},null,8,["modelValue","label"])])),_:1})])),_:1})])])])])],64)):w("",!0),2===(null==(a=s.product.donation_type)?void 0:a.id)?(m(!0),g(h,{key:1},x(j(F),((t,e)=>(m(),y(_,{key:e,horizontal:"",class:"is-align-items-center"},{default:v((()=>[f("h5",_t,b(r.$t("Dose"))+" "+b(t)+", ml",1),V(d,null,{default:v((()=>[V(i,{modelValue:j(O).doses[e],"onUpdate:modelValue":t=>j(O).doses[e]=t,type:"number",min:1},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024)])),_:2},1024)))),128)):w("",!0)])],64)):w("",!0)]})),action:v((()=>[V(p,{type:"button",loading:j(C),onClick:I},null,8,["loading"])])),_:1},8,["open","title"])}}}),[["__scopeId","data-v-737a9ce7"]]),pt={class:"page-content-inner"},mt={class:"columns mb-5"},yt={class:"column is-narrow"},vt={class:"columns"},gt={class:"column"},ht={class:"columns"},ft={class:"column"},bt={class:"table-container"},Vt={key:1,class:"table is-hoverable is-fullwidth"},jt={colspan:"3"},$t=["onClick"],xt=P(r({__name:"index",setup(t){D(),u();const{t:e}=i(),a=S(),l=d(!1);T().setPageTitle(e("Processing")),C({title:`${e("Donations_list_for_processing")} - ${a.app.name}`});const o=_({data:[],pagination:{total:10,count:10,per_page:10,current_page:1,total_pages:1}}),n=d(null),s=d(!1),r=_({donation_code:[],donation_type_id:[]}),c=_({visit_type_id:"",donation_type_id:null,donation_code:"",category_id:"",page:1});async function k(t){var e,a;try{l.value=!0,Object.assign(c,t);const e=await async function(t){try{const{data:e}=await E({url:"/visit-cards/donation-results/recycling",params:t});return e}catch(e){throw e}}(t);Object.assign(o,e.result)}catch(n){Object.assign(r,null==(a=null==(e=n.response)?void 0:e.data)?void 0:a.errors)}finally{l.value=!1}}async function U(){await k(c)}return p(s,(function(t){!1===t&&(n.value=null)})),p((()=>o.pagination.current_page),(async t=>{t&&(c.page=t,await k(c))}),{immediate:!0}),(t,e)=>{const r=M,u=I,i=B,d=O,_=z,c=F,p=ct;return m(),g("div",pt,[f("div",mt,[f("div",yt,[V(r,{"with-icons":"",separator:"bullet",items:[{label:j(a).app.name,hideLabel:!0,icon:"feather:home",to:{name:"/app/dashboard"}},{label:t.$t("Processing")},{label:t.$t("Donations_list_for_processing")}]},null,8,["items"])])]),f("div",vt,[f("div",gt,[V(u,{"is-loading":j(l),onSearch:k,onClearForm:U},null,8,["is-loading"])])]),f("div",ht,[f("div",ft,[V(c,null,{default:v((()=>[f("div",bt,[0===j(o).data.length?(m(),y(i,{key:0})):(m(),g("table",Vt,[f("thead",null,[f("tr",null,[f("th",null,b(t.$t("Donation_code")),1),f("th",null,b(t.$t("Donation_date")),1),f("th",null,b(t.$t("Donation_type")),1)])]),f("tbody",null,[j(l)?(m(!0),g(h,{key:0},x(j(o).pagination.per_page,(t=>(m(),g("tr",{key:t},[f("td",jt,[V(d,{lines:2,"last-line-width":"70%"})])])))),128)):(m(!0),g(h,{key:1},x(j(o).data,((t,e)=>{var a;return m(),g("tr",{key:e},[f("td",null,[f("a",{href:"javascript:;",class:"has-text-primary",onClick:e=>function(t){n.value=t,s.value=!0}(t)},b(t.donation_code),9,$t)]),f("td",null,b(t.date),1),f("td",null,b(null==(a=t.donation_type)?void 0:a.name),1)])})),128))])]))]),j(o).data.length?(m(),y(_,{key:0,"current-page":j(o).pagination.current_page,"onUpdate:current-page":e[0]||(e[0]=t=>j(o).pagination.current_page=t),class:"mt-5","item-per-page":j(o).pagination.per_page,"total-items":j(o).pagination.total,"no-router":""},null,8,["current-page","item-per-page","total-items"])):w("",!0)])),_:1})])]),V(p,{"is-open":j(s),"onUpdate:is-open":e[1]||(e[1]=t=>$(s)?s.value=t:null),product:j(n),"onUpdate:list":k},null,8,["is-open","product"])])}}}),[["__scopeId","data-v-e131426b"]]);export{xt as default};
