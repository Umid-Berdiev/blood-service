import{c as a,d as e,a as l,_ as t,b as s}from"./FilterForm.vue_vue_type_script_setup_true_lang-d0848924.js";import{_ as n,a as i,b as o}from"./VFlexTable.vue_vue_type_style_index_0_lang-0fb083a3.js";import{_ as r,a as u}from"./VPlaceloadText.vue_vue_type_style_index_0_lang-1679fcf5.js";import{_ as d}from"./NoDataPlaceholder-02547c33.js";import{_}from"./VBreadcrumb.vue_vue_type_style_index_0_lang-d20f193a.js";import{q as p,H as c,C as m,x as v,r as y,a7 as g,y as f,j as h,o as b,a as x,w as j,e as V,t as w,k,d as C,g as z,i as D,L as $,M as O,E as B,J as U,K as F,F as M,l as q,U as I}from"./index-c5546e3f.js";import{_ as N}from"./VModal.vue_vue_type_style_index_0_lang-52241399.js";import{_ as P}from"./SubmitButton.vue_vue_type_script_setup_true_lang-9075dd9c.js";import{_ as S}from"./VButton.vue_vue_type_style_index_0_lang-6deaaf11.js";import{_ as T}from"./VCheckbox.vue_vue_type_style_index_0_lang-494fdb99.js";import{_ as Y}from"./VInput.vue_vue_type_script_setup_true_lang-fcf9b43c.js";import{b as E,_ as L,a as R}from"./VControl-c4bfd6d4.js";import{_ as A}from"./VFlex.vue_vue_type_style_index_0_lang-84415715.js";import{_ as H}from"./DatePicker.vue_vue_type_script_setup_true_lang-30441cda.js";import{_ as J}from"./VFlexItem.vue_vue_type_style_index_0_lang-919d6b99.js";import{_ as K}from"./_plugin-vue_export-helper-1b428a4d.js";import{u as W}from"./main-94385ff1.js";import{u as Z}from"./viewWrapper-911093a6.js";import"./VTextarea.vue_vue_type_script_setup_true_lang-5e0ed005.js";import"./VRadio.vue_vue_type_style_index_0_lang-39e5fd57.js";import"./moment-6d6279b4.js";import"./VCard.vue_vue_type_script_setup_true_lang-9ddefd9d.js";import"./ClearButton.vue_vue_type_script_setup_true_lang-e2cdf555.js";import"./additional-2c3a91bb.js";import"./ClientOnly.vue_vue_type_script_lang-fed4a332.js";const G=a=>($("data-v-80820cad"),a=a(),O(),a),Q={class:"columns"},X={class:"column"},aa={class:"is-size-5 has-text-weight-medium"},ea={class:"box"},la={class:"my-auto mr-3 is-size-6"},ta={class:"has-text-weight-bold"},sa=G((()=>V("br",null,null,-1))),na={class:"box"},ia={class:"columns is-multiline"},oa={class:"column is-6 is-flex is-align-items-center"},ra={key:0,class:"has-text-danger"},ua=G((()=>V("span",null,"Реакция Хендельсона (бруцеллез)",-1))),da={class:"column is-6 is-flex is-align-items-center"},_a={key:0,class:"has-text-danger"},pa=G((()=>V("span",null,"Титр антистафилококковый антител",-1))),ca={class:"column is-narrow is-flex is-align-items-center"},ma=G((()=>V("br",null,null,-1))),va=G((()=>V("p",{class:"has-text-danger"}," Красным цветом указаны показатели, заданные врачом-терапевтом, как обязательные для определения ",-1))),ya=K(p({__name:"FormModal",props:{isOpen:{type:Boolean,default:!1},patient:null},emits:["update:isOpen","update:list","emergency-noticing"],setup(l,{emit:t}){const s=l,n=c(),{t:i}=m(),o=v(i("Serological_research_results")),r=v(!1),u=y({blood_samples_taken_date:[],analysis_date:[]}),d=g(new Date,"YYYY-MM-DD"),_=y({data:{date_analysis:d,heddelson:"",staphylococcal:"",hemolysis:!1,chilez:!1},required_fields:[]}),p=v(!1),$=v([{value:0,label:i("negative")},{value:1,label:i("positive")},{value:2,label:i("doubtful")}]);async function O(){var a,l,o,d,p,c;try{r.value=!0,await e(null==(l=null==(a=s.patient)?void 0:a.last_visit)?void 0:l.id,_.data),n.success(i("Data_saved_successfully")),t("update:list"),B()}catch(m){(null==(o=m.response)?void 0:o.data.error)?n.error(null==(d=m.response)?void 0:d.data.error):Object.assign(u,null==(c=null==(p=m.response)?void 0:p.data)?void 0:c.errors)}finally{r.value=!1}}function B(){_.data={date_analysis:d,heddelson:"",staphylococcal:"",hemolysis:!1,chilez:!1},Object.assign(u,{date_analysis:[]}),t("update:isOpen",!1)}function U(){t("emergency-noticing"),B()}return f((()=>{var a,e;return null==(e=null==(a=s.patient)?void 0:a.last_visit)?void 0:e.id}),(async e=>{if(e){const l=await a(e);Object.assign(_,l.result)}})),f([()=>_.data.hemolysis,()=>_.data.chilez],(async a=>{a.includes(!0)?p.value=!0:p.value=!1})),(a,e)=>{const t=J,s=H,n=A,i=E,u=h("Multiselect"),d=L,p=R,c=Y,m=T,v=S,y=P,g=N;return b(),x(g,{open:l.isOpen,size:"big",title:o.value,actions:"right",onClose:B},{content:j((()=>{var o,r;return[V("div",Q,[V("div",X,[V("h5",aa,w(a.$t("Donation_code"))+": "+w(null==(r=null==(o=l.patient)?void 0:o.last_visit)?void 0:r.donation_code),1)])]),V("div",ea,[k(n,{"flex-wrap":"wrap","row-gap":"2rem","justify-content":"space-between"},{default:j((()=>[k(t,{"flex-basis":"45%"},{default:j((()=>{var e,t,s;return[V("span",null,w(a.$t("Blood_sampling_date"))+": ",1),V("span",null,w(null==(s=null==(t=null==(e=l.patient)?void 0:e.last_visit)?void 0:t.blood_sample)?void 0:s.date),1)]})),_:1}),k(t,{"flex-basis":"45%"},{default:j((()=>{var e,t,s;return[V("span",null,w(a.$t("Blood_samples_taken_date"))+": ",1),V("span",null,w(null==(s=null==(t=null==(e=l.patient)?void 0:e.last_visit)?void 0:t.blood_sample)?void 0:s.chemical_date),1)]})),_:1}),k(t,{"flex-basis":"45%"},{default:j((()=>[V("span",la,w(a.$t("Analysis_date")),1),k(s,{modelValue:_.data.date_analysis,"onUpdate:modelValue":e[0]||(e[0]=a=>_.data.date_analysis=a)},null,8,["modelValue"])])),_:1}),k(t,{"flex-basis":"45%"},{default:j((()=>{var e,t;return[V("h5",null,[V("span",ta,w(a.$t("Visit_stage")),1),V("span",null,w(null==(t=null==(e=l.patient)?void 0:e.last_visit)?void 0:t.stage),1)])]})),_:1})])),_:1})]),sa,V("div",na,[V("div",ia,[V("div",oa,[k(p,null,{default:j((()=>[k(i,{class:"is-size-6 my-auto mr-3 has-text-right"},{default:j((()=>[_.required_fields.includes("heddelson")?(b(),C("span",ra,"*")):z("",!0),ua])),_:1}),k(d,null,{default:j((()=>[k(u,{modelValue:_.data.heddelson,"onUpdate:modelValue":e[1]||(e[1]=a=>_.data.heddelson=a),options:$.value,placeholder:a.$t("Select"),style:{"min-width":"15rem"}},null,8,["modelValue","options","placeholder"])])),_:1})])),_:1})]),V("div",da,[k(p,{class:"is-justify-content-end"},{default:j((()=>[k(i,{class:"is-size-6 my-auto mr-3 has-text-right"},{default:j((()=>[_.required_fields.includes("staphylococcal")?(b(),C("span",_a,"*")):z("",!0),pa])),_:1}),k(d,null,{default:j((()=>[k(c,{modelValue:_.data.staphylococcal,"onUpdate:modelValue":e[2]||(e[2]=a=>_.data.staphylococcal=a)},null,8,["modelValue"])])),_:1})])),_:1})]),V("div",ca,[k(p,{horizontal:""},{default:j((()=>[k(d,null,{default:j((()=>[k(m,{modelValue:_.data.chilez,"onUpdate:modelValue":e[3]||(e[3]=a=>_.data.chilez=a),color:"primary",label:"Хилез"},null,8,["modelValue"])])),_:1})])),_:1}),k(p,{horizontal:"",style:{"margin-bottom":"0.75rem"}},{default:j((()=>[k(d,null,{default:j((()=>[k(m,{modelValue:_.data.hemolysis,"onUpdate:modelValue":e[4]||(e[4]=a=>_.data.hemolysis=a),color:"primary",label:"Гемолиз"},null,8,["modelValue"])])),_:1})])),_:1})])]),ma,va])]})),action:j((()=>[k(v,{type:"button",color:"warning",outlined:"",onClick:U},{default:j((()=>[D(" Экстренное извещение ")])),_:1}),k(y,{loading:r.value,onClick:O},null,8,["loading"])])),_:1},8,["open","title"])}}}),[["__scopeId","data-v-80820cad"]]),ga={class:"page-content-inner"},fa={class:"columns mb-3"},ha={class:"column"},ba={class:"columns mt-1"},xa={class:"column"},ja={class:"columns"},Va={class:"column is-12"},wa={key:0,class:"is-flex-grow-0",textContent:"#"},ka={key:0,class:"flex-list-inner"},Ca=["onClick"],za=K(p({__name:"index",setup(a){B(),c();const{t:e}=m(),p=W(),g=v(!1);Z().setPageTitle(e("Clinical-biochemical-laboratory")),U({title:`${e("Donor_list_for_blood_sampling")} - ${p.app.name}`});const h=y({data:[],pagination:{total:10,count:10,per_page:10,current_page:1,total_pages:1}}),D={orderNumber:{format:(a,e,l)=>`${l+1}`,cellClass:"is-flex-grow-0"},donation_code:{label:e("Donation_code"),format:(a,e)=>{var l;return null==(l=e.last_visit)?void 0:l.donation_code}},blood_sampling_date:{label:e("Blood_sampling_date"),format:(a,e)=>{var l,t;return null==(t=null==(l=e.last_visit)?void 0:l.blood_sample)?void 0:t.date}},name:{label:e("Donor_fullname")},birth_date:{label:e("Date-of-birth")},visit_type:{label:e("Visit_type"),format:(a,l)=>{var t,s;return(null==(t=l.last_visit)?void 0:t.visit_type)&&e(null==(s=l.last_visit)?void 0:s.visit_type)}},visit_date:{label:e("Visit_date"),format:(a,e)=>{var l;return null==(l=e.last_visit)?void 0:l.created_at}},donation_type:{label:e("Donation_type"),format:(a,e)=>{var l,t;return null==(t=null==(l=e.last_visit)?void 0:l.donation_type)?void 0:t.name}},visit_stage:{label:e("Visit_stage"),format:(a,e)=>{var l,t;return null==(t=null==(l=e.last_visit)?void 0:l.stage)?void 0:t.name}}},$=y({visit_type_id:[],donation_type_id:[],donation_code:[]}),O=y({visit_type_id:"",donation_type_id:null,donation_code:""}),N=v(null),P=v(!1),S=v(!1);async function T(a){var e,t;try{g.value=!0,Object.assign(O,a);const e={...a,page:h.pagination.current_page},t=await l(e);Object.assign(h,t.result)}catch(s){Object.assign($,null==(t=null==(e=s.response)?void 0:e.data)?void 0:t.errors)}finally{g.value=!1}}function Y(a){$[a]=""}async function E(){await T(O)}function L(){N.value=null}return f((()=>h.pagination.current_page),(async a=>{a&&await T(O)}),{immediate:!0}),(a,e)=>{const l=_,c=t,m=r,v=n,y=d,f=i,O=u,B=o,U=s;return b(),C("div",ga,[V("div",fa,[V("div",ha,[k(l,{"with-icons":"",separator:"bullet",items:[{label:F(p).app.name,hideLabel:!0,icon:"feather:home",to:{name:"/app/dashboard"}},{label:a.$t("Buck-laboratory")},{label:a.$t("Research-aimed-donations-list")}]},null,8,["items"])])]),V("div",ba,[V("div",xa,[k(c,{"is-loading":F(g),errors:F($),onSearch:T,onClearForm:E,onClearError:Y},null,8,["is-loading","errors"])])]),V("div",ja,[V("div",Va,[k(B,{columns:F(D),data:F(h).data,limit:F(h).pagination.per_page,total:F(h).pagination.total},{default:j((()=>[k(f,{rounded:"","no-header":!F(g)&&0===F(h).data.length},{"header-column":j((({column:a})=>["orderNumber"===a.key?(b(),C("span",wa)):z("",!0)])),body:j((()=>[F(g)?(b(),C("div",ka,[(b(!0),C(M,null,q(F(h).pagination.per_page,(a=>(b(),C("div",{key:a,class:"flex-table-item"},[k(v,null,{default:j((()=>[k(m,{lines:2,"last-line-width":"70%",class:"mx-2"})])),_:1})])))),128))])):z("",!0),0===F(h).data.length?(b(),x(y,{key:1})):z("",!0)])),"body-cell":j((({row:a,column:e})=>["name"===e.key?(b(),C("a",{key:0,href:"javascript:;",class:"has-text-primary",onClick:e=>{return l=a,N.value=l,void(P.value=!0);var l}},w(a.first_name)+" "+w(a.last_name)+" "+w(a.father_name),9,Ca)):z("",!0)])),_:1},8,["no-header"]),F(h).data.length?(b(),x(O,{key:0,"current-page":F(h).pagination.current_page,"onUpdate:current-page":e[0]||(e[0]=a=>F(h).pagination.current_page=a),class:"mt-5","item-per-page":F(h).pagination.per_page,"total-items":F(h).pagination.total,"no-router":""},null,8,["current-page","item-per-page","total-items"])):z("",!0)])),_:1},8,["columns","data","limit","total"])])]),k(ya,{"is-open":F(P),"onUpdate:is-open":e[1]||(e[1]=a=>I(P)?P.value=a:null),patient:F(N),onClose:L,onEmergencyNoticing:e[2]||(e[2]=a=>S.value=!F(S))},null,8,["is-open","patient"]),k(U,{"is-open":F(S),"onUpdate:is-open":e[3]||(e[3]=a=>I(S)?S.value=a:null),patient:F(N)},null,8,["is-open","patient"])])}}}),[["__scopeId","data-v-2772cc11"]]);export{za as default};
