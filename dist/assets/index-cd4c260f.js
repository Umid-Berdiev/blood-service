import{_ as t}from"./VModal.vue_vue_type_style_index_0_lang-ac88dda5.js";import{_ as e}from"./SubmitButton.vue_vue_type_script_setup_true_lang-96021f2c.js";import{_ as a}from"./VCheckbox.vue_vue_type_style_index_0_lang-d46d394c.js";import{_ as l,a as o}from"./VControl-e7b2630d.js";import{_ as s}from"./VInput.vue_vue_type_script_setup_true_lang-9c010bca.js";import{a6 as n,q as r,H as u,C as i,x as d,r as _,A as c,y as p,o as m,a as y,w as v,d as g,F as h,e as f,t as b,k as V,K as $,U as j,l as x,g as w,L as k,M as U,E as C,J as D,af as q}from"./index-21286bdb.js";import{a as P}from"./additional-f442439b.js";import{_ as z}from"./_plugin-vue_export-helper-1b428a4d.js";import{_ as F}from"./VCard.vue_vue_type_script_setup_true_lang-1043f916.js";import{a as O,_ as B,b as I,c as M,d as S}from"./search-7-dark-81286176.js";import{_ as E}from"./DonationForProcessingFilter.vue_vue_type_script_setup_true_lang-c1c622a3.js";import{_ as T}from"./VBreadcrumb.vue_vue_type_style_index_0_lang-69f615bd.js";import{u as L}from"./main-16751c88.js";import{u as A}from"./viewWrapper-6ae5f61c.js";import"./VButton.vue_vue_type_style_index_0_lang-b78df6f3.js";import"./VFlex.vue_vue_type_style_index_0_lang-57370b27.js";import"./ClearButton.vue_vue_type_script_setup_true_lang-7aff0300.js";const H=n();const J=t=>(k("data-v-737a9ce7"),t=t(),U(),t),K={class:"box"},N={class:"table is-fullwidth"},Q={class:""},W={class:"has-text-info"},Z={class:""},G={class:"has-text-info"},R={class:""},X={class:"has-text-info"},Y={class:""},tt={class:"has-text-info"},et={class:""},at={class:"has-text-info"},lt=J((()=>f("hr",{class:"is-divider"},null,-1))),ot={class:"box"},st={class:"is-size-5"},nt=J((()=>f("br",null,null,-1))),rt={class:"table is-fullwidth"},ut={class:""},it={class:"mr-3"},dt={class:"mb-3"},_t={class:"mr-3"},ct={class:"mr-3"},pt={class:"mr-3"},mt={class:"mr-3"},yt=z(r({__name:"ProcessingCardModal",props:{product:null,isOpen:{type:Boolean,default:!1}},emits:["update:isOpen","update:status"],setup(n,{emit:r}){const k=n,U=u(),{t:C}=i(),D=d(!1),q=d(C("Processing_card")),z=d(1),F=d({plasma:0,sent_to_quality_control:!1,erythrocyte:0,erythrocyte_sent_to_quality_control:!1,erythrocyte_sent_to_sterility_control:!1,doses:[0]}),O=_({plasma:[],sent_to_quality_control:[],erythrocyte:[],erythrocyte_sent_to_quality_control:[],erythrocyte_sent_to_sterility_control:[],doses:[]}),B=d([]);async function I(){var t,e,a;try{D.value=!0,await async function(t,e){try{const{data:a}=await H({url:`/visit-cards/donation-results/${t}/recycling`,method:"PUT",data:e});return a}catch(a){throw a}}(null==(t=k.product)?void 0:t.id,F.value),U.success(C("Data_saved_successfully")),M()}catch(l){U.error(l.message),Object.assign(O,null==(a=null==(e=l.response)?void 0:e.data)?void 0:a.errors)}finally{D.value=!1}}function M(){r("update:isOpen",!1)}return c((async()=>{await P().then((t=>B.value=t.result))})),p((()=>{var t;return null==(t=k.product)?void 0:t.id}),(async t=>{})),p((()=>{var t;return null==(t=k.product)?void 0:t.amount}),(async t=>{t&&(F.value.plasma=Math.ceil(1*t/2),F.value.erythrocyte=Math.floor(1*t/2)),F.value.doses[0]=F.value.plasma})),p(z,(function(t){const e=F.value.doses.length;if(e>t&&(F.value.doses.pop(),F.value.doses=F.value.doses.map(((t,e)=>0===e?F.value.plasma:0))),e<t){let a=t-e;for(;a>0;)F.value.doses.push(0),a--}})),(r,u)=>{const i=s,d=l,_=o,c=a,p=e,U=t;return m(),y(U,{open:n.isOpen,size:"big",title:$(q),actions:"right",onClose:M},{content:v((()=>{var t,e,a;return[n.product?(m(),g(h,{key:0},[f("div",K,[f("table",N,[f("tbody",null,[f("tr",null,[f("td",null,[f("span",Q,b(r.$t("Donation_type"))+": ",1),f("span",W,b(null==(t=n.product.donation_type)?void 0:t.name),1)]),f("td",null,[f("span",Z,b(r.$t("Donation_code"))+": ",1),f("span",G,b(n.product.donation_code),1)])]),f("tr",null,[f("td",null,[f("span",R,b(r.$t("Donation_date"))+": ",1),f("span",X,b(n.product.date),1)]),f("td",null,[f("span",Y,b(r.$t("Visit_type"))+": ",1),f("span",tt,b(r.$t(n.product.visit_type)),1)])]),f("tr",null,[f("td",null,[f("span",et,b(r.$t("Quantity_ml"))+": ",1),f("span",at,b(n.product.amount),1)])])])])]),lt,f("div",ot,[3===(null==(e=n.product.donation_type)?void 0:e.id)?(m(),g(h,{key:0},[f("h5",st,b(r.$t("Components_received"))+":",1),nt,f("table",rt,[f("tbody",null,[f("tr",null,[f("td",ut,[V(_,{horizontal:"",class:"is-align-items-center"},{default:v((()=>[f("h5",it,b(r.$t("Plasma_FFP_ml"))+":",1),V(d,null,{default:v((()=>[V(i,{modelValue:$(F).plasma,"onUpdate:modelValue":u[0]||(u[0]=t=>$(F).plasma=t),type:"number",min:1,onInput:u[1]||(u[1]=t=>{return e=t.target.value,void(F.value.erythrocyte=k.product.amount-e);var e})},null,8,["modelValue"])])),_:1})])),_:1}),f("div",dt,[V(_,{horizontal:"",class:"is-align-items-center"},{default:v((()=>[f("h5",_t,b(r.$t("Divided_into_doses"))+":",1),V(d,null,{default:v((()=>[V(i,{modelValue:$(z),"onUpdate:modelValue":u[2]||(u[2]=t=>j(z)?z.value=t:null),type:"number",min:1,max:4,style:{width:"5rem"}},null,8,["modelValue"])])),_:1})])),_:1})]),(m(!0),g(h,null,x($(z),((t,e)=>(m(),y(_,{key:e,horizontal:"",class:"is-align-items-center"},{default:v((()=>[f("h5",ct,b(t)+"-"+b(r.$t("Dose")),1),V(d,{raw:"",subcontrol:""},{default:v((()=>[V(i,{modelValue:$(F).doses[e],"onUpdate:modelValue":t=>$(F).doses[e]=t,type:"number",min:1},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024)])),_:2},1024)))),128)),V(_,null,{default:v((()=>[V(d,{raw:"",subcontrol:""},{default:v((()=>[V(c,{modelValue:$(F).sent_to_quality_control,"onUpdate:modelValue":u[3]||(u[3]=t=>$(F).sent_to_quality_control=t),label:r.$t("Sample_sent_for_quality_control")},null,8,["modelValue","label"])])),_:1})])),_:1})])]),f("tr",null,[f("td",null,[V(_,{horizontal:"",class:"is-align-items-center"},{default:v((()=>[f("h5",pt,b(r.$t("Erythrocyte_mass_ml")),1),V(d,null,{default:v((()=>[V(i,{modelValue:$(F).erythrocyte,"onUpdate:modelValue":u[4]||(u[4]=t=>$(F).erythrocyte=t),type:"number",min:1,onInput:u[5]||(u[5]=t=>{return e=t.target.value,void(F.value.plasma=k.product.amount-e);var e})},null,8,["modelValue"])])),_:1}),V(d,{raw:"",subcontrol:""},{default:v((()=>[V(c,{modelValue:$(F).erythrocyte_sent_to_quality_control,"onUpdate:modelValue":u[6]||(u[6]=t=>$(F).erythrocyte_sent_to_quality_control=t),label:r.$t("Sample_sent_for_quality_control")},null,8,["modelValue","label"])])),_:1}),V(d,{raw:"",subcontrol:""},{default:v((()=>[V(c,{modelValue:$(F).erythrocyte_sent_to_sterility_control,"onUpdate:modelValue":u[7]||(u[7]=t=>$(F).erythrocyte_sent_to_sterility_control=t),label:r.$t("Sample_sent_for_sterility_control")},null,8,["modelValue","label"])])),_:1})])),_:1})])])])])],64)):w("",!0),2===(null==(a=n.product.donation_type)?void 0:a.id)?(m(!0),g(h,{key:1},x($(z),((t,e)=>(m(),y(_,{key:e,horizontal:"",class:"is-align-items-center"},{default:v((()=>[f("h5",mt,b(r.$t("Dose"))+" "+b(t)+", ml",1),V(d,null,{default:v((()=>[V(i,{modelValue:$(F).doses[e],"onUpdate:modelValue":t=>$(F).doses[e]=t,type:"number",min:1},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024)])),_:2},1024)))),128)):w("",!0)])],64)):w("",!0)]})),action:v((()=>[V(p,{type:"button",loading:$(D),onClick:I},null,8,["loading"])])),_:1},8,["open","title"])}}}),[["__scopeId","data-v-737a9ce7"]]),vt=t=>(k("data-v-306fb40d"),t=t(),U(),t),gt={class:"page-content-inner"},ht={class:"columns mb-5"},ft={class:"column is-narrow"},bt={class:"columns"},Vt={class:"column"},$t={class:"columns"},jt={class:"column"},xt={class:"table-container"},wt={key:0,class:"flex-list-inner"},kt=vt((()=>f("img",{class:"light-image",src:M,alt:""},null,-1))),Ut=vt((()=>f("img",{class:"dark-image",src:S,alt:""},null,-1))),Ct={key:1,class:"table is-hoverable is-fullwidth"},Dt={colspan:"3"},qt=["onClick"],Pt=z(r({__name:"index",async setup(t){let e,a;C(),u();const{t:l}=i(),o=L(),s=d(!1),n=A();d(null),n.setPageTitle(l("Processing")),D({title:`${l("Donations_list_for_processing")} - ${o.app.name}`});const r=_({data:[],pagination:{total:10,count:10,per_page:10,current_page:1,total_pages:1}}),c=d(null),k=d(!1),U=_({donation_code:[],donation_type_id:[]}),P=_({visit_type_id:"",donation_type_id:null,donation_code:"",category_id:""});async function z(t){var e,a;try{s.value=!0;const e={...t,page:r.pagination.current_page},a=await async function(t){try{const{data:e}=await H({url:"/visit-cards/donation-results/recycling",params:t});return e}catch(e){throw e}}(e);Object.assign(r,a.result)}catch(l){Object.assign(U,null==(a=null==(e=l.response)?void 0:e.data)?void 0:a.errors)}finally{s.value=!1}}function M(t){errors[t]=""}async function S(){r.data=[]}return[e,a]=q((()=>z(P))),await e,a(),p(k,(function(t){!1===t&&(c.value=null)})),(t,e)=>{const a=T,l=E,n=O,u=B,i=I,d=F,_=yt;return m(),g("div",gt,[f("div",ht,[f("div",ft,[V(a,{"with-icons":"",separator:"bullet",items:[{label:$(o).app.name,hideLabel:!0,icon:"feather:home",to:{name:"/app/dashboard"}},{label:t.$t("Processing")},{label:t.$t("Donations_list_for_processing")}]},null,8,["items"])])]),f("div",bt,[f("div",Vt,[V(l,{"is-loading":$(s),errors:$(U),onSearch:z,onClearForm:S,onClearError:M},null,8,["is-loading","errors"])])]),f("div",$t,[f("div",jt,[V(d,null,{default:v((()=>[f("div",xt,[0===$(r).data.length?(m(),g("div",wt,[V(n,{title:t.$t("No_data"),subtitle:t.$t("There_is_no_data_that_match_your_query"),class:"my-6"},{image:v((()=>[kt,Ut])),_:1},8,["title","subtitle"])])):(m(),g("table",Ct,[f("thead",null,[f("tr",null,[f("th",null,b(t.$t("Donation_code")),1),f("th",null,b(t.$t("Donation_date")),1),f("th",null,b(t.$t("Donation_type")),1)])]),f("tbody",null,[$(s)?(m(!0),g(h,{key:0},x($(r).pagination.per_page,(t=>(m(),g("tr",{key:t},[f("td",Dt,[V(u,{lines:2,"last-line-width":"70%"})])])))),128)):(m(!0),g(h,{key:1},x($(r).data,((t,e)=>{var a;return m(),g("tr",{key:e},[f("td",null,[f("a",{href:"javascript:;",class:"has-text-primary",onClick:e=>function(t){c.value=t,k.value=!0}(t)},b(t.donation_code),9,qt)]),f("td",null,b(t.date),1),f("td",null,b(null==(a=t.donation_type)?void 0:a.name),1)])})),128))])]))]),$(r).data.length?(m(),y(i,{key:0,"current-page":$(r).pagination.current_page,"onUpdate:current-page":e[0]||(e[0]=t=>$(r).pagination.current_page=t),class:"mt-5","item-per-page":$(r).pagination.per_page,"total-items":$(r).pagination.total,"no-router":""},null,8,["current-page","item-per-page","total-items"])):w("",!0)])),_:1})])]),V(_,{"is-open":$(k),"onUpdate:is-open":e[1]||(e[1]=t=>j(k)?k.value=t:null),product:$(c),"onUpdate:list":z},null,8,["is-open","product"])])}}}),[["__scopeId","data-v-306fb40d"]]);export{Pt as default};
