import{_ as e}from"./VModal.vue_vue_type_style_index_0_lang-ac88dda5.js";import{_ as t}from"./SubmitButton.vue_vue_type_script_setup_true_lang-96021f2c.js";import{_ as a}from"./VFlex.vue_vue_type_style_index_0_lang-57370b27.js";import{_ as l}from"./VFlexItem.vue_vue_type_style_index_0_lang-a32e2ae4.js";import{_ as n}from"./VInput.vue_vue_type_script_setup_true_lang-9c010bca.js";import{_ as s,a as i}from"./VControl-e7b2630d.js";import{_ as o}from"./DatePicker.vue_vue_type_script_setup_true_lang-8beaf1b4.js";import{q as r,H as u,C as d,x as _,r as p,a7 as m,A as c,y as v,j as y,o as g,a as b,w as h,e as f,t as $,m as x,k as j,i as V,f as w,K as D,E as k,J as C,c as O,af as F,d as S,g as M,F as U,l as P,U as Y,L as B,M as L}from"./index-21286bdb.js";import{g as q}from"./additional-f442439b.js";import{s as z,p as A}from"./index-2c297abb.js";import{_ as I,a as E,b as N}from"./VFlexTable.vue_vue_type_style_index_0_lang-03a54f1c.js";import{_ as T,a as G,b as H,c as K,d as W}from"./search-7-dark-81286176.js";import{_ as J}from"./VCard.vue_vue_type_script_setup_true_lang-1043f916.js";import{_ as Z}from"./ClearButton.vue_vue_type_script_setup_true_lang-7aff0300.js";import{p as Q}from"./patient-26cab0f6.js";import{_ as R}from"./VBreadcrumb.vue_vue_type_style_index_0_lang-69f615bd.js";import{u as X}from"./main-16751c88.js";import{u as ee}from"./viewWrapper-6ae5f61c.js";import{_ as te}from"./_plugin-vue_export-helper-1b428a4d.js";import"./VButton.vue_vue_type_style_index_0_lang-b78df6f3.js";import"./ClientOnly.vue_vue_type_script_lang-52200b90.js";const ae={class:"columns"},le={class:"column"},ne={class:"is-size-5 has-text-weight-medium ml-3"},se={class:"column"},ie={class:"is-size-5 has-text-weight-medium"},oe={class:"table"},re=["onSubmit"],ue={class:"is-size-5 has-text-weight-medium ml-3"},de={class:"table is-fullwidth"},_e={class:"help has-text-danger"},pe={class:"help has-text-danger"},me={class:"help has-text-danger"},ce=r({__name:"PrimaryScreeningFormModal",props:{isOpen:{type:Boolean,default:!1},patient:null},emits:["update:isOpen","update:list"],setup(r,{emit:D}){const k=r,C=u(),{t:O}=d(),F=_(O("Primary_screening_form")),S=_(!1),M=_([]),U=p({date:m(new Date,"YYYY-MM-DD"),blood_type_id:null,type:"normal",value:null}),P=p({date:[],blood_type_id:[],type:[],value:[]});async function Y(){var e,t,a,l,n,s;try{S.value=!0,await z(null==(t=null==(e=k.patient)?void 0:e.last_visit)?void 0:t.id,U),C.success(O("Data_saved_successfully")),D("update:list"),B()}catch(i){(null==(a=i.response)?void 0:a.data.error)?C.error(null==(l=i.response)?void 0:l.data.error):Object.assign(P,null==(s=null==(n=i.response)?void 0:n.data)?void 0:s.errors)}finally{S.value=!1}}function B(){Object.assign(U,{date:m(new Date,"YYYY-MM-DD"),blood_type_id:null,type:"normal",value:""}),Object.assign(P,{date:[],blood_type_id:[],type:[],value:[]}),D("update:isOpen",!1)}return c((async()=>{const e=await q();M.value=e.result})),v((()=>{var e,t;return null==(t=null==(e=k.patient)?void 0:e.last_visit)?void 0:t.primary_screening_result}),(e=>{e&&Object.assign(U,e)})),v((()=>U.value),(e=>{var t,a;let l="normal";e&&("male"===(null==(t=k.patient)?void 0:t.gender)?e<128?l="below_normal":e>160&&(l="above_normal"):"female"===(null==(a=k.patient)?void 0:a.gender)?e<120?l="below_normal":e>140&&(l="above_normal"):l="normal"),U.type=l})),(u,d)=>{const _=o,p=y("Multiselect"),m=s,c=i,v=n,D=l,k=a,C=t,O=e;return g(),b(O,{open:r.isOpen,size:"big",title:F.value,actions:"right",onClose:B},{content:h((()=>{var e,t,a,l,n,s,i,o;return[f("div",ae,[f("div",le,[f("h5",ne,$(u.$t("Information_about_donor"))+" # "+$(null==(e=r.patient.last_visit)?void 0:e.donation_code),1)]),f("div",se,[f("h5",ie,$(u.$t("Visit_date"))+": "+$(r.patient.created_at),1)])]),f("table",oe,[f("tbody",null,[f("tr",null,[f("th",null,$(u.$t("Last_name")),1),f("td",null,$(r.patient.last_name),1)]),f("tr",null,[f("th",null,$(u.$t("First_name")),1),f("td",null,$(r.patient.first_name),1)]),f("tr",null,[f("th",null,$(u.$t("Middlename")),1),f("td",null,$(r.patient.father_name),1)]),f("tr",null,[f("th",null,$(u.$t("Date-of-birth")),1),f("td",null,$(r.patient.birth_date),1)]),f("tr",null,[f("th",null,$(u.$t("Gender")),1),f("td",null,$(r.patient.gender&&u.$t(r.patient.gender)),1)]),f("tr",null,[f("th",null,$(u.$t("Visit_type")),1),f("td",null,$((null==(t=r.patient.last_visit)?void 0:t.visit_type)&&u.$t(null==(a=r.patient.last_visit)?void 0:a.visit_type)),1)]),f("tr",null,[f("th",null,$(u.$t("Donation_type")),1),f("td",null,$((null==(n=null==(l=r.patient.last_visit)?void 0:l.donation_type)?void 0:n.name)&&u.$t(null==(i=null==(s=r.patient.last_visit)?void 0:s.donation_type)?void 0:i.name)),1)]),f("tr",null,[f("th",null,$(u.$t("Donor_category")),1),f("td",null,$(null==(o=r.patient.category)?void 0:o.name),1)]),f("tr",null,[f("th",null,$(u.$t("Passport_series_number")),1),f("td",null,$(r.patient.passport_series)+$(r.patient.passport_number)+", "+$(r.patient.issued_by)+", "+$(r.patient.when_issued),1)])])]),f("form",{id:"primary-screening-form",class:"modal-form",onSubmit:x(Y,["prevent"])},[f("h5",ue,$(u.$t("Primary_screening_results")),1),f("table",de,[f("tbody",null,[f("tr",null,[f("th",null,$(u.$t("Date_of_an_analysis")),1),f("td",null,[j(_,{modelValue:U.date,"onUpdate:modelValue":d[0]||(d[0]=e=>U.date=e)},null,8,["modelValue"]),f("p",_e,$(P.date[0]),1)])]),f("tr",null,[f("th",null,$(u.$t("Preliminary_blood_type")),1),f("td",null,[j(c,{required:""},{default:h((()=>[j(m,null,{default:h((()=>[j(p,{modelValue:U.blood_type_id,"onUpdate:modelValue":d[1]||(d[1]=e=>U.blood_type_id=e),options:M.value,placeholder:u.$t("Select"),"value-prop":"id"},null,8,["modelValue","options","placeholder"]),f("p",pe,$(P.blood_type_id[0]),1)])),_:1})])),_:1})])]),f("tr",null,[f("th",null,$(u.$t("Hemoglobin")),1),f("td",null,[j(c,{required:""},{default:h((()=>[j(m,null,{default:h((()=>[j(k,{"column-gap":"1rem","align-items":"center"},{default:h((()=>[j(D,null,{default:h((()=>[j(v,{modelValue:U.value,"onUpdate:modelValue":d[2]||(d[2]=e=>U.value=e),type:"number",min:"0"},null,8,["modelValue"])])),_:1}),j(D,null,{default:h((()=>[V($(u.$t("g/l")),1)])),_:1}),j(D,{"flex-grow":1},{default:h((()=>[j(v,{class:w(["normal"===U.type&&"has-text-primary",("below_normal"===U.type||"above_normal"===U.type)&&"has-text-danger"]),value:U.type,disabled:""},null,8,["class","value"])])),_:1})])),_:1}),f("p",me,$(P.value[0]),1)])),_:1})])),_:1})])])])])],40,re)]})),action:h((()=>[j(C,{loading:S.value,form:"primary-screening-form"},null,8,["loading"])])),_:1},8,["open","title"])}}}),ve=["onSubmit"],ye={class:"columns"},ge={class:"column"},be={class:"help has-text-danger"},he={class:"column"},fe={class:"help has-text-danger"},$e={class:"column"},xe={class:"help has-text-danger"},je={class:"navigation-buttons"},Ve={class:"buttons is-right"},we=r({__name:"ForScreeningDonorsFilterForm",props:{isLoading:{type:Boolean},errors:null},emits:["search","clearError","clearForm"],setup(e,{emit:a}){const{t:l}=d();u();const n=p({donor_category_id:"",visit_type:"",donation_type_id:""}),o=_([]),r=_([{value:"gratuitous",label:l("Gratuitous")},{value:"chargeable",label:l("Chargeable")}]),m=_([{id:1,name:l("Whole_blood_donation")},{id:2,name:l("Plasmapheresis")},{id:3,name:l("Plateletpheresis")}]),w=_(!1);v(n,(e=>{e&&(w.value=Object.values(e).some((e=>!!e)))}),{deep:!0}),c((async()=>{o.value=await Q().then((e=>e.result))}));const k=async()=>{a("search",n)},C=async()=>{Object.assign(n,{donor_category_id:"",visit_type:"",donation_type_id:""}),a("clearForm")};return(a,l)=>{const u=y("Multiselect"),d=s,_=i,p=Z,c=t,v=J;return g(),b(v,null,{default:h((()=>[f("form",{onSubmit:x(k,["prevent"])},[f("div",ye,[f("div",ge,[j(_,{class:"is-curved-select",label:a.$t("Donor_categories")},{default:h((({id:t})=>[j(d,null,{default:h((()=>[j(u,{modelValue:D(n).donor_category_id,"onUpdate:modelValue":l[0]||(l[0]=e=>D(n).donor_category_id=e),attrs:{id:t},options:D(o),placeholder:a.$t("All"),label:"name","value-prop":"id"},null,8,["modelValue","attrs","options","placeholder"]),f("p",be,$(e.errors.donor_category_id[0]),1)])),_:2},1024)])),_:1},8,["label"])]),f("div",he,[j(_,{class:"is-curved-select",label:a.$t("Visit_type")},{default:h((({id:t})=>[j(d,null,{default:h((()=>[j(u,{modelValue:D(n).visit_type,"onUpdate:modelValue":l[1]||(l[1]=e=>D(n).visit_type=e),attrs:{id:t},options:D(r),placeholder:a.$t("All")},null,8,["modelValue","attrs","options","placeholder"]),f("p",fe,$(e.errors.visit_type[0]),1)])),_:2},1024)])),_:1},8,["label"])]),f("div",$e,[j(_,{class:"is-curved-select",label:a.$t("Donation_type")},{default:h((({id:t})=>[j(d,null,{default:h((()=>[j(u,{modelValue:D(n).donation_type_id,"onUpdate:modelValue":l[2]||(l[2]=e=>D(n).donation_type_id=e),attrs:{id:t},options:D(m),placeholder:a.$t("All"),label:"name","value-prop":"id"},null,8,["modelValue","attrs","options","placeholder"]),f("p",xe,$(e.errors.donation_type_id[0]),1)])),_:2},1024)])),_:1},8,["label"])])]),f("div",je,[f("div",Ve,[j(p,{disabled:e.isLoading||!D(w),onClear:C},null,8,["disabled"]),j(c,{loading:e.isLoading},{default:h((()=>[V($(a.$t("Search")),1)])),_:1},8,["loading"])])])],40,ve)])),_:1})}}}),De=e=>(B("data-v-2c5c74ae"),e=e(),L(),e),ke={class:"page-content-inner"},Ce={class:"columns mb-3"},Oe={class:"column"},Fe={class:"columns mt-1"},Se={class:"column"},Me={class:"columns"},Ue={class:"column is-12"},Pe=["textContent"],Ye={key:0,class:"flex-list-inner"},Be={key:1,class:"flex-list-inner"},Le=De((()=>f("img",{class:"light-image",src:K,alt:""},null,-1))),qe=De((()=>f("img",{class:"dark-image",src:W,alt:""},null,-1))),ze=["onClick"],Ae=te(r({__name:"index",async setup(e){let t,a;k(),u();const{t:l}=d(),n=X(),s=_(!1);ee().setPageTitle(l("Screening")),C({title:`${l("Donors-list-for-primary-screening")} - ${n.app.name}`});const i=p({data:[],pagination:{total:10,count:10,per_page:10,current_page:1,total_pages:1}}),o=O({get:()=>i.pagination.current_page,set:async e=>{c.page=e,await x(c)}}),r={orderNumber:{format:(e,t,a)=>`${a+1}`},name:{label:l("Fullname")},birth_date:{label:l("Date-of-birth")},visit_date:{label:l("Visit_date"),format:(e,t)=>{var a;return null==(a=t.last_visit)?void 0:a.created_at}},visit_type:{label:l("Visit_type"),format:(e,t)=>{var a,n;return(null==(a=t.last_visit)?void 0:a.visit_type)&&l(null==(n=t.last_visit)?void 0:n.visit_type)}},donation_type:{label:l("Donation_type"),format:(e,t)=>{var a,l;return null==(l=null==(a=t.last_visit)?void 0:a.donation_type)?void 0:l.name}},donor_category:{label:l("Donor_category"),format:(e,t)=>{var a;return null==(a=t.category)?void 0:a.name}}};_();const m=p({donor_category_id:[],visit_type:[],donation_type_id:[]}),c=p({page:1}),v=_({}),y=_(!1);async function x(e){var t,a;try{Object.assign(c,e),s.value=!0;const t=await A(e);Object.assign(i,t.result)}catch(l){Object.assign(m,null==(a=null==(t=l.response)?void 0:t.data)?void 0:a.errors)}finally{s.value=!1}}function V(e){m[e]=""}async function w(){i.data=[]}return[t,a]=F((()=>x(c))),await t,a(),(e,t)=>{const a=R,l=we,u=T,d=I,_=G,p=E,c=H,k=N,C=ce;return g(),S("div",ke,[f("div",Ce,[f("div",Oe,[j(a,{"with-icons":"",separator:"bullet",items:[{label:D(n).app.name,hideLabel:!0,icon:"feather:home",to:{name:"/app/dashboard"}},{label:e.$t("Screening")},{label:e.$t("Donors-list-for-primary-screening")}]},null,8,["items"])])]),f("div",Fe,[f("div",Se,[j(l,{"is-loading":D(s),errors:D(m),onSearch:x,onClearForm:w,onClearError:V},null,8,["is-loading","errors"])])]),f("div",Me,[f("div",Ue,[j(k,{columns:D(r),data:D(i).data,limit:D(i).pagination.per_page,total:D(i).pagination.total},{default:h((()=>[j(p,{rounded:"","no-header":!D(s)&&0===D(i).data.length},{"header-column":h((({column:t})=>["orderNumber"===t.key?(g(),S("span",{key:0,textContent:$(e.$t("donor_no"))},null,8,Pe)):M("",!0)])),body:h((()=>[D(s)?(g(),S("div",Ye,[(g(!0),S(U,null,P(D(i).pagination.per_page,(e=>(g(),S("div",{key:e,class:"flex-table-item"},[j(d,null,{default:h((()=>[j(u,{lines:2,"last-line-width":"70%",class:"mx-2"})])),_:1})])))),128))])):M("",!0),0===D(i).data.length?(g(),S("div",Be,[j(_,{title:e.$t("No_data"),subtitle:e.$t("There_is_no_data_that_match_your_query"),class:"my-6"},{image:h((()=>[Le,qe])),_:1},8,["title","subtitle"])])):M("",!0)])),"body-cell":h((({row:e,column:t})=>["name"===t.key?(g(),S("a",{key:0,href:"javascript:;",class:"has-text-primary",onClick:t=>{return a=e,v.value=a,void(y.value=!0);var a}},$(e.first_name)+" "+$(e.last_name)+" "+$(e.father_name)+" ",9,ze)):M("",!0)])),_:1},8,["no-header"]),D(i).data.length?(g(),b(c,{key:0,"current-page":D(o),"onUpdate:current-page":t[0]||(t[0]=e=>Y(o)?o.value=e:null),class:"mt-5","item-per-page":D(i).pagination.per_page,"total-items":D(i).pagination.total,"no-router":""},null,8,["current-page","item-per-page","total-items"])):M("",!0)])),_:1},8,["columns","data","limit","total"])])]),j(C,{"is-open":D(y),"onUpdate:is-open":t[1]||(t[1]=e=>Y(y)?y.value=e:null),patient:D(v),"onUpdate:list":x},null,8,["is-open","patient"])])}}}),[["__scopeId","data-v-2c5c74ae"]]);export{Ae as default};
