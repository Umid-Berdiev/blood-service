import{q as e,G as l,c as a,h as t,R as r,x as o,a8 as n,y as s,W as u,r as i,Q as c,o as d,d as v,b as p,f as m,P as y,a9 as f,aa as b,F as g,l as k,a as w,O as h,t as x,K as C,g as $,e as j,w as S,s as T,m as H}from"./index.4a029cdd.js";const V=e({props:{id:{type:String,required:!0},label:{type:String,default:void 0},modelValue:{type:String,default:void 0},noRouter:{type:Boolean,default:void 0},routerQueryKey:{type:String,default:"sort"}},emits:["update:modelValue"],setup(e,o){const n=l(),s=a((()=>{var l,a;return null!=(a=null!=(l=e.modelValue)?l:n.query[e.routerQueryKey])?a:""})),u=a((()=>s.value===`${e.id}:asc`)),i=a((()=>s.value===`${e.id}:desc`)),c=a((()=>u.value?`${e.id}:desc`:i.value?void 0:`${e.id}:asc`)),d=a((()=>{if(e.noRouter)return{};const l={...n.query};return e.routerQueryKey&&(l[e.routerQueryKey]=c.value),{name:n.name,params:n.params,query:l}})),v=l=>{if(o.emit("update:modelValue",c.value),e.noRouter)return l.preventDefault(),l.stopPropagation(),!1};return()=>{var l,a;const n=null==(a=null==(l=o.slots)?void 0:l.default)?void 0:a.call(l,{isDesc:i.value,isAsc:u.value,nextSort:c.value,value:s.value}),p=t(r,{to:d.value,onClick:v,onKeydown(e){"Space"===e.code&&(e.preventDefault(),e.stopPropagation(),e.target instanceof HTMLAnchorElement&&e.target.dispatchEvent(new MouseEvent("click")))}},{default(){const l=t("span",{key:`${s.value}`,class:"is-inline"},t("span",{class:"ml-3 iconify is-inline","data-icon":u.value?"fa:sort-asc":i.value?"fa:sort-desc":"fa:sort"}));return[null!=n?n:e.label,l]}});return t("span",{},p)}}}),B=Symbol(),O=e=>e,R=({key:e,order:l,a:a,b:t})=>{const r=a[e],o=t[e];return"string"==typeof r?"asc"===l?r.localeCompare(o):o.localeCompare(r):r>o?"asc"===l?1:-1:r<o?"asc"===l?-1:1:0},K=e({props:{data:{type:[Array,Function],default:void 0},columns:{type:Object,default:void 0},sort:{type:String,default:void 0},searchTerm:{type:String,default:void 0},limit:{type:Number,default:void 0},page:{type:Number,default:void 0},total:{type:Number,default:void 0},debounceSearch:{type:Number,default:300}},emits:["update:sort","update:page","update:limit","update:searchTerm"],setup(e,l){const r=o(),d=o(!1),v=o(""),p=a({get:()=>{var l;return null!=(l=e.sort)?l:v.value},set(a){void 0===e.sort?v.value=a:l.emit("update:sort",a)}}),m=o(""),y=a({get:()=>{var l;return null!=(l=e.searchTerm)?l:m.value},set(a){void 0===e.searchTerm?m.value=a:l.emit("update:searchTerm",a)}}),f=o(1),b=a({get:()=>{var l;return null!=(l=e.page)?l:f.value},set(a){void 0===e.page?f.value=a:l.emit("update:page",a)}}),g=o(10),k=a({get:()=>{var l;return Math.max(1,null!=(l=e.limit)?l:g.value)},set(a){void 0===e.limit?g.value=a:l.emit("update:limit",a)}}),w=a((()=>{const l=e.columns;if(!l)return l;const a={};return Object.keys(l).reduce(((e,a)=>{const r=l[a];return"string"==typeof r?e[a]={format:O,label:r,key:a}:"object"==typeof r&&(e[a]={format:O,label:a,key:a,...r},!0===r.sortable&&(r.renderHeader?e[a].renderHeader=()=>t(V,{id:a,noRouter:!0,modelValue:p.value,"onUpdate:modelValue":e=>p.value=e},{default:r.renderHeader}):e[a].renderHeader=()=>{var e;return t(V,{id:a,label:null!=(e=r.label)?e:a,noRouter:!0,modelValue:p.value,"onUpdate:modelValue":e=>p.value=e})}),!0!==r.searchable||r.sort||(e[a].sort=R)),e}),a),a})),h=a((()=>{let l=r.value;if(!l)return l;if("function"==typeof e.data)return l;if($.value){const e=w.value?Object.values(w.value).filter((e=>!(!e||"string"==typeof e)&&!0===e.searchable)):[];if(e.length){const a=new RegExp($.value,"i");l=l.filter(((l,t)=>e.some((e=>{if(!e.key)return!1;const r=l[e.key];return e.filter?e.filter({searchTerm:$.value,value:r,row:l,column:e,index:t}):"string"==typeof r&&r.match(a)}))))}}return l})),x=a((()=>{let l=h.value;if(!l)return l;if("function"==typeof e.data)return l;if(p.value&&p.value.includes(":")){const[e,a]=p.value.split(":"),t=w.value?Object.values(w.value).find((l=>!(!l||"string"==typeof l)&&(!0===l.sortable&&l.key===e))):null;if(t){const e=[...l];e.sort(((e,l)=>t.key&&t.sort?t.sort({order:a,column:t,key:t.key,a:e,b:l}):0)),l=e}}return l})),C=a((()=>{if("function"==typeof e.data)return r.value;if(!r.value)return r.value;let l=x.value;return null==l?void 0:l.slice(S.value,S.value+k.value)})),$=n(y,e.debounceSearch),j=a((()=>{var l,a,t;return null!=(t=null!=(a=e.total)?a:null==(l=x.value)?void 0:l.length)?t:0})),S=a((()=>(b.value-1)*k.value)),T=a((()=>j.value?Math.ceil(j.value/k.value):0));async function H(l){if("function"==typeof e.data){d.value=!0;try{r.value=await e.data({searchTerm:$.value,start:S.value,limit:k.value,sort:p.value,controller:l})}finally{d.value=!1}}}s([$,k],(()=>{1!==b.value&&(b.value=1)})),u((async l=>{let a;"function"==typeof e.data?(a=new AbortController,await H(a)):r.value=e.data,l((()=>{null==a||a.abort()}))}));const K=i({data:C,columns:w,loading:d,searchInput:y,searchTerm:$,start:S,page:b,limit:k,sort:p,total:j,totalPages:T,fetchData:H});return c(B,K),l.expose(K),()=>{var e,a;const r=null==(a=(e=l.slots).default)?void 0:a.call(e,K);return t("div",{class:"flex-table-wrapper"},r)}}}),_=["data-th"],q=e({__name:"VFlexTableCell",props:{column:{default:()=>({})}},setup(e){const l=e;return(e,a)=>(d(),v("div",{class:m(["flex-table-cell is-relative",[l.column.bold&&"is-bold",l.column.media&&"is-media",!0===l.column.grow&&"is-grow","lg"===l.column.grow&&"is-grow-lg","xl"===l.column.grow&&"is-grow-xl",l.column.scrollX&&!l.column.scrollY&&"has-slimscroll-x",!l.column.scrollX&&l.column.scrollY&&"has-slimscroll",l.column.scrollX&&l.column.scrollY&&"has-slimscroll-all","end"===l.column.align&&"cell-end","center"===l.column.align&&"cell-center",l.column.cellClass]]),"data-th":l.column.label||void 0},[p(e.$slots,"default")],10,_))}}),Q={key:0,class:"flex-table-header"},A=["tabindex","onKeydown","onClick"],D={key:0},E={class:"language-json py-4"},F=e({__name:"VFlexTable",props:{data:{default:()=>[]},columns:{default:void 0},printObjects:{type:Boolean},reactive:{type:Boolean},compact:{type:Boolean},rounded:{type:Boolean},separators:{type:Boolean},clickable:{type:Boolean},subtable:{type:Boolean},noHeader:{type:Boolean}},emits:["rowClick"],setup(e,{emit:l}){const t=e,r=y(B,null),o=a((()=>(null==r?void 0:r.data)?r.data:t.reactive?f(t.data)?t.data:i(t.data):b(t.data))),n=e=>e,s=a((()=>{var e;const l=null!=(e=null==r?void 0:r.columns)?e:t.columns;let a=[];if(l)for(const[t,r]of Object.entries(l))"string"==typeof r?a.push({format:n,label:r,key:t}):a.push({format:n,label:t,key:t,...r});else if(o.value.length>0)for(const[t]of Object.entries(o.value[0]))a.push({format:n,label:t,key:t});return a}));return(a,r)=>{const n=q;return d(),v("div",{class:m(["flex-table",[t.compact&&"is-compact",t.rounded&&"is-rounded",t.separators&&"with-separators",t.noHeader&&"no-header",t.clickable&&"is-table-clickable",t.subtable&&"sub-table"]])},[p(a.$slots,"header",{},(()=>[t.noHeader?$("",!0):(d(),v("div",Q,[(d(!0),v(g,null,k(C(s),(e=>p(a.$slots,"header-column",{key:"col"+e.key,column:e},(()=>[e.renderHeader?(d(),w(h({render:e.renderHeader}),{key:0,class:m([!0===e.grow&&"is-grow","lg"===e.grow&&"is-grow-lg","xl"===e.grow&&"is-grow-xl","end"===e.align&&"cell-end","center"===e.align&&"cell-center"])},null,8,["class"])):(d(),v("span",{key:1,class:m([!0===e.grow&&"is-grow","lg"===e.grow&&"is-grow-lg","xl"===e.grow&&"is-grow-xl","end"===e.align&&"cell-end","center"===e.align&&"cell-center"])},x(e.label),3))])))),128))]))])),p(a.$slots,"body",{},(()=>[(d(!0),v(g,null,k(C(o),((r,o)=>(d(),v(g,{key:o},[p(a.$slots,"body-row-pre",{row:r,columns:C(s),index:o}),j("div",{class:m(["flex-table-item",[t.clickable&&"is-clickable"]]),tabindex:t.clickable?0:void 0,onKeydown:T(H((()=>{t.clickable&&l("rowClick",r,o)}),["prevent"]),["space"]),onClick:()=>{t.clickable&&l("rowClick",r,o)}},[p(a.$slots,"body-row",{row:r,columns:C(s),index:o},(()=>[(d(!0),v(g,null,k(C(s),(l=>(d(),w(n,{key:"row"+l.key,column:l},{default:S((()=>[p(a.$slots,"body-cell",{row:r,column:l,index:o,value:l.format(r[l.key],r,o)},(()=>[l.renderRow?(d(),w(h({render:()=>{var e;return null==(e=l.renderRow)?void 0:e.call(l,r,l,o)}}),{key:0})):"object"==typeof l.format(r[l.key],r,o)?(d(),v("span",{key:1,class:m([l.cellClass,l.inverted&&"dark-inverted",!l.inverted&&(l.bold?"dark-text":"light-text")])},[e.printObjects?(d(),v("details",D,[j("div",E,[j("pre",null,[j("code",null,x(l.format(r[l.key],r,o)),1)])])])):$("",!0)],2)):(d(),v("span",{key:2,class:m([l.cellClass,l.inverted&&"dark-inverted",!l.inverted&&(l.bold?"dark-text":"light-text")])},x(l.format(r[l.key],r,o)),3))]))])),_:2},1032,["column"])))),128))]))],42,A),p(a.$slots,"body-row-post",{row:r,columns:C(s),index:o})],64)))),128))]))],2)}}});export{q as _,F as a,K as b};
