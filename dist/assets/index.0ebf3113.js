import{_ as e}from"./VModal.vue_vue_type_style_index_0_lang.a5b27fe6.js";import{_ as a}from"./SubmitButton.vue_vue_type_script_setup_true_lang.3f02b6bd.js";import{_ as t}from"./VFlex.vue_vue_type_style_index_0_lang.5029357e.js";import{_ as l}from"./VFlexItem.vue_vue_type_style_index_0_lang.3f326650.js";import{_ as n,a as s}from"./VControl.ca63cac0.js";import{_ as o}from"./IMaskDateInput.vue_vue_type_script_setup_true_lang.75513c1d.js";import{q as i,H as r,C as d,x as u,r as _,j as p,o as m,a as c,w as v,e as b,t as y,m as g,k as f,A as h,i as V,E as $,J as x,c as j,a7 as w,a8 as k,d as D,K as M,g as I,F as C,l as F,S as O,L as Y,M as S}from"./index.5a18e8c8.js";import{m as B}from"./moment.b8ea7098.js";import{o as P,g as U,q as z}from"./patient.cb19f429.js";import{_ as L,a as A,b as q,c as E,d as N,e as G,f as H,g as T,h as W}from"./search-7-dark.8b15a455.js";import{_ as J}from"./VCard.vue_vue_type_script_setup_true_lang.d2de6734.js";import{_ as K}from"./VButton.vue_vue_type_style_index_0_lang.c06d75b0.js";import{_ as Q}from"./VBreadcrumb.vue_vue_type_style_index_0_lang.aa6c4915.js";import{_ as R}from"./lodash.b14eab3e.js";import{u as X}from"./main.fb415df7.js";import{u as Z}from"./viewWrapper.fed031e8.js";import{_ as ee}from"./_plugin-vue_export-helper.cdc0426e.js";import"./VIMaskInput.vue_vue_type_script_lang.32d4852d.js";import"./VPlaceload.df43afcf.js";const ae={class:"columns"},te={class:"column"},le={class:"is-size-5 has-text-weight-medium"},ne={class:"column"},se={class:"is-size-5 has-text-weight-medium"},oe={class:"table"},ie=["onSubmit"],re={class:"is-size-5 has-text-weight-medium"},de={class:"table is-fullwidth"},ue={class:"help has-text-danger"},_e={class:"help has-text-danger"},pe=["value"],me={class:"help has-text-danger"},ce=B.__esModule?B.default:B,ve=i({__name:"PrimaryScreeningFormModal",props:{isOpen:{type:Boolean,default:!1},patient:null},emits:["update:isOpen","update:list"],setup(i,{emit:h}){const V=i,$=r(),{t:x}=d(),j=u(x("Primary_screening_form")),w=u(!1),k=u([{value:"o1",label:"O(I)"},{value:"a2",label:"A(II)"},{value:"b3",label:"B(III)"},{value:"ab4",label:"AB(IV)"}]),D=u([{value:"normal",label:x("Normal")},{value:"below_normal",label:x("Below_normal")},{value:"above_normal",label:x("Above_normal")}]),M=_({analysis_date:ce().format("YYYY-MM-DD"),preliminary_blood_type:"o1",hemoglobin:"normal"}),I=_({analysis_date:[],preliminary_blood_type:[],hemoglobin:[]});async function C(){var e,a,t,l,n;try{w.value=!0,await P(null==(e=V.patient)?void 0:e.id,M),h("update:list"),F()}catch(s){(null==(a=s.response)?void 0:a.data.error)?$.error(null==(t=s.response)?void 0:t.data.error):Object.assign(I,null==(n=null==(l=s.response)?void 0:l.data)?void 0:n.errors)}finally{w.value=!1}}function F(){Object.assign(M,{analysis_date:ce().format("YYYY-MM-DD"),preliminary_blood_type:"o1",hemoglobin:"normal"}),Object.assign(I,{analysis_date:[],preliminary_blood_type:[],hemoglobin:[]}),h("update:isOpen",!1)}return(r,d)=>{const u=o,_=n,h=s,V=p("Multiselect"),$=l,x=t,O=a,Y=e;return m(),c(Y,{open:i.isOpen,size:"big",title:j.value,actions:"right",onClose:F},{content:v((()=>{var e;return[b("div",ae,[b("div",te,[b("h5",le,y(r.$t("Information_about_donor"))+" # "+y(i.patient.id),1)]),b("div",ne,[b("h5",se,y(r.$t("Visit_date"))+": "+y(i.patient.created_at),1)])]),b("table",oe,[b("tbody",null,[b("tr",null,[b("th",null,y(r.$t("Last_name")),1),b("td",null,y(i.patient.last_name),1)]),b("tr",null,[b("th",null,y(r.$t("First_name")),1),b("td",null,y(i.patient.first_name),1)]),b("tr",null,[b("th",null,y(r.$t("Middlename")),1),b("td",null,y(i.patient.father_name),1)]),b("tr",null,[b("th",null,y(r.$t("Date-of-birth")),1),b("td",null,y(i.patient.birth_date),1)]),b("tr",null,[b("th",null,y(r.$t("Gender")),1),b("td",null,y(i.patient.gender),1)]),b("tr",null,[b("th",null,y(r.$t("Visit_type")),1),b("td",null,y(null==(e=i.patient.visit)?void 0:e.visit_type),1)]),b("tr",null,[b("th",null,y(r.$t("Donor_category")),1),b("td",null,y(i.patient.patient_category_id),1)]),b("tr",null,[b("th",null,y(r.$t("Passport_series_number")),1),b("td",null,y(i.patient.passport_series)+y(i.patient.passport_number)+", "+y(i.patient.issued_by)+", "+y(i.patient.when_issued),1)])])]),b("form",{id:"primary-screening-form",class:"modal-form",onSubmit:g(C,["prevent"])},[b("h5",re,y(r.$t("Primary_screening_results")),1),b("table",de,[b("tbody",null,[b("tr",null,[b("th",null,y(r.$t("Date_of_an_analysis")),1),b("td",null,[f(h,{required:""},{default:v((()=>[f(_,null,{default:v((()=>[f(u,{modelValue:M.analysis_date,"onUpdate:modelValue":d[0]||(d[0]=e=>M.analysis_date=e)},null,8,["modelValue"]),b("p",ue,y(I.analysis_date[0]),1)])),_:1})])),_:1})])]),b("tr",null,[b("th",null,y(r.$t("Preliminary_blood_type")),1),b("td",null,[f(h,{required:""},{default:v((()=>[f(_,null,{default:v((()=>[f(V,{modelValue:M.preliminary_blood_type,"onUpdate:modelValue":d[1]||(d[1]=e=>M.preliminary_blood_type=e),options:k.value},null,8,["modelValue","options"]),b("p",_e,y(I.analysis_date[0]),1)])),_:1})])),_:1})])]),b("tr",null,[b("th",null,y(r.$t("Hemoglobin")),1),b("td",null,[f(h,{required:""},{default:v((()=>[f(_,null,{default:v((()=>[f(x,null,{default:v((()=>[f($,{"flex-grow":1},{default:v((()=>[f(V,{modelValue:M.hemoglobin,"onUpdate:modelValue":d[2]||(d[2]=e=>M.hemoglobin=e),options:D.value},null,8,["modelValue","options"])])),_:1}),f($,null,{default:v((()=>[b("input",{class:"input",type:"text",value:r.$t("g/l"),style:{width:"3rem"}},null,8,pe)])),_:1})])),_:1}),b("p",me,y(I.analysis_date[0]),1)])),_:1})])),_:1})])])])])],40,ie)]})),action:v((({close:e})=>[f(O,{loading:w.value,form:"primary-screening-form"},null,8,["loading"])])),_:1},8,["open","title"])}}}),be=["onSubmit"],ye={class:"columns"},ge={class:"column"},fe={class:"help has-text-danger"},he={class:"column"},Ve={class:"help has-text-danger"},$e={class:"column"},xe={class:"help has-text-danger"},je={class:"navigation-buttons"},we={class:"buttons is-right"},ke=i({__name:"ForScreeningDonorsFilterForm",props:{isLoading:{type:Boolean},errors:null},emits:["search","clearError","clearForm"],setup(e,{emit:a}){const{t:t}=d();r();const l=_({donor_category_id:"",visit_type:"",donation_type_id:""}),o=u([]),i=u([{value:"gratuitous",label:t("Gratuitous")},{value:"chargeable",label:t("Chargeable")}]),$=u([{id:1,name:t("Whole_blood_donation")},{id:2,name:t("Plasmapheresis")},{id:3,name:t("Plateletpheresis")}]);h((async()=>{o.value=await U().then((e=>e.result))}));const x=async()=>{a("search",l)},j=async()=>{Object.assign(l,{donor_category_id:"",visit_type:"",donation_type_id:""}),a("clearForm")};return(a,t)=>{const r=p("Multiselect"),d=n,u=s,_=K,h=J;return m(),c(h,{radius:"regular"},{default:v((()=>[b("form",{onSubmit:g(x,["prevent"])},[b("div",ye,[b("div",ge,[f(u,{class:"is-curved-select",label:a.$t("Donor_categories")},{default:v((({id:n})=>[f(d,null,{default:v((()=>[f(r,{modelValue:l.donor_category_id,"onUpdate:modelValue":t[0]||(t[0]=e=>l.donor_category_id=e),attrs:{id:n},options:o.value,placeholder:a.$t("All"),label:"name","value-prop":"id"},null,8,["modelValue","attrs","options","placeholder"]),b("p",fe,y(e.errors.donor_category_id[0]),1)])),_:2},1024)])),_:1},8,["label"])]),b("div",he,[f(u,{class:"is-curved-select",label:a.$t("Visit_type")},{default:v((({id:n})=>[f(d,null,{default:v((()=>[f(r,{modelValue:l.visit_type,"onUpdate:modelValue":t[1]||(t[1]=e=>l.visit_type=e),attrs:{id:n},options:i.value,placeholder:a.$t("All")},null,8,["modelValue","attrs","options","placeholder"]),b("p",Ve,y(e.errors.visit_type[0]),1)])),_:2},1024)])),_:1},8,["label"])]),b("div",$e,[f(u,{class:"is-curved-select",label:a.$t("Donation_type")},{default:v((({id:n})=>[f(d,null,{default:v((()=>[f(r,{modelValue:l.donation_type_id,"onUpdate:modelValue":t[2]||(t[2]=e=>l.donation_type_id=e),attrs:{id:n},options:$.value,placeholder:a.$t("All"),label:"name","value-prop":"id"},null,8,["modelValue","attrs","options","placeholder"]),b("p",xe,y(e.errors.donation_type_id[0]),1)])),_:2},1024)])),_:1},8,["label"])])]),b("div",je,[b("div",we,[f(_,{type:"button",color:"warning",bold:"",disabled:e.isLoading,tabindex:"0",onClick:j},{default:v((()=>[V(y(a.$t("Clear")),1)])),_:1},8,["disabled"]),f(_,{type:"submit",color:"primary",bold:"",loading:e.isLoading,tabindex:"0"},{default:v((()=>[V(y(a.$t("Search")),1)])),_:1},8,["loading"])])])],40,be)])),_:1})}}}),De=e=>(Y("data-v-35d90e67"),e=e(),S(),e),Me={class:"page-content-inner"},Ie={class:"columns mb-3"},Ce={class:"column"},Fe={class:"columns mt-1"},Oe={class:"column"},Ye={class:"columns"},Se={class:"column is-12"},Be=["textContent"],Pe={key:0,class:"flex-list-inner"},Ue={key:1,class:"flex-list-inner"},ze=De((()=>b("img",{class:"light-image",src:T,alt:""},null,-1))),Le=De((()=>b("img",{class:"dark-image",src:W,alt:""},null,-1))),Ae=["onClick"],qe=R.isEmpty,Ee=ee(i({__name:"index",async setup(e){let a,t;$();const l=r(),{t:n}=d(),s=X(),o=u(!1);Z().setPageTitle(n("Users_List")),x({title:`${n("Donors-list-for-primary-screening")} - ${s.app.name}`});const i=_({data:[],pagination:{total:10,count:10,per_page:10,current_page:1,total_pages:1}}),p=j({get:()=>i.pagination.current_page,set:async e=>{Y.page=e,await P(Y)}}),g={orderNumber:{format:(e,a,t)=>`${t+1}`},name:{label:n("Fullname")},birth_date:{label:n("Date-of-birth")},visit_date:{label:n("Visit_date"),format:(e,a)=>{var t,l;return(null==(t=a.last_visit)?void 0:t.created_at)&&w(new Date(null==(l=a.last_visit)?void 0:l.created_at),"YYYY-MM-DD")}},visit_type:{label:n("Visit_type"),format:(e,a)=>{var t,l;return(null==(t=a.last_visit)?void 0:t.visit_type)&&n(null==(l=a.last_visit)?void 0:l.visit_type)}},medical_inspection_date:{label:n("Medical_inspection_date"),format:(e,a)=>{var t,l;return(null==(t=a.last_visit)?void 0:t.directed_by)&&n(null==(l=a.last_visit)?void 0:l.directed_by)}},medical_inspection_conclusion:{label:n("Medical_inspection_conclusion"),format:(e,a)=>{var t;return null==(t=a.last_visit)?void 0:t.personalized_donation}},linked_donation_number:{label:n("Linked_donation_number"),format:(e,a)=>{var t;return null==(t=a.last_visit)?void 0:t.personalized_donation}},donation_type:{label:n("Donation_type"),format:(e,a)=>{var t;return null==(t=a.last_visit)?void 0:t.personalized_donation}},blood_component_amount:{label:n("Blood_component_amount"),format:(e,a)=>{var t;return null==(t=a.status)?void 0:t.name}}},h=u(),V=_({donor_category_id:[],visit_type:[],donation_type_id:[]}),Y=_({page:1}),S=_({}),B=u(!1);async function P(e){var a,t;try{Object.assign(Y,e),o.value=!0;const a=await z(e);Object.assign(i,a.result),qe(a.result.data)?l.warning(n("Data_not_found")):l.success(`${n("Found")}: ${a.result.pagination.total} ${n("records")}`)}catch(s){Object.assign(V,null==(t=null==(a=s.response)?void 0:a.data)?void 0:t.errors)}finally{o.value=!1}}function U(e){V[e]=""}async function T(){i.data=[]}return[a,t]=k((()=>P(Y))),await a,t(),(e,a)=>{const t=Q,l=ke,n=L,r=A,d=q,u=E,_=N,$=G,x=H,j=ve;return m(),D("div",Me,[b("div",Ie,[b("div",Ce,[f(t,{"with-icons":"",separator:"bullet",items:[{label:M(s).app.name,hideLabel:!0,icon:"feather:home",to:{name:"/app/dashboard"}},{label:e.$t("Screening")},{label:e.$t("Donors-list-for-primary-screening")}]},null,8,["items"])])]),b("div",Fe,[b("div",Oe,[f(l,{"is-loading":o.value,errors:V,onSearch:P,onClearForm:T,onClearError:U},null,8,["is-loading","errors"])])]),b("div",Ye,[b("div",Se,[f(x,{columns:M(g),data:i.data,limit:i.pagination.per_page,total:i.pagination.total},{default:v((()=>[f(_,{rounded:"","no-header":!o.value&&0===i.data.length},{"header-column":v((({column:a})=>["orderNumber"===a.key?(m(),D("span",{key:0,textContent:y(e.$t("Donor_register_number"))},null,8,Be)):I("",!0)])),body:v((()=>[o.value?(m(),D("div",Pe,[(m(!0),D(C,null,F(i.pagination.per_page,(e=>(m(),D("div",{key:e,class:"flex-table-item"},[f(r,null,{default:v((()=>[f(n,{lines:2,"last-line-width":"70%",class:"mx-2"})])),_:1})])))),128))])):I("",!0),0===i.data.length?(m(),D("div",Ue,[f(d,{title:"No matches",subtitle:"There is no data that match your query.",class:"my-6"},{image:v((()=>[ze,Le])),_:1})])):I("",!0)])),"body-row-pre":v((({row:e})=>[e.id===h.value?(m(),c(u,{key:0,size:"tiny",class:"m-0 mb-1"})):I("",!0)])),"body-cell":v((({row:e,column:a})=>["name"===a.key?(m(),D("button",{key:0,class:"button button-link",onClick:a=>{return t=e,Object.assign(S,t),void(B.value=!0);var t}},y(e.first_name)+" "+y(e.last_name)+" "+y(e.father_name),9,Ae)):I("",!0)])),_:1},8,["no-header"]),i.data.length?(m(),c($,{key:0,"current-page":M(p),"onUpdate:current-page":a[0]||(a[0]=e=>O(p)?p.value=e:null),class:"mt-5","item-per-page":i.pagination.per_page,"total-items":i.pagination.total,"no-router":""},null,8,["current-page","item-per-page","total-items"])):I("",!0)])),_:1},8,["columns","data","limit","total"])])]),f(j,{"is-open":B.value,"onUpdate:is-open":a[1]||(a[1]=e=>B.value=e),patient:S},null,8,["is-open","patient"])])}}}),[["__scopeId","data-v-35d90e67"]]);export{Ee as default};
