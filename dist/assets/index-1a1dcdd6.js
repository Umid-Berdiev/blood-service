import{_ as e}from"./VModal.vue_vue_type_style_index_0_lang-52241399.js";import{_ as t}from"./SubmitButton.vue_vue_type_script_setup_true_lang-9075dd9c.js";import{_ as a}from"./VFlex.vue_vue_type_style_index_0_lang-84415715.js";import{_ as l}from"./VFlexItem.vue_vue_type_style_index_0_lang-919d6b99.js";import{_ as n}from"./VInput.vue_vue_type_script_setup_true_lang-fcf9b43c.js";import{_ as i,a as s}from"./VControl-c4bfd6d4.js";import{_ as o}from"./DatePicker.vue_vue_type_script_setup_true_lang-30441cda.js";import{q as r,H as u,C as d,x as _,r as p,a7 as m,A as c,y as v,j as y,o as g,a as b,w as f,e as h,t as j,m as $,k as V,i as x,f as w,K as D,E as O,J as k,ag as C,d as F,g as P,F as S,l as M,U}from"./index-c5546e3f.js";import{g as Y}from"./additional-2c3a91bb.js";import{s as B,p as L}from"./index-4fa1fc31.js";import{_ as z,a as A,b as I}from"./VFlexTable.vue_vue_type_style_index_0_lang-0fb083a3.js";import{_ as q,a as N}from"./VPlaceloadText.vue_vue_type_style_index_0_lang-1679fcf5.js";import{_ as T}from"./NoDataPlaceholder-02547c33.js";import{_ as G}from"./VCard.vue_vue_type_script_setup_true_lang-9ddefd9d.js";import{_ as H}from"./ClearButton.vue_vue_type_script_setup_true_lang-e2cdf555.js";import{p as W}from"./patient-9225403a.js";import{_ as E}from"./VBreadcrumb.vue_vue_type_style_index_0_lang-d20f193a.js";import{u as J}from"./main-94385ff1.js";import{u as K}from"./viewWrapper-911093a6.js";import{_ as Z}from"./_plugin-vue_export-helper-1b428a4d.js";import"./VButton.vue_vue_type_style_index_0_lang-6deaaf11.js";import"./ClientOnly.vue_vue_type_script_lang-fed4a332.js";const Q={class:"columns"},R={class:"column"},X={class:"is-size-5 has-text-weight-medium ml-3"},ee={class:"column"},te={class:"is-size-5 has-text-weight-medium"},ae={class:"table"},le=["onSubmit"],ne={class:"is-size-5 has-text-weight-medium ml-3"},ie={class:"table is-fullwidth"},se={class:"help has-text-danger"},oe={class:"help has-text-danger"},re={class:"help has-text-danger"},ue=r({__name:"PrimaryScreeningFormModal",props:{isOpen:{type:Boolean,default:!1},patient:null},emits:["update:isOpen","update:list"],setup(r,{emit:D}){const O=r,k=u(),{t:C}=d(),F=_(C("Primary_screening_form")),P=_(!1),S=_([]),M=p({date:m(new Date,"YYYY-MM-DD"),blood_type_id:null,type:"normal",value:null}),U=p({date:[],blood_type_id:[],type:[],value:[]});async function L(){var e,t,a,l,n,i;try{P.value=!0,await B(null==(t=null==(e=O.patient)?void 0:e.last_visit)?void 0:t.id,M),k.success(C("Data_saved_successfully")),D("update:list"),z()}catch(s){(null==(a=s.response)?void 0:a.data.error)?k.error(null==(l=s.response)?void 0:l.data.error):Object.assign(U,null==(i=null==(n=s.response)?void 0:n.data)?void 0:i.errors)}finally{P.value=!1}}function z(){Object.assign(M,{date:m(new Date,"YYYY-MM-DD"),blood_type_id:null,type:"normal",value:""}),Object.assign(U,{date:[],blood_type_id:[],type:[],value:[]}),D("update:isOpen",!1)}return c((async()=>{const e=await Y();S.value=e.result})),v((()=>{var e,t;return null==(t=null==(e=O.patient)?void 0:e.last_visit)?void 0:t.primary_screening_result}),(e=>{e&&Object.assign(M,e)})),v((()=>M.value),(e=>{var t,a;let l="normal";e&&("male"===(null==(t=O.patient)?void 0:t.gender)?e<128?l="below_normal":e>160&&(l="above_normal"):"female"===(null==(a=O.patient)?void 0:a.gender)?e<120?l="below_normal":e>140&&(l="above_normal"):l="normal"),M.type=l})),(u,d)=>{const _=o,p=y("Multiselect"),m=i,c=s,v=n,D=l,O=a,k=t,C=e;return g(),b(C,{open:r.isOpen,size:"big",title:F.value,actions:"right",onClose:z},{content:f((()=>{var e,t,a,l,n,i,s,o;return[h("div",Q,[h("div",R,[h("h5",X,j(u.$t("Information_about_donor"))+" # "+j(null==(e=r.patient.last_visit)?void 0:e.donation_code),1)]),h("div",ee,[h("h5",te,j(u.$t("Visit_date"))+": "+j(r.patient.created_at),1)])]),h("table",ae,[h("tbody",null,[h("tr",null,[h("th",null,j(u.$t("Last_name")),1),h("td",null,j(r.patient.last_name),1)]),h("tr",null,[h("th",null,j(u.$t("First_name")),1),h("td",null,j(r.patient.first_name),1)]),h("tr",null,[h("th",null,j(u.$t("Middlename")),1),h("td",null,j(r.patient.father_name),1)]),h("tr",null,[h("th",null,j(u.$t("Date-of-birth")),1),h("td",null,j(r.patient.birth_date),1)]),h("tr",null,[h("th",null,j(u.$t("Gender")),1),h("td",null,j(r.patient.gender&&u.$t(r.patient.gender)),1)]),h("tr",null,[h("th",null,j(u.$t("Visit_type")),1),h("td",null,j((null==(t=r.patient.last_visit)?void 0:t.visit_type)&&u.$t(null==(a=r.patient.last_visit)?void 0:a.visit_type)),1)]),h("tr",null,[h("th",null,j(u.$t("Donation_type")),1),h("td",null,j((null==(n=null==(l=r.patient.last_visit)?void 0:l.donation_type)?void 0:n.name)&&u.$t(null==(s=null==(i=r.patient.last_visit)?void 0:i.donation_type)?void 0:s.name)),1)]),h("tr",null,[h("th",null,j(u.$t("Donor_category")),1),h("td",null,j(null==(o=r.patient.category)?void 0:o.name),1)]),h("tr",null,[h("th",null,j(u.$t("Passport_series_number")),1),h("td",null,j(r.patient.passport_series)+j(r.patient.passport_number)+", "+j(r.patient.issued_by)+", "+j(r.patient.when_issued),1)])])]),h("form",{id:"primary-screening-form",class:"modal-form",onSubmit:$(L,["prevent"])},[h("h5",ne,j(u.$t("Primary_screening_results")),1),h("table",ie,[h("tbody",null,[h("tr",null,[h("th",null,j(u.$t("Date_of_an_analysis")),1),h("td",null,[V(_,{modelValue:M.date,"onUpdate:modelValue":d[0]||(d[0]=e=>M.date=e)},null,8,["modelValue"]),h("p",se,j(U.date[0]),1)])]),h("tr",null,[h("th",null,j(u.$t("Preliminary_blood_type")),1),h("td",null,[V(c,{required:""},{default:f((()=>[V(m,null,{default:f((()=>[V(p,{modelValue:M.blood_type_id,"onUpdate:modelValue":d[1]||(d[1]=e=>M.blood_type_id=e),options:S.value,placeholder:u.$t("Select"),"value-prop":"id"},null,8,["modelValue","options","placeholder"]),h("p",oe,j(U.blood_type_id[0]),1)])),_:1})])),_:1})])]),h("tr",null,[h("th",null,j(u.$t("Hemoglobin")),1),h("td",null,[V(c,{required:""},{default:f((()=>[V(m,null,{default:f((()=>[V(O,{"column-gap":"1rem","align-items":"center"},{default:f((()=>[V(D,null,{default:f((()=>[V(v,{modelValue:M.value,"onUpdate:modelValue":d[2]||(d[2]=e=>M.value=e),type:"number",min:"0"},null,8,["modelValue"])])),_:1}),V(D,null,{default:f((()=>[x(j(u.$t("g/l")),1)])),_:1}),V(D,{"flex-grow":1},{default:f((()=>[V(v,{class:w(["normal"===M.type&&"has-text-primary",("below_normal"===M.type||"above_normal"===M.type)&&"has-text-danger"]),value:M.type,disabled:""},null,8,["class","value"])])),_:1})])),_:1}),h("p",re,j(U.value[0]),1)])),_:1})])),_:1})])])])])],40,le)]})),action:f((()=>[V(k,{loading:P.value,form:"primary-screening-form"},null,8,["loading"])])),_:1},8,["open","title"])}}}),de=["onSubmit"],_e={class:"columns"},pe={class:"column"},me={class:"column"},ce={class:"column"},ve={class:"navigation-buttons"},ye={class:"buttons is-right"},ge=r({__name:"ForScreeningDonorsFilterForm",props:{isLoading:{type:Boolean}},emits:["search","clearForm"],setup(e,{emit:a}){const{t:l}=d();u();const n=p({donor_category_id:"",visit_type:"",donation_type_id:""}),o=_([]),r=_([{value:"gratuitous",label:l("Gratuitous")},{value:"chargeable",label:l("Chargeable")}]),m=_([{id:1,name:l("Whole_blood_donation")},{id:2,name:l("Plasmapheresis")},{id:3,name:l("Plateletpheresis")}]),w=_(!1);v(n,(e=>{e&&(w.value=Object.values(e).some((e=>!!e)))}),{deep:!0}),c((async()=>{o.value=await W().then((e=>e.result))}));const O=async()=>{a("search",n)},k=async()=>{Object.assign(n,{donor_category_id:"",visit_type:"",donation_type_id:""}),a("clearForm")};return(a,l)=>{const u=y("Multiselect"),d=i,_=s,p=H,c=t,v=G;return g(),b(v,null,{default:f((()=>[h("form",{onSubmit:$(O,["prevent"])},[h("div",_e,[h("div",pe,[V(_,{class:"is-curved-select",label:a.$t("Donor_categories")},{default:f((({id:e})=>[V(d,null,{default:f((()=>[V(u,{modelValue:D(n).donor_category_id,"onUpdate:modelValue":l[0]||(l[0]=e=>D(n).donor_category_id=e),attrs:{id:e},options:D(o),placeholder:a.$t("All"),label:"name","value-prop":"id"},null,8,["modelValue","attrs","options","placeholder"])])),_:2},1024)])),_:1},8,["label"])]),h("div",me,[V(_,{class:"is-curved-select",label:a.$t("Visit_type")},{default:f((({id:e})=>[V(d,null,{default:f((()=>[V(u,{modelValue:D(n).visit_type,"onUpdate:modelValue":l[1]||(l[1]=e=>D(n).visit_type=e),attrs:{id:e},options:D(r),placeholder:a.$t("All")},null,8,["modelValue","attrs","options","placeholder"])])),_:2},1024)])),_:1},8,["label"])]),h("div",ce,[V(_,{class:"is-curved-select",label:a.$t("Donation_type")},{default:f((({id:e})=>[V(d,null,{default:f((()=>[V(u,{modelValue:D(n).donation_type_id,"onUpdate:modelValue":l[2]||(l[2]=e=>D(n).donation_type_id=e),attrs:{id:e},options:D(m),placeholder:a.$t("All"),label:"name","value-prop":"id"},null,8,["modelValue","attrs","options","placeholder"])])),_:2},1024)])),_:1},8,["label"])])]),h("div",ve,[h("div",ye,[V(p,{disabled:e.isLoading||!D(w),onClear:k},null,8,["disabled"]),V(c,{loading:e.isLoading},{default:f((()=>[x(j(a.$t("Search")),1)])),_:1},8,["loading"])])])],40,de)])),_:1})}}}),be={class:"page-content-inner"},fe={class:"columns mb-3"},he={class:"column"},je={class:"columns mt-1"},$e={class:"column"},Ve={class:"columns"},xe={class:"column is-12"},we=["textContent"],De={key:0,class:"flex-list-inner"},Oe=["onClick"],ke=Z(r({__name:"index",async setup(e){let t,a;O(),u();const{t:l}=d(),n=J(),i=_(!1);K().setPageTitle(l("Screening")),k({title:`${l("Donors-list-for-primary-screening")} - ${n.app.name}`});const s=p({data:[],pagination:{total:10,count:10,per_page:10,current_page:1,total_pages:1}}),o={orderNumber:{format:(e,t,a)=>`${a+1}`},name:{label:l("Fullname")},birth_date:{label:l("Date-of-birth")},visit_date:{label:l("Visit_date"),format:(e,t)=>{var a;return null==(a=t.last_visit)?void 0:a.created_at}},visit_type:{label:l("Visit_type"),format:(e,t)=>{var a,n;return(null==(a=t.last_visit)?void 0:a.visit_type)&&l(null==(n=t.last_visit)?void 0:n.visit_type)}},donation_type:{label:l("Donation_type"),format:(e,t)=>{var a,l;return null==(l=null==(a=t.last_visit)?void 0:a.donation_type)?void 0:l.name}},donor_category:{label:l("Donor_category"),format:(e,t)=>{var a;return null==(a=t.category)?void 0:a.name}}},r=p({donor_category_id:[],visit_type:[],donation_type_id:[]}),m=p({page:1}),c=_({}),y=_(!1);async function $(e){var t,a;try{Object.assign(m,e),i.value=!0;const t=await L(e);Object.assign(s,t.result)}catch(l){Object.assign(r,null==(a=null==(t=l.response)?void 0:t.data)?void 0:a.errors)}finally{i.value=!1}}async function x(){await $(m)}return[t,a]=C((()=>$(m))),await t,a(),v((()=>s.pagination.current_page),(async e=>{e&&(m.page=e,await $(m))})),(e,t)=>{const a=E,l=ge,r=q,u=z,d=T,_=A,p=N,m=I,v=ue;return g(),F("div",be,[h("div",fe,[h("div",he,[V(a,{"with-icons":"",separator:"bullet",items:[{label:D(n).app.name,hideLabel:!0,icon:"feather:home",to:{name:"/app/dashboard"}},{label:e.$t("Screening")},{label:e.$t("Donors-list-for-primary-screening")}]},null,8,["items"])])]),h("div",je,[h("div",$e,[V(l,{"is-loading":D(i),onSearch:$,onClearForm:x},null,8,["is-loading"])])]),h("div",Ve,[h("div",xe,[V(m,{columns:D(o),data:D(s).data,limit:D(s).pagination.per_page,total:D(s).pagination.total},{default:f((()=>[V(_,{rounded:"","no-header":!D(i)&&0===D(s).data.length},{"header-column":f((({column:t})=>["orderNumber"===t.key?(g(),F("span",{key:0,textContent:j(e.$t("donor_no"))},null,8,we)):P("",!0)])),body:f((()=>[D(i)?(g(),F("div",De,[(g(!0),F(S,null,M(D(s).pagination.per_page,(e=>(g(),F("div",{key:e,class:"flex-table-item"},[V(u,null,{default:f((()=>[V(r,{lines:2,"last-line-width":"70%",class:"mx-2"})])),_:1})])))),128))])):P("",!0),0===D(s).data.length?(g(),b(d,{key:1})):P("",!0)])),"body-cell":f((({row:e,column:t})=>["name"===t.key?(g(),F("a",{key:0,href:"javascript:;",class:"has-text-primary",onClick:t=>{return a=e,c.value=a,void(y.value=!0);var a}},j(e.first_name)+" "+j(e.last_name)+" "+j(e.father_name),9,Oe)):P("",!0)])),_:1},8,["no-header"]),D(s).data.length?(g(),b(p,{key:0,"current-page":e.currentPage,"onUpdate:current-page":t[0]||(t[0]=t=>e.currentPage=t),class:"mt-5","item-per-page":D(s).pagination.per_page,"total-items":D(s).pagination.total,"no-router":""},null,8,["current-page","item-per-page","total-items"])):P("",!0)])),_:1},8,["columns","data","limit","total"])])]),V(v,{"is-open":D(y),"onUpdate:is-open":t[1]||(t[1]=e=>U(y)?y.value=e:null),patient:D(c),"onUpdate:list":$},null,8,["is-open","patient"])])}}}),[["__scopeId","data-v-22f0264d"]]);export{ke as default};
