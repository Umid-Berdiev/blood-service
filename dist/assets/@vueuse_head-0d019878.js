import{B as e,n as t,g as o,C as s,b as r,D as n,w as i,E as a,u as d,i as l}from"./chunk-BGPNDDXN-dcda8805.js";function c(e,t={},o){for(const s in e){const r=e[s],n=o?`${o}:${s}`:s;"object"==typeof r&&null!==r?c(r,t,n):"function"==typeof r&&(t[n]=r)}return t}function u(e,t){return e.reduce(((e,o)=>e.then((()=>o.apply(void 0,t)))),Promise.resolve())}function p(e,t){return Promise.all(e.map((e=>e.apply(void 0,t))))}function h(e,t){for(const o of e)o(t)}function f(){return new class{constructor(){this._hooks={},this._before=void 0,this._after=void 0,this._deprecatedMessages=void 0,this._deprecatedHooks={},this.hook=this.hook.bind(this),this.callHook=this.callHook.bind(this),this.callHookWith=this.callHookWith.bind(this)}hook(e,t,o={}){if(!e||"function"!=typeof t)return()=>{};const s=e;let r;for(;this._deprecatedHooks[e];)r=this._deprecatedHooks[e],e=r.to;if(r&&!o.allowDeprecated){let e=r.message;e||(e=`${s} hook has been deprecated`+(r.to?`, please use ${r.to}`:"")),this._deprecatedMessages||(this._deprecatedMessages=new Set),this._deprecatedMessages.has(e)||(console.warn(e),this._deprecatedMessages.add(e))}return this._hooks[e]=this._hooks[e]||[],this._hooks[e].push(t),()=>{t&&(this.removeHook(e,t),t=void 0)}}hookOnce(e,t){let o,s=(...e)=>("function"==typeof o&&o(),o=void 0,s=void 0,t(...e));return o=this.hook(e,s),o}removeHook(e,t){if(this._hooks[e]){const o=this._hooks[e].indexOf(t);-1!==o&&this._hooks[e].splice(o,1),0===this._hooks[e].length&&delete this._hooks[e]}}deprecateHook(e,t){this._deprecatedHooks[e]="string"==typeof t?{to:t}:t;const o=this._hooks[e]||[];this._hooks[e]=void 0;for(const s of o)this.hook(e,s)}deprecateHooks(e){Object.assign(this._deprecatedHooks,e);for(const t in e)this.deprecateHook(t,e[t])}addHooks(e){const t=c(e),o=Object.keys(t).map((e=>this.hook(e,t[e])));return()=>{for(const e of o.splice(0,o.length))e()}}removeHooks(e){const t=c(e);for(const o in t)this.removeHook(o,t[o])}callHook(e,...t){return this.callHookWith(u,e,...t)}callHookParallel(e,...t){return this.callHookWith(p,e,...t)}callHookWith(e,t,...o){const s=this._before||this._after?{name:t,args:o,context:{}}:void 0;this._before&&h(this._before,s);const r=e(this._hooks[t]||[],o);return r instanceof Promise?r.finally((()=>{this._after&&s&&h(this._after,s)})):(this._after&&s&&h(this._after,s),r)}beforeEach(e){return this._before=this._before||[],this._before.push(e),()=>{const t=this._before.indexOf(e);-1!==t&&this._before.splice(t,1)}}afterEach(e){return this._after=this._after||[],this._after.push(e),()=>{const t=this._after.indexOf(e);-1!==t&&this._after.splice(t,1)}}}}var g=["script","style","noscript"],y=["base","meta","link","style","script","noscript"],m=["base","title","titleTemplate","bodyAttrs","htmlAttrs"];function v(e,t){const{props:o,tag:s}=e;if(m.includes(s))return s;if("link"===s&&"canonical"===o.rel)return"canonical";if(o.charset)return"charset";const r=["id"];"meta"===s&&r.push("name","property","http-equiv");for(const n of r)if(void 0!==o[n]){const e=String(o[n]);return!(t&&!t(e))&&`${s}:${n}:${e}`}return!1}var b=(e,t)=>{const{tag:o,$el:s}=e;s&&(Object.entries(o.props).forEach((([o,r])=>{r=String(r);const n=`attr:${o}`;if("class"!==o)t&&!o.startsWith("data-h-")&&t(e,n,(()=>s.removeAttribute(o))),s.getAttribute(o)!==r&&s.setAttribute(o,r);else{if(!r)return;for(const o of r.split(" ")){t&&t(e,`${n}:${o}`,(()=>s.classList.remove(o))),s.classList.contains(o)||s.classList.add(o)}}})),g.includes(o.tag)&&s.innerHTML!==(o.children||"")&&(s.innerHTML=o.children||""))};function _(e){let t=9;for(let o=0;o<e.length;)t=Math.imul(t^e.charCodeAt(o++),9**9);return(65536+(t^t>>>9)).toString(16).substring(1,8).toLowerCase()}async function k(e,t={}){var o,s;const r={shouldRender:!0};if(await e.hooks.callHook("dom:beforeRender",r),!r.shouldRender)return;const n=t.document||window.document,i=e._popSideEffectQueue();e.headEntries().map((e=>e._sde)).forEach((e=>{Object.entries(e).forEach((([e,t])=>{i[e]=t}))}));const a=async t=>{const o=e.headEntries().find((e=>e._i===t._e)),s={renderId:t._d||_(JSON.stringify({...t,_e:void 0,_p:void 0})),$el:null,shouldRender:!0,tag:t,entry:o,staleSideEffects:i};return await e.hooks.callHook("dom:beforeRenderTag",s),s},d=[],l={body:[],head:[]},c=(e,t,o)=>{t=`${e.renderId}:${t}`,e.entry&&(e.entry._sde[t]=o),delete i[t]},u=t=>{e._elMap[t.renderId]=t.$el,d.push(t),c(t,"el",(()=>{var o;null==(o=t.$el)||o.remove(),delete e._elMap[t.renderId]}))};for(const p of await e.resolveTags()){const t=await a(p);if(!t.shouldRender)continue;const{tag:r}=t;"title"!==r.tag?"htmlAttrs"!==r.tag&&"bodyAttrs"!==r.tag?(t.$el=e._elMap[t.renderId],!t.$el&&r._hash&&(t.$el=n.querySelector(`${(null==(o=r.tagPosition)?void 0:o.startsWith("body"))?"body":"head"} > ${r.tag}[data-h-${r._hash}]`)),t.$el?(t.tag._d&&b(t),u(t)):(t.$el=n.createElement(r.tag),b(t),l[(null==(s=r.tagPosition)?void 0:s.startsWith("body"))?"body":"head"].push(t))):(t.$el=n["htmlAttrs"===r.tag?"documentElement":"body"],b(t,c),d.push(t)):(n.title=r.children||"",d.push(t))}Object.entries(l).forEach((([e,t])=>{if(t.length){for(const o of[...n[e].children].reverse()){const e=o.tagName.toLowerCase();if(!y.includes(e))continue;const s=v({tag:e,props:o.getAttributeNames().reduce(((e,t)=>({...e,[t]:o.getAttribute(t)})),{})}),r=t.findIndex((e=>e&&(e.tag._d===s||o.isEqualNode(e.$el))));if(-1!==r){const e=t[r];e.$el=o,b(e),u(e),delete t[r]}}t.forEach((e=>{if(e.$el){switch(e.tag.tagPosition){case"bodyClose":n.body.appendChild(e.$el);break;case"bodyOpen":n.body.insertBefore(e.$el,n.body.firstChild);break;default:n.head.appendChild(e.$el)}u(e)}}))}}));for(const p of d)await e.hooks.callHook("dom:renderTag",p);Object.values(i).forEach((e=>e()))}var $=null;var H={__proto__:null,debouncedRenderDOMHead:async function(e,t={}){const o=t.delayFn||(e=>setTimeout(e,10));return $=$||new Promise((s=>o((()=>s(($=null,k(e,t)))))))},get domUpdatePromise(){return $},hashCode:_,renderDOMHead:k},w=["title","titleTemplate","base","htmlAttrs","bodyAttrs","meta","link","style","script","noscript"],E=["tagPosition","tagPriority","tagDuplicateStrategy"];async function A(e,t){const o={tag:e,props:{}};return"title"===e||"titleTemplate"===e?(o.children=t instanceof Promise?await t:t,o):(o.props=await async function(e){for(const t of Object.keys(e))e[t]instanceof Promise&&(e[t]=await e[t]),"true"===String(e[t])?e[t]="":"false"===String(e[t])&&delete e[t];return e}({...t}),["children","innerHtml","innerHTML"].forEach((e=>{void 0!==o.props[e]&&(o.children=o.props[e],"object"==typeof o.children&&(o.children=JSON.stringify(o.children)),delete o.props[e])})),Object.keys(o.props).filter((e=>E.includes(e))).forEach((e=>{o[e]=o.props[e],delete o.props[e]})),"object"!=typeof o.props.class||Array.isArray(o.props.class)||(o.props.class=Object.keys(o.props.class).filter((e=>o.props.class[e]))),Array.isArray(o.props.class)&&(o.props.class=o.props.class.join(" ")),o.props.content&&Array.isArray(o.props.content)?o.props.content.map(((e,t)=>{const s={...o,props:{...o.props}};return s.props.content=e,s.key=`${o.props.name||o.props.property}:${t}`,s})):o)}var O=e=>{if("number"==typeof e.tagPriority)return e.tagPriority;switch(e.tagPriority){case"critical":return 2;case"high":return 9;case"low":return 12}switch(e.tag){case"base":return-1;case"title":return 1;case"meta":return e.props.charset?-2:"content-security-policy"===e.props["http-equiv"]?0:10;default:return 10}},j=(e,t)=>O(e)-O(t),P=["base","title","titleTemplate","bodyAttrs","htmlAttrs"];var S=(e,t)=>null==e?t||null:"function"==typeof e?e(t):e.replace("%s",t??"");var T=e=>{const t=(e=e||{}).dedupeKeys||["hid","vmid","key"];return{hooks:{"tag:normalise":function({tag:e}){t.forEach((t=>{e.props[t]&&(e.key=e.props[t],delete e.props[t])}));const o=e.key?`${e.tag}:${e.key}`:function(e,t){const{props:o,tag:s}=e;if(P.includes(s))return s;if("link"===s&&"canonical"===o.rel)return"canonical";if(o.charset)return"charset";const r=["id"];"meta"===s&&r.push("name","property","http-equiv");for(const n of r)if(void 0!==o[n]){const e=String(o[n]);return!(t&&!t(e))&&`${s}:${n}:${e}`}return!1}(e);o&&(e._d=o)},"tags:resolve":function(e){const t={};e.tags.forEach((e=>{let o=e._d||e._p;const s=t[o];if(s){let r=null==e?void 0:e.tagDuplicateStrategy;if(r||"htmlAttrs"!==e.tag&&"bodyAttrs"!==e.tag||(r="merge"),"merge"===r){const r=s.props;return["class","style"].forEach((t=>{e.props[t]&&r[t]&&("style"!==t||r[t].endsWith(";")||(r[t]+=";"),e.props[t]=`${r[t]} ${e.props[t]}`)})),void(t[o].props={...r,...e.props})}e._e===s._e&&(o=e._d=`${o}:${e._p}`);const n=Object.keys(e.props).length;if((0===n||1===n&&void 0!==e.props["data-h-key"])&&!e.children)return void delete t[o]}t[o]=e})),e.tags=Object.values(t)}}}},M=()=>({hooks:{"tags:resolve":e=>{e.tags=function(e){let t=e.findIndex((e=>"titleTemplate"===e.tag));const o=e.findIndex((e=>"title"===e.tag));if(-1!==o&&-1!==t){const s=S(e[t].children,e[o].children);null!==s?e[o].children=s||e[o].children:delete e[o]}else if(-1!==t){const o=S(e[t].children);null!==o&&(e[t].children=o,e[t].tag="title",t=-1)}return-1!==t&&delete e[t],e.filter(Boolean)}(e.tags)}}}),C="undefined"!=typeof window,L=e=>({hooks:{"entries:updated":function(t){if(void 0===(null==e?void 0:e.document)&&"undefined"==typeof window)return;let o=null==e?void 0:e.delayFn;o||"undefined"==typeof requestAnimationFrame||(o=requestAnimationFrame),Promise.resolve().then((function(){return H})).then((({debouncedRenderDOMHead:s})=>{s(t,{document:(null==e?void 0:e.document)||window.document,delayFn:o})}))}}}),R=()=>{const e=(e,t)=>{const o={},s={};let r;return Object.entries(t.props).forEach((([e,t])=>{e.startsWith("on")&&"function"==typeof t?s[e]=t:o[e]=t})),"dom"===e&&"script"===t.tag&&"string"==typeof o.src&&void 0!==s.onload&&(r=o.src,delete o.src),{props:o,eventHandlers:s,delayedSrc:r}};return{hooks:{"ssr:render":function(t){t.tags=t.tags.map((t=>(t.props=e("ssr",t).props,t)))},"dom:beforeRenderTag":function(t){const{props:o,eventHandlers:s,delayedSrc:r}=e("dom",t.tag);Object.keys(s).length&&(t.tag.props=o,t.tag._eventHandlers=s,t.tag._delayedSrc=r)},"dom:renderTag":function(e){const t=e.$el;if(!e.tag._eventHandlers||!t)return;const o="bodyAttrs"===e.tag.tag&&"undefined"!=typeof window?window:t;Object.entries(e.tag._eventHandlers).forEach((([s,r])=>{const n=`${e.tag._d||e.tag._p}:${s}`,i=s.slice(2).toLowerCase(),a=`data-h-${i}`;if(delete e.staleSideEffects[n],t.hasAttribute(a))return;const d=r;t.setAttribute(a,""),o.addEventListener(i,d),e.entry&&(e.entry._sde[n]=()=>{o.removeEventListener(i,d),t.removeAttribute(a)})})),e.tag._delayedSrc&&t.setAttribute("src",e.tag._delayedSrc)}}}};var W,I=["base","meta","link","style","script","noscript"],D=()=>W;async function x(e){const t=[];return Object.entries(e.resolvedInput||e.input).filter((([e,t])=>void 0!==t&&w.includes(e))).forEach((([e,o])=>{const s=function(e){return Array.isArray(e)?e:[e]}(o);t.push(...s.map((t=>A(e,t))).flat())})),(await Promise.all(t)).flat().map(((t,o)=>(t._e=e._i,t._p=(e._i<<10)+o,t)))}var N=()=>[T(),{hooks:{"tags:resolve":e=>{const t=t=>{var o;return null==(o=e.tags.find((e=>e._d===t)))?void 0:o._p};for(const o of e.tags){if(!o.tagPriority||"number"==typeof o.tagPriority)continue;const e=[{prefix:"before:",offset:-1},{prefix:"after:",offset:1}];for(const{prefix:s,offset:r}of e)if(o.tagPriority.startsWith(s)){const e=t(o.tagPriority.replace(s,""));void 0!==e&&(o._p=e+r)}}e.tags.sort(((e,t)=>e._p-t._p)).sort(j)}}},M(),{hooks:{"tag:normalise":e=>{var t,o;const{tag:s,entry:r}=e,n=void 0!==s.props._dynamic;I.includes(s.tag)&&s.key&&(s._hash=_(JSON.stringify({tag:s.tag,key:s.key})),C||(null==(o=null==(t=D())?void 0:t.resolvedOptions)?void 0:o.document)||("server"===r._m||n)&&(s.props[`data-h-${s._hash}`]=""))},"tags:resolve":e=>{e.tags=e.tags.map((e=>(delete e.props._dynamic,e)))}}},R(),{hooks:{"tag:normalise":function({tag:e}){void 0!==e.props.body&&(e.tagPosition="bodyClose",delete e.props.body)}}}],q=(e={})=>[L({document:null==e?void 0:e.document,delayFn:null==e?void 0:e.domDelayFn})];function F(e={}){const t=function(e={}){let t=[],o={},s=0;const r=f();(null==e?void 0:e.hooks)&&r.addHooks(e.hooks);e.plugins=[...N(),...(null==e?void 0:e.plugins)||[]],e.plugins.forEach((e=>e.hooks&&r.addHooks(e.hooks)));const n=()=>r.callHook("entries:updated",i),i={resolvedOptions:e,headEntries:()=>t,get hooks(){return r},use(e){e.hooks&&r.addHooks(e.hooks)},push(e,r){const i={_i:s++,input:e,_sde:{}};return(null==r?void 0:r.mode)&&(i._m=null==r?void 0:r.mode),t.push(i),n(),{dispose(){t=t.filter((e=>e._i!==i._i||(o={...o,...e._sde||{}},e._sde={},n(),!1)))},patch(e){t=t.map((t=>(t._i===i._i&&(i.input=t.input=e,n()),t)))}}},async resolveTags(){const e={tags:[],entries:[...t]};await r.callHook("entries:resolve",e);for(const t of e.entries)for(const o of await x(t)){const s={tag:o,entry:t};await r.callHook("tag:normalise",s),e.tags.push(s.tag)}return await r.callHook("tags:resolve",e),e.tags},_elMap:{},_popSideEffectQueue(){const e={...o};return o={},e}};return i.hooks.callHook("init",i),i}({...e,plugins:[...q(e),...(null==e?void 0:e.plugins)||[]]});return(e=>{W=e})(t),t}function B(e,t=""){if(e instanceof Promise)return e;const o="function"==typeof(s=e)?s():d(s);var s;if(!e||!o)return o;if(Array.isArray(o))return o.map((e=>B(e,t)));if("object"==typeof o){let e=!1;const s=Object.fromEntries(Object.entries(o).map((([t,o])=>"titleTemplate"===t||t.startsWith("on")?[t,d(o)]:(("function"==typeof o||l(o))&&(e=!0),[t,B(o,t)]))));return e&&I.includes(String(t))&&(s._dynamic=!0),s}return o}var J=e.startsWith("3"),Q="undefined"!=typeof window,G="usehead";function K(){return o()&&s(G)||D()}var U=()=>({hooks:{"entries:resolve":function(e){for(const t of e.entries)t.resolvedInput=B(t.input)}}});function X(e,t={}){var s;const d=K();if(d){const l=Q||!!(null==(s=d.resolvedOptions)?void 0:s.document);if("server"===t.mode&&l||"client"===t.mode&&!l)return;return l?function(e,t={}){const s=K(),d=r({});n((()=>{d.value=B(e)}));const l=s.push(d.value,t);return i(d,(e=>l.patch(e))),o()&&a((()=>{l.dispose()})),l}(e,t):function(e,t={}){return K().push(e,t)}(e,t)}}var z=["script","style","noscript"],V=["base","meta","link","style","script","noscript"],Y=["base","title","titleTemplate","bodyAttrs","htmlAttrs"];function Z(e,t){const{props:o,tag:s}=e;if(Y.includes(s))return s;if("link"===s&&"canonical"===o.rel)return"canonical";if(o.charset)return"charset";const r=["id"];"meta"===s&&r.push("name","property","http-equiv");for(const n of r)if(void 0!==o[n]){const e=String(o[n]);return!(t&&!t(e))&&`${s}:${n}:${e}`}return!1}var ee=(e,t)=>{const{tag:o,$el:s}=e;s&&(Object.entries(o.props).forEach((([o,r])=>{r=String(r);const n=`attr:${o}`;if("class"!==o)t&&!o.startsWith("data-h-")&&t(e,n,(()=>s.removeAttribute(o))),s.getAttribute(o)!==r&&s.setAttribute(o,r);else{if(!r)return;for(const o of r.split(" ")){t&&t(e,`${n}:${o}`,(()=>s.classList.remove(o))),s.classList.contains(o)||s.classList.add(o)}}})),z.includes(o.tag)&&s.innerHTML!==(o.children||"")&&(s.innerHTML=o.children||""))};function te(e){let t=9;for(let o=0;o<e.length;)t=Math.imul(t^e.charCodeAt(o++),9**9);return(65536+(t^t>>>9)).toString(16).substring(1,8).toLowerCase()}async function oe(e,t={}){var o,s;const r={shouldRender:!0};if(await e.hooks.callHook("dom:beforeRender",r),!r.shouldRender)return;const n=t.document||window.document,i=e._popSideEffectQueue();e.headEntries().map((e=>e._sde)).forEach((e=>{Object.entries(e).forEach((([e,t])=>{i[e]=t}))}));const a=async t=>{const o=e.headEntries().find((e=>e._i===t._e)),s={renderId:t._d||te(JSON.stringify({...t,_e:void 0,_p:void 0})),$el:null,shouldRender:!0,tag:t,entry:o,staleSideEffects:i};return await e.hooks.callHook("dom:beforeRenderTag",s),s},d=[],l={body:[],head:[]},c=(e,t,o)=>{t=`${e.renderId}:${t}`,e.entry&&(e.entry._sde[t]=o),delete i[t]},u=t=>{e._elMap[t.renderId]=t.$el,d.push(t),c(t,"el",(()=>{var o;null==(o=t.$el)||o.remove(),delete e._elMap[t.renderId]}))};for(const p of await e.resolveTags()){const t=await a(p);if(!t.shouldRender)continue;const{tag:r}=t;"title"!==r.tag?"htmlAttrs"!==r.tag&&"bodyAttrs"!==r.tag?(t.$el=e._elMap[t.renderId],!t.$el&&r._hash&&(t.$el=n.querySelector(`${(null==(o=r.tagPosition)?void 0:o.startsWith("body"))?"body":"head"} > ${r.tag}[data-h-${r._hash}]`)),t.$el?(t.tag._d&&ee(t),u(t)):(t.$el=n.createElement(r.tag),ee(t),l[(null==(s=r.tagPosition)?void 0:s.startsWith("body"))?"body":"head"].push(t))):(t.$el=n["htmlAttrs"===r.tag?"documentElement":"body"],ee(t,c),d.push(t)):(n.title=r.children||"",d.push(t))}Object.entries(l).forEach((([e,t])=>{if(t.length){for(const o of[...n[e].children].reverse()){const e=o.tagName.toLowerCase();if(!V.includes(e))continue;const s=Z({tag:e,props:o.getAttributeNames().reduce(((e,t)=>({...e,[t]:o.getAttribute(t)})),{})}),r=t.findIndex((e=>e&&(e.tag._d===s||o.isEqualNode(e.$el))));if(-1!==r){const e=t[r];e.$el=o,ee(e),u(e),delete t[r]}}t.forEach((e=>{if(e.$el){switch(e.tag.tagPosition){case"bodyClose":n.body.appendChild(e.$el);break;case"bodyOpen":n.body.insertBefore(e.$el,n.body.firstChild);break;default:n.head.appendChild(e.$el)}u(e)}}))}}));for(const p of d)await e.hooks.callHook("dom:renderTag",p);Object.values(i).forEach((e=>e()))}var se=null;async function re(e,t={}){const o=t.delayFn||(e=>setTimeout(e,10));return se=se||new Promise((s=>o((()=>s((se=null,oe(e,t)))))))}function ne(o){const s=function(e={}){const o=F({...e,domDelayFn:e=>setTimeout((()=>t((()=>e()))),10),plugins:[U(),...(null==e?void 0:e.plugins)||[]]}),s={install(e){J&&(e.config.globalProperties.$unhead=o,e.provide(G,o))}};return o.install=s.install,o}(),r={unhead:s,install(t){e.startsWith("3")&&(t.config.globalProperties.$head=s,t.provide("usehead",s))},use(e){s.use(e)},resolveTags:()=>s.resolveTags(),headEntries:()=>s.headEntries(),headTags:()=>s.resolveTags(),push:(e,t)=>s.push(e,t),addEntry:(e,t)=>s.push(e,t),addHeadObjs:(e,t)=>s.push(e,t),addReactiveEntry(e,t){const o=X(e,t);return void 0!==o?o.dispose:()=>{}},removeHeadObjs(){},updateDOM(e,t){t?oe(s,{document:e}):re(s,{delayFn:e=>setTimeout((()=>e()),50),document:e})},internalHooks:s.hooks,hooks:{"before:dom":[],"resolved:tags":[],"resolved:entries":[]}};return s.addHeadObjs=r.addHeadObjs,s.updateDOM=r.updateDOM,s.hooks.hook("dom:beforeRender",(e=>{for(const t of r.hooks["before:dom"])!1===t()&&(e.shouldRender=!1)})),o&&r.addHeadObjs(o),r}e.startsWith("2.");export{ne as c,X as u};
