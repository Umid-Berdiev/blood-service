import{_ as e}from"./VModal.vue_vue_type_style_index_0_lang-b0507e96.js";import{_ as t}from"./SubmitButton.vue_vue_type_script_setup_true_lang-e5001c63.js";import{_ as a}from"./VFlex.vue_vue_type_style_index_0_lang-0938e556.js";import{_ as l}from"./VInput.vue_vue_type_script_setup_true_lang-29181b77.js";import{_ as n}from"./VFlexItem.vue_vue_type_style_index_0_lang-ff50e60d.js";import{_ as s,a as o}from"./VControl-fc151345.js";import{_ as i}from"./IMaskDateInput.vue_vue_type_script_setup_true_lang-5ce26ef4.js";import{a as r,b as u,r as d,o as p,w as _,s as m,l as c,t as v,q as y,Q as g,V as b,X as f,p as h,v as j,u as V,c as $,ac as x,m as w,y as D,M as k,W as M,i as F,$ as O,a0 as S}from"./chunk-BGPNDDXN-dcda8805.js";import{m as C}from"./moment-e00bdeae.js";import{u as Y}from"./chunk-3UEUFEGV-d557e6b1.js";import{u as P}from"./useNotyf-1536ae84.js";import{c as U}from"./additional-00c211e1.js";import{w as B,p as I,a as N}from"./patient-7cc4d60d.js";import{_ as q,a as A,b as E}from"./VFlexTable.vue_vue_type_style_index_0_lang-f8ff2f75.js";import{_ as L,a as z,b as G,c as Q,d as T}from"./search-7-dark-f0facebe.js";import{_ as W}from"./VCard.vue_vue_type_script_setup_true_lang-a9232da9.js";import{_ as X}from"./VButton.vue_vue_type_style_index_0_lang-27d6885c.js";import{_ as H}from"./VBreadcrumb.vue_vue_type_style_index_0_lang-d3c7c667.js";import{u as R}from"./chunk-DRAQDPQ2-4514f14e.js";import{f as J}from"./@vueuse_core-098eb702.js";import{u as K}from"./@vueuse_head-0d019878.js";import{_ as Z}from"./lodash-94527813.js";import{u as ee}from"./main-a3a6220c.js";import{u as te}from"./viewWrapper-c60f0ce7.js";import{_ as ae}from"./_plugin-vue_export-helper-1b428a4d.js";import"./VIMaskInput.vue_vue_type_script_lang-06d40a07.js";import"./userSession-0c0e9684.js";import"./pinia-3af6ce52.js";import"./VPlaceload-2a65ae53.js";const le={class:"columns"},ne={class:"column"},se={class:"is-size-5 has-text-weight-medium"},oe={class:"column"},ie={class:"is-size-5 has-text-weight-medium"},re={class:"table"},ue=["onSubmit"],de={class:"is-size-5 has-text-weight-medium"},pe={class:"table is-fullwidth"},_e={class:"help has-text-danger"},me={class:"help has-text-danger"},ce={class:"help has-text-danger"},ve=C.__esModule?C.default:C,ye=r({__name:"PrimaryScreeningFormModal",props:{isOpen:{type:Boolean,default:!1},patient:null},emits:["update:isOpen","update:list"],setup(r,{emit:V}){const $=r,x=P(),{t:w}=Y(),D=u(w("Primary_screening_form")),k=u(!1),M=u([]),F=u([{value:"normal",label:w("Normal")},{value:"below_normal",label:w("Below_normal")},{value:"above_normal",label:w("Above_normal")}]),O=d({date:ve().format("YYYY-MM-DD"),blood_type_id:null,type:"normal",value:""}),S=d({date:[],blood_type_id:[],type:[],value:[]});async function C(){var e,t,a,l,n;try{k.value=!0,await B(null==(e=$.patient)?void 0:e.id,O),V("update:list"),I()}catch(s){(null==(t=s.response)?void 0:t.data.error)?x.error(null==(a=s.response)?void 0:a.data.error):Object.assign(S,null==(n=null==(l=s.response)?void 0:l.data)?void 0:n.errors)}finally{k.value=!1}}function I(){Object.assign(O,{date:ve().format("YYYY-MM-DD"),blood_type_id:null,type:"normal",value:""}),Object.assign(S,{date:[],blood_type_id:[],type:[],value:[]}),V("update:isOpen",!1)}return p((async()=>{const e=await U();M.value=e.result})),_((()=>$.patient.last_visit),(e=>{e&&Object.assign(O,e)})),(u,d)=>{const p=i,_=s,V=o,$=m("Multiselect"),x=n,w=l,Y=a,P=t,U=e;return c(),v(U,{open:r.isOpen,size:"big",title:D.value,actions:"right",onClose:I},{content:y((()=>{var e;return[g("div",le,[g("div",ne,[g("h5",se,b(u.$t("Information_about_donor"))+" # "+b(r.patient.id),1)]),g("div",oe,[g("h5",ie,b(u.$t("Visit_date"))+": "+b(r.patient.created_at),1)])]),g("table",re,[g("tbody",null,[g("tr",null,[g("th",null,b(u.$t("Last_name")),1),g("td",null,b(r.patient.last_name),1)]),g("tr",null,[g("th",null,b(u.$t("First_name")),1),g("td",null,b(r.patient.first_name),1)]),g("tr",null,[g("th",null,b(u.$t("Middlename")),1),g("td",null,b(r.patient.father_name),1)]),g("tr",null,[g("th",null,b(u.$t("Date-of-birth")),1),g("td",null,b(r.patient.birth_date),1)]),g("tr",null,[g("th",null,b(u.$t("Gender")),1),g("td",null,b(r.patient.gender),1)]),g("tr",null,[g("th",null,b(u.$t("Visit_type")),1),g("td",null,b(null==(e=r.patient.visit)?void 0:e.visit_type),1)]),g("tr",null,[g("th",null,b(u.$t("Donor_category")),1),g("td",null,b(r.patient.patient_category_id),1)]),g("tr",null,[g("th",null,b(u.$t("Passport_series_number")),1),g("td",null,b(r.patient.passport_series)+b(r.patient.passport_number)+", "+b(r.patient.issued_by)+", "+b(r.patient.when_issued),1)])])]),g("form",{id:"primary-screening-form",class:"modal-form",onSubmit:f(C,["prevent"])},[g("h5",de,b(u.$t("Primary_screening_results")),1),g("table",pe,[g("tbody",null,[g("tr",null,[g("th",null,b(u.$t("Date_of_an_analysis")),1),g("td",null,[h(V,{required:""},{default:y((()=>[h(_,null,{default:y((()=>[h(p,{modelValue:O.date,"onUpdate:modelValue":d[0]||(d[0]=e=>O.date=e)},null,8,["modelValue"]),g("p",_e,b(S.date[0]),1)])),_:1})])),_:1})])]),g("tr",null,[g("th",null,b(u.$t("Preliminary_blood_type")),1),g("td",null,[h(V,{required:""},{default:y((()=>[h(_,null,{default:y((()=>[h($,{modelValue:O.blood_type_id,"onUpdate:modelValue":d[1]||(d[1]=e=>O.blood_type_id=e),options:M.value,placeholder:u.$t("Select"),"value-prop":"id"},null,8,["modelValue","options","placeholder"]),g("p",me,b(S.blood_type_id[0]),1)])),_:1})])),_:1})])]),g("tr",null,[g("th",null,b(u.$t("Hemoglobin")),1),g("td",null,[h(V,{required:""},{default:y((()=>[h(_,null,{default:y((()=>[h(Y,{"column-gap":"1rem","align-items":"center"},{default:y((()=>[h(x,{"flex-grow":1},{default:y((()=>[h($,{modelValue:O.type,"onUpdate:modelValue":d[2]||(d[2]=e=>O.type=e),options:F.value},null,8,["modelValue","options"])])),_:1}),h(x,null,{default:y((()=>[h(w,{modelValue:O.value,"onUpdate:modelValue":d[3]||(d[3]=e=>O.value=e),type:"text"},null,8,["modelValue"])])),_:1}),h(x,null,{default:y((()=>[j(b(u.$t("g/l")),1)])),_:1})])),_:1}),g("p",ce,b(S.value[0]),1)])),_:1})])),_:1})])])])])],40,ue)]})),action:y((()=>[h(P,{loading:k.value,form:"primary-screening-form"},null,8,["loading"])])),_:1},8,["open","title"])}}}),ge=["onSubmit"],be={class:"columns"},fe={class:"column"},he={class:"help has-text-danger"},je={class:"column"},Ve={class:"help has-text-danger"},$e={class:"column"},xe={class:"help has-text-danger"},we={class:"navigation-buttons"},De={class:"buttons is-right"},ke=r({__name:"ForScreeningDonorsFilterForm",props:{isLoading:{type:Boolean},errors:null},emits:["search","clearError","clearForm"],setup(e,{emit:t}){const{t:a}=Y();P();const l=d({donor_category_id:"",visit_type:"",donation_type_id:""}),n=u([]),i=u([{value:"gratuitous",label:a("Gratuitous")},{value:"chargeable",label:a("Chargeable")}]),r=u([{id:1,name:a("Whole_blood_donation")},{id:2,name:a("Plasmapheresis")},{id:3,name:a("Plateletpheresis")}]);p((async()=>{n.value=await I().then((e=>e.result))}));const _=async()=>{t("search",l)},$=async()=>{Object.assign(l,{donor_category_id:"",visit_type:"",donation_type_id:""}),t("clearForm")};return(t,a)=>{const u=m("Multiselect"),d=s,p=o,x=X,w=W;return c(),v(w,null,{default:y((()=>[g("form",{onSubmit:f(_,["prevent"])},[g("div",be,[g("div",fe,[h(p,{class:"is-curved-select",label:t.$t("Donor_categories")},{default:y((({id:s})=>[h(d,null,{default:y((()=>[h(u,{modelValue:V(l).donor_category_id,"onUpdate:modelValue":a[0]||(a[0]=e=>V(l).donor_category_id=e),attrs:{id:s},options:V(n),placeholder:t.$t("All"),label:"name","value-prop":"id"},null,8,["modelValue","attrs","options","placeholder"]),g("p",he,b(e.errors.donor_category_id[0]),1)])),_:2},1024)])),_:1},8,["label"])]),g("div",je,[h(p,{class:"is-curved-select",label:t.$t("Visit_type")},{default:y((({id:n})=>[h(d,null,{default:y((()=>[h(u,{modelValue:V(l).visit_type,"onUpdate:modelValue":a[1]||(a[1]=e=>V(l).visit_type=e),attrs:{id:n},options:V(i),placeholder:t.$t("All")},null,8,["modelValue","attrs","options","placeholder"]),g("p",Ve,b(e.errors.visit_type[0]),1)])),_:2},1024)])),_:1},8,["label"])]),g("div",$e,[h(p,{class:"is-curved-select",label:t.$t("Donation_type")},{default:y((({id:n})=>[h(d,null,{default:y((()=>[h(u,{modelValue:V(l).donation_type_id,"onUpdate:modelValue":a[2]||(a[2]=e=>V(l).donation_type_id=e),attrs:{id:n},options:V(r),placeholder:t.$t("All"),label:"name","value-prop":"id"},null,8,["modelValue","attrs","options","placeholder"]),g("p",xe,b(e.errors.donation_type_id[0]),1)])),_:2},1024)])),_:1},8,["label"])])]),g("div",we,[g("div",De,[h(x,{type:"button",color:"warning",bold:"",disabled:e.isLoading,tabindex:"0",onClick:$},{default:y((()=>[j(b(t.$t("Clear")),1)])),_:1},8,["disabled"]),h(x,{type:"submit",color:"primary",bold:"",loading:e.isLoading,tabindex:"0"},{default:y((()=>[j(b(t.$t("Search")),1)])),_:1},8,["loading"])])])],40,ge)])),_:1})}}}),Me=e=>(O("data-v-d2b68e0a"),e=e(),S(),e),Fe={class:"page-content-inner"},Oe={class:"columns mb-3"},Se={class:"column"},Ce={class:"columns mt-1"},Ye={class:"column"},Pe={class:"columns"},Ue={class:"column is-12"},Be=["textContent"],Ie={key:0,class:"flex-list-inner"},Ne={key:1,class:"flex-list-inner"},qe=Me((()=>g("img",{class:"light-image",src:Q,alt:""},null,-1))),Ae=Me((()=>g("img",{class:"dark-image",src:T,alt:""},null,-1))),Ee=["onClick"],Le=Z.isEmpty,ze=ae(r({__name:"index",async setup(e){let t,a;R();const l=P(),{t:n}=Y(),s=ee(),o=u(!1);te().setPageTitle(n("Screening")),K({title:`${n("Donors-list-for-primary-screening")} - ${s.app.name}`});const i=d({data:[],pagination:{total:10,count:10,per_page:10,current_page:1,total_pages:1}}),r=$({get:()=>i.pagination.current_page,set:async e=>{m.page=e,await O(m)}}),p={orderNumber:{format:(e,t,a)=>`${a+1}`},name:{label:n("Fullname")},birth_date:{label:n("Date-of-birth")},visit_date:{label:n("Visit_date"),format:(e,t)=>{var a,l;return(null==(a=t.last_visit)?void 0:a.created_at)&&J(new Date(null==(l=t.last_visit)?void 0:l.created_at),"YYYY-MM-DD")}},visit_type:{label:n("Visit_type"),format:(e,t)=>{var a,l;return(null==(a=t.last_visit)?void 0:a.visit_type)&&n(null==(l=t.last_visit)?void 0:l.visit_type)}},donation_type:{label:n("Donation_type"),format:(e,t)=>{var a,l;return null==(l=null==(a=t.last_visit)?void 0:a.donation_type)?void 0:l.name}},donor_category:{label:n("Donor_category"),format:(e,t)=>{var a;return null==(a=t.category)?void 0:a.name}}};u();const _=d({donor_category_id:[],visit_type:[],donation_type_id:[]}),m=d({page:1}),f=d({}),j=u(!1);async function O(e){var t,a;try{Object.assign(m,e),o.value=!0;const t=await N(e);Object.assign(i,t.result),Le(t.result.data)?l.warning(n("Data_not_found")):l.success(`${n("Found")}: ${t.result.pagination.total} ${n("records")}`)}catch(s){Object.assign(_,null==(a=null==(t=s.response)?void 0:t.data)?void 0:a.errors)}finally{o.value=!1}}function S(e){_[e]=""}async function C(){i.data=[]}return[t,a]=x((()=>O(m))),await t,a(),(e,t)=>{const a=H,l=ke,n=L,u=q,d=z,m=A,$=G,x=E,Y=ye;return c(),w("div",Fe,[g("div",Oe,[g("div",Se,[h(a,{"with-icons":"",separator:"bullet",items:[{label:V(s).app.name,hideLabel:!0,icon:"feather:home",to:{name:"/app/dashboard"}},{label:e.$t("Screening")},{label:e.$t("Donors-list-for-primary-screening")}]},null,8,["items"])])]),g("div",Ce,[g("div",Ye,[h(l,{"is-loading":V(o),errors:V(_),onSearch:O,onClearForm:C,onClearError:S},null,8,["is-loading","errors"])])]),g("div",Pe,[g("div",Ue,[h(x,{columns:V(p),data:V(i).data,limit:V(i).pagination.per_page,total:V(i).pagination.total},{default:y((()=>[h(m,{rounded:"","no-header":!V(o)&&0===V(i).data.length},{"header-column":y((({column:t})=>["orderNumber"===t.key?(c(),w("span",{key:0,textContent:b(e.$t("donor_no"))},null,8,Be)):D("",!0)])),body:y((()=>[V(o)?(c(),w("div",Ie,[(c(!0),w(k,null,M(V(i).pagination.per_page,(e=>(c(),w("div",{key:e,class:"flex-table-item"},[h(u,null,{default:y((()=>[h(n,{lines:2,"last-line-width":"70%",class:"mx-2"})])),_:1})])))),128))])):D("",!0),0===V(i).data.length?(c(),w("div",Ne,[h(d,{title:"No matches",subtitle:"There is no data that match your query.",class:"my-6"},{image:y((()=>[qe,Ae])),_:1})])):D("",!0)])),"body-cell":y((({row:e,column:t})=>["name"===t.key?(c(),w("a",{key:0,href:"javascript:;",class:"has-text-primary",onClick:t=>{return a=e,Object.assign(f,a),void(j.value=!0);var a}},b(e.first_name)+" "+b(e.last_name)+" "+b(e.father_name)+" ",9,Ee)):D("",!0)])),_:1},8,["no-header"]),V(i).data.length?(c(),v($,{key:0,"current-page":V(r),"onUpdate:current-page":t[0]||(t[0]=e=>F(r)?r.value=e:null),class:"mt-5","item-per-page":V(i).pagination.per_page,"total-items":V(i).pagination.total,"no-router":""},null,8,["current-page","item-per-page","total-items"])):D("",!0)])),_:1},8,["columns","data","limit","total"])])]),h(Y,{"is-open":V(j),"onUpdate:is-open":t[1]||(t[1]=e=>F(j)?j.value=e:null),patient:V(f)},null,8,["is-open","patient"])])}}}),[["__scopeId","data-v-d2b68e0a"]]);export{ze as default};
