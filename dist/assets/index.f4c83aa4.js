import{_ as e}from"./VModal.vue_vue_type_style_index_0_lang.2b7bd30b.js";import{_ as a}from"./SubmitButton.vue_vue_type_script_setup_true_lang.69dc99ac.js";import{_ as t}from"./VFlex.vue_vue_type_style_index_0_lang.71b806ec.js";import{_ as l}from"./VFlexItem.vue_vue_type_style_index_0_lang.4ed71466.js";import{_ as n,a as s}from"./VControl.db99b51d.js";import{_ as o}from"./IMaskDateInput.vue_vue_type_script_setup_true_lang.a9bf4c2a.js";import{q as i,H as r,C as d,x as u,r as _,j as p,o as m,a as c,w as v,e as b,t as y,m as g,k as f,A as h,i as V,E as x,J as $,c as j,a7 as w,ah as D,d as k,K as M,g as F,F as I,l as C,S as O,L as S,M as Y}from"./index.4a029cdd.js";import{m as B}from"./moment.48108465.js";import{q as P,p as U,a as z}from"./patient.664695df.js";import{_ as A,a as L,b as q}from"./VFlexTable.vue_vue_type_style_index_0_lang.25ade395.js";import{_ as E,a as N,b as T,c as G,d as H}from"./search-7-dark.f359dc05.js";import{_ as W}from"./VCard.vue_vue_type_script_setup_true_lang.b8abd6f0.js";import{_ as J}from"./VButton.vue_vue_type_style_index_0_lang.3d7c5df0.js";import{_ as K}from"./VBreadcrumb.vue_vue_type_style_index_0_lang.b7e8a70f.js";import{_ as Q}from"./lodash.b2d9c938.js";import{u as R}from"./main.31b19d1c.js";import{u as X}from"./viewWrapper.1a3e0821.js";import{_ as Z}from"./_plugin-vue_export-helper.cdc0426e.js";import"./VIMaskInput.vue_vue_type_script_lang.55c4b218.js";import"./VPlaceload.cc73600a.js";const ee={class:"columns"},ae={class:"column"},te={class:"is-size-5 has-text-weight-medium"},le={class:"column"},ne={class:"is-size-5 has-text-weight-medium"},se={class:"table"},oe=["onSubmit"],ie={class:"is-size-5 has-text-weight-medium"},re={class:"table is-fullwidth"},de={class:"help has-text-danger"},ue={class:"help has-text-danger"},_e=["value"],pe={class:"help has-text-danger"},me=B.__esModule?B.default:B,ce=i({__name:"PrimaryScreeningFormModal",props:{isOpen:{type:Boolean,default:!1},patient:null},emits:["update:isOpen","update:list"],setup(i,{emit:h}){const V=i,x=r(),{t:$}=d(),j=u($("Primary_screening_form")),w=u(!1),D=u([{value:"o1",label:"O(I)"},{value:"a2",label:"A(II)"},{value:"b3",label:"B(III)"},{value:"ab4",label:"AB(IV)"}]),k=u([{value:"normal",label:$("Normal")},{value:"below_normal",label:$("Below_normal")},{value:"above_normal",label:$("Above_normal")}]),M=_({analysis_date:me().format("YYYY-MM-DD"),preliminary_blood_type:"o1",hemoglobin:"normal"}),F=_({analysis_date:[],preliminary_blood_type:[],hemoglobin:[]});async function I(){var e,a,t,l,n;try{w.value=!0,await P(null==(e=V.patient)?void 0:e.id,M),h("update:list"),C()}catch(s){(null==(a=s.response)?void 0:a.data.error)?x.error(null==(t=s.response)?void 0:t.data.error):Object.assign(F,null==(n=null==(l=s.response)?void 0:l.data)?void 0:n.errors)}finally{w.value=!1}}function C(){Object.assign(M,{analysis_date:me().format("YYYY-MM-DD"),preliminary_blood_type:"o1",hemoglobin:"normal"}),Object.assign(F,{analysis_date:[],preliminary_blood_type:[],hemoglobin:[]}),h("update:isOpen",!1)}return(r,d)=>{const u=o,_=n,h=s,V=p("Multiselect"),x=l,$=t,O=a,S=e;return m(),c(S,{open:i.isOpen,size:"big",title:j.value,actions:"right",onClose:C},{content:v((()=>{var e;return[b("div",ee,[b("div",ae,[b("h5",te,y(r.$t("Information_about_donor"))+" # "+y(i.patient.id),1)]),b("div",le,[b("h5",ne,y(r.$t("Visit_date"))+": "+y(i.patient.created_at),1)])]),b("table",se,[b("tbody",null,[b("tr",null,[b("th",null,y(r.$t("Last_name")),1),b("td",null,y(i.patient.last_name),1)]),b("tr",null,[b("th",null,y(r.$t("First_name")),1),b("td",null,y(i.patient.first_name),1)]),b("tr",null,[b("th",null,y(r.$t("Middlename")),1),b("td",null,y(i.patient.father_name),1)]),b("tr",null,[b("th",null,y(r.$t("Date-of-birth")),1),b("td",null,y(i.patient.birth_date),1)]),b("tr",null,[b("th",null,y(r.$t("Gender")),1),b("td",null,y(i.patient.gender),1)]),b("tr",null,[b("th",null,y(r.$t("Visit_type")),1),b("td",null,y(null==(e=i.patient.visit)?void 0:e.visit_type),1)]),b("tr",null,[b("th",null,y(r.$t("Donor_category")),1),b("td",null,y(i.patient.patient_category_id),1)]),b("tr",null,[b("th",null,y(r.$t("Passport_series_number")),1),b("td",null,y(i.patient.passport_series)+y(i.patient.passport_number)+", "+y(i.patient.issued_by)+", "+y(i.patient.when_issued),1)])])]),b("form",{id:"primary-screening-form",class:"modal-form",onSubmit:g(I,["prevent"])},[b("h5",ie,y(r.$t("Primary_screening_results")),1),b("table",re,[b("tbody",null,[b("tr",null,[b("th",null,y(r.$t("Date_of_an_analysis")),1),b("td",null,[f(h,{required:""},{default:v((()=>[f(_,null,{default:v((()=>[f(u,{modelValue:M.analysis_date,"onUpdate:modelValue":d[0]||(d[0]=e=>M.analysis_date=e)},null,8,["modelValue"]),b("p",de,y(F.analysis_date[0]),1)])),_:1})])),_:1})])]),b("tr",null,[b("th",null,y(r.$t("Preliminary_blood_type")),1),b("td",null,[f(h,{required:""},{default:v((()=>[f(_,null,{default:v((()=>[f(V,{modelValue:M.preliminary_blood_type,"onUpdate:modelValue":d[1]||(d[1]=e=>M.preliminary_blood_type=e),options:D.value},null,8,["modelValue","options"]),b("p",ue,y(F.analysis_date[0]),1)])),_:1})])),_:1})])]),b("tr",null,[b("th",null,y(r.$t("Hemoglobin")),1),b("td",null,[f(h,{required:""},{default:v((()=>[f(_,null,{default:v((()=>[f($,null,{default:v((()=>[f(x,{"flex-grow":1},{default:v((()=>[f(V,{modelValue:M.hemoglobin,"onUpdate:modelValue":d[2]||(d[2]=e=>M.hemoglobin=e),options:k.value},null,8,["modelValue","options"])])),_:1}),f(x,null,{default:v((()=>[b("input",{class:"input",type:"text",value:r.$t("g/l"),style:{width:"3rem"}},null,8,_e)])),_:1})])),_:1}),b("p",pe,y(F.analysis_date[0]),1)])),_:1})])),_:1})])])])])],40,oe)]})),action:v((({close:e})=>[f(O,{loading:w.value,form:"primary-screening-form"},null,8,["loading"])])),_:1},8,["open","title"])}}}),ve=["onSubmit"],be={class:"columns"},ye={class:"column"},ge={class:"help has-text-danger"},fe={class:"column"},he={class:"help has-text-danger"},Ve={class:"column"},xe={class:"help has-text-danger"},$e={class:"navigation-buttons"},je={class:"buttons is-right"},we=i({__name:"ForScreeningDonorsFilterForm",props:{isLoading:{type:Boolean},errors:null},emits:["search","clearError","clearForm"],setup(e,{emit:a}){const{t:t}=d();r();const l=_({donor_category_id:"",visit_type:"",donation_type_id:""}),o=u([]),i=u([{value:"gratuitous",label:t("Gratuitous")},{value:"chargeable",label:t("Chargeable")}]),x=u([{id:1,name:t("Whole_blood_donation")},{id:2,name:t("Plasmapheresis")},{id:3,name:t("Plateletpheresis")}]);h((async()=>{o.value=await U().then((e=>e.result))}));const $=async()=>{a("search",l)},j=async()=>{Object.assign(l,{donor_category_id:"",visit_type:"",donation_type_id:""}),a("clearForm")};return(a,t)=>{const r=p("Multiselect"),d=n,u=s,_=J,h=W;return m(),c(h,null,{default:v((()=>[b("form",{onSubmit:g($,["prevent"])},[b("div",be,[b("div",ye,[f(u,{class:"is-curved-select",label:a.$t("Donor_categories")},{default:v((({id:n})=>[f(d,null,{default:v((()=>[f(r,{modelValue:l.donor_category_id,"onUpdate:modelValue":t[0]||(t[0]=e=>l.donor_category_id=e),attrs:{id:n},options:o.value,placeholder:a.$t("All"),label:"name","value-prop":"id"},null,8,["modelValue","attrs","options","placeholder"]),b("p",ge,y(e.errors.donor_category_id[0]),1)])),_:2},1024)])),_:1},8,["label"])]),b("div",fe,[f(u,{class:"is-curved-select",label:a.$t("Visit_type")},{default:v((({id:n})=>[f(d,null,{default:v((()=>[f(r,{modelValue:l.visit_type,"onUpdate:modelValue":t[1]||(t[1]=e=>l.visit_type=e),attrs:{id:n},options:i.value,placeholder:a.$t("All")},null,8,["modelValue","attrs","options","placeholder"]),b("p",he,y(e.errors.visit_type[0]),1)])),_:2},1024)])),_:1},8,["label"])]),b("div",Ve,[f(u,{class:"is-curved-select",label:a.$t("Donation_type")},{default:v((({id:n})=>[f(d,null,{default:v((()=>[f(r,{modelValue:l.donation_type_id,"onUpdate:modelValue":t[2]||(t[2]=e=>l.donation_type_id=e),attrs:{id:n},options:x.value,placeholder:a.$t("All"),label:"name","value-prop":"id"},null,8,["modelValue","attrs","options","placeholder"]),b("p",xe,y(e.errors.donation_type_id[0]),1)])),_:2},1024)])),_:1},8,["label"])])]),b("div",$e,[b("div",je,[f(_,{type:"button",color:"warning",bold:"",disabled:e.isLoading,tabindex:"0",onClick:j},{default:v((()=>[V(y(a.$t("Clear")),1)])),_:1},8,["disabled"]),f(_,{type:"submit",color:"primary",bold:"",loading:e.isLoading,tabindex:"0"},{default:v((()=>[V(y(a.$t("Search")),1)])),_:1},8,["loading"])])])],40,ve)])),_:1})}}}),De=e=>(S("data-v-38ef7292"),e=e(),Y(),e),ke={class:"page-content-inner"},Me={class:"columns mb-3"},Fe={class:"column"},Ie={class:"columns mt-1"},Ce={class:"column"},Oe={class:"columns"},Se={class:"column is-12"},Ye=["textContent"],Be={key:0,class:"flex-list-inner"},Pe={key:1,class:"flex-list-inner"},Ue=De((()=>b("img",{class:"light-image",src:G,alt:""},null,-1))),ze=De((()=>b("img",{class:"dark-image",src:H,alt:""},null,-1))),Ae=["onClick"],Le=Q.isEmpty,qe=Z(i({__name:"index",async setup(e){let a,t;x();const l=r(),{t:n}=d(),s=R(),o=u(!1);X().setPageTitle(n("Screening")),$({title:`${n("Donors-list-for-primary-screening")} - ${s.app.name}`});const i=_({data:[],pagination:{total:10,count:10,per_page:10,current_page:1,total_pages:1}}),p=j({get:()=>i.pagination.current_page,set:async e=>{V.page=e,await B(V)}}),g={orderNumber:{format:(e,a,t)=>`${t+1}`},name:{label:n("Fullname")},birth_date:{label:n("Date-of-birth")},visit_date:{label:n("Visit_date"),format:(e,a)=>{var t,l;return(null==(t=a.last_visit)?void 0:t.created_at)&&w(new Date(null==(l=a.last_visit)?void 0:l.created_at),"YYYY-MM-DD")}},visit_type:{label:n("Visit_type"),format:(e,a)=>{var t,l;return(null==(t=a.last_visit)?void 0:t.visit_type)&&n(null==(l=a.last_visit)?void 0:l.visit_type)}},medical_inspection_date:{label:n("Medical_inspection_date"),format:(e,a)=>{var t,l;return(null==(t=a.last_visit)?void 0:t.directed_by)&&n(null==(l=a.last_visit)?void 0:l.directed_by)}},medical_inspection_conclusion:{label:n("Medical_inspection_conclusion"),format:(e,a)=>{var t;return null==(t=a.last_visit)?void 0:t.personalized_donation}},linked_donation_number:{label:n("Linked_donation_number"),format:(e,a)=>{var t;return null==(t=a.last_visit)?void 0:t.personalized_donation}},donation_type:{label:n("Donation_type"),format:(e,a)=>{var t;return null==(t=a.last_visit)?void 0:t.personalized_donation}},blood_component_amount:{label:n("Blood_component_amount"),format:(e,a)=>{var t;return null==(t=a.status)?void 0:t.name}}};u();const h=_({donor_category_id:[],visit_type:[],donation_type_id:[]}),V=_({page:1}),S=_({}),Y=u(!1);async function B(e){var a,t;try{Object.assign(V,e),o.value=!0;const a=await z(e);Object.assign(i,a.result),Le(a.result.data)?l.warning(n("Data_not_found")):l.success(`${n("Found")}: ${a.result.pagination.total} ${n("records")}`)}catch(s){Object.assign(h,null==(t=null==(a=s.response)?void 0:a.data)?void 0:t.errors)}finally{o.value=!1}}function P(e){h[e]=""}async function U(){i.data=[]}return[a,t]=D((()=>B(V))),await a,t(),(e,a)=>{const t=K,l=we,n=E,r=A,d=N,u=L,_=T,V=q,x=ce;return m(),k("div",ke,[b("div",Me,[b("div",Fe,[f(t,{"with-icons":"",separator:"bullet",items:[{label:M(s).app.name,hideLabel:!0,icon:"feather:home",to:{name:"/app/dashboard"}},{label:e.$t("Screening")},{label:e.$t("Donors-list-for-primary-screening")}]},null,8,["items"])])]),b("div",Ie,[b("div",Ce,[f(l,{"is-loading":o.value,errors:h,onSearch:B,onClearForm:U,onClearError:P},null,8,["is-loading","errors"])])]),b("div",Oe,[b("div",Se,[f(V,{columns:M(g),data:i.data,limit:i.pagination.per_page,total:i.pagination.total},{default:v((()=>[f(u,{rounded:"","no-header":!o.value&&0===i.data.length},{"header-column":v((({column:a})=>["orderNumber"===a.key?(m(),k("span",{key:0,textContent:y(e.$t("Donor_register_number"))},null,8,Ye)):F("",!0)])),body:v((()=>[o.value?(m(),k("div",Be,[(m(!0),k(I,null,C(i.pagination.per_page,(e=>(m(),k("div",{key:e,class:"flex-table-item"},[f(r,null,{default:v((()=>[f(n,{lines:2,"last-line-width":"70%",class:"mx-2"})])),_:1})])))),128))])):F("",!0),0===i.data.length?(m(),k("div",Pe,[f(d,{title:"No matches",subtitle:"There is no data that match your query.",class:"my-6"},{image:v((()=>[Ue,ze])),_:1})])):F("",!0)])),"body-cell":v((({row:e,column:a})=>["name"===a.key?(m(),k("button",{key:0,class:"button button-link",onClick:a=>{return t=e,Object.assign(S,t),void(Y.value=!0);var t}},y(e.first_name)+" "+y(e.last_name)+" "+y(e.father_name),9,Ae)):F("",!0)])),_:1},8,["no-header"]),i.data.length?(m(),c(_,{key:0,"current-page":M(p),"onUpdate:current-page":a[0]||(a[0]=e=>O(p)?p.value=e:null),class:"mt-5","item-per-page":i.pagination.per_page,"total-items":i.pagination.total,"no-router":""},null,8,["current-page","item-per-page","total-items"])):F("",!0)])),_:1},8,["columns","data","limit","total"])])]),f(x,{"is-open":Y.value,"onUpdate:is-open":a[1]||(a[1]=e=>Y.value=e),patient:S},null,8,["is-open","patient"])])}}}),[["__scopeId","data-v-38ef7292"]]);export{qe as default};
