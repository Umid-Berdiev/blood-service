import{_ as e,a,b as t}from"./VFlexTable.vue_vue_type_style_index_0_lang-6eeebdac.js";import{_ as l,a as s}from"./VPlaceloadText.vue_vue_type_style_index_0_lang-8916ac45.js";import{_ as n}from"./NoDataPlaceholder-50105cc5.js";import{_ as i}from"./VCard.vue_vue_type_script_setup_true_lang-8d45bf90.js";import{_ as r}from"./SubmitButton.vue_vue_type_script_setup_true_lang-dc9d0236.js";import{_ as o}from"./ClearButton.vue_vue_type_script_setup_true_lang-422ea292.js";import{b as _,a as d,_ as u}from"./VControl-90e6c9df.js";import{_ as p}from"./DateRangePicker.vue_vue_type_script_setup_true_lang-ea8c86d4.js";import{q as c,C as m,H as v,r as g,ag as y,x as b,y as f,j as h,o as j,a as x,w as V,e as $,m as k,k as w,i as S,t as C,K as D,E as F,J as P,a7 as L,d as O,g as B,F as U,l as Y}from"./index-202d6ef0.js";import{p as M}from"./patient-4b952528.js";import{_ as N}from"./VBreadcrumb.vue_vue_type_style_index_0_lang-e8162493.js";import{u as T}from"./main-1fdef032.js";import{u as A}from"./viewWrapper-93d6f948.js";import{f as H}from"./index-41a50a98.js";import{_ as q}from"./_plugin-vue_export-helper-1b428a4d.js";import"./VFlex.vue_vue_type_style_index_0_lang-5c9a78f5.js";import"./VButton.vue_vue_type_style_index_0_lang-8a17f68b.js";import"./ClientOnly.vue_vue_type_script_lang-3cf31693.js";const E=["onSubmit"],G={class:"columns"},I={class:"column"},J={class:"column"},K={class:"column"},R={class:"navigation-buttons"},W={class:"buttons is-right"},Z=c({__name:"ScreeningPassedDonorsFilterForm",props:{isLoading:{type:Boolean}},emits:["search","clearForm"],async setup(e,{emit:a}){let t,l;const{t:s}=m();v();const n=g({start_date:"",end_date:"",donor_category_id:"",visit_type_id:""}),c=([t,l]=y((()=>M().then((e=>e.result)))),t=await t,l(),t),F=b([{value:"gratuitous",label:s("Gratuitous")},{value:"chargeable",label:s("Chargeable")}]),P=b(!1);f(n,(e=>{e&&(P.value=Object.values(e).some((e=>!!e)))}),{deep:!0});const L=async()=>{a("search",n)},O=async()=>{Object.assign(n,{start_date:"",end_date:"",donor_category_id:"",visit_type_id:""}),a("clearForm")};return(a,t)=>{const l=_,s=p,m=d,v=h("Multiselect"),g=u,y=o,b=r,f=i;return j(),x(f,null,{default:V((()=>[$("form",{onSubmit:k(L,["prevent"])},[$("div",G,[$("div",I,[w(m,null,{default:V((()=>[w(l,null,{default:V((()=>[S(C(a.$t("Period")),1)])),_:1}),w(s,{start:D(n).start_date,"onUpdate:start":t[0]||(t[0]=e=>D(n).start_date=e),end:D(n).end_date,"onUpdate:end":t[1]||(t[1]=e=>D(n).end_date=e)},null,8,["start","end"])])),_:1})]),$("div",J,[w(m,{class:"is-curved-select",label:a.$t("Donor_categories")},{default:V((({id:e})=>[w(g,null,{default:V((()=>[w(v,{modelValue:D(n).donor_category_id,"onUpdate:modelValue":t[2]||(t[2]=e=>D(n).donor_category_id=e),attrs:{id:e},options:D(c),placeholder:a.$t("All"),label:"name","value-prop":"id"},null,8,["modelValue","attrs","options","placeholder"])])),_:2},1024)])),_:1},8,["label"])]),$("div",K,[w(m,{class:"is-curved-select",label:a.$t("Visit_type")},{default:V((({id:e})=>[w(g,null,{default:V((()=>[w(v,{modelValue:D(n).visit_type_id,"onUpdate:modelValue":t[3]||(t[3]=e=>D(n).visit_type_id=e),attrs:{id:e},options:D(F),placeholder:a.$t("All")},null,8,["modelValue","attrs","options","placeholder"])])),_:2},1024)])),_:1},8,["label"])])]),$("div",R,[$("div",W,[w(y,{disabled:e.isLoading||!D(P),onClear:O},null,8,["disabled"]),w(b,{loading:e.isLoading},{default:V((()=>[S(C(a.$t("Search")),1)])),_:1},8,["loading"])])])],40,E)])),_:1})}}}),z={class:"page-content-inner"},Q={class:"columns mb-3"},X={class:"column"},ee={class:"columns mt-1"},ae={class:"column"},te={class:"columns"},le={class:"column is-12"},se=["textContent"],ne={key:0,class:"flex-list-inner"},ie={key:0},re=q(c({__name:"index",async setup(i){let r,o;F(),v();const{t:_}=m(),d=T(),u=b(!1);A().setPageTitle(_("Screening")),P({title:`${_("Screening-passed-donors-list")} - ${d.app.name}`});const p=g({data:[],pagination:{total:10,count:10,per_page:10,current_page:1,total_pages:1}}),c={orderNumber:{format:(e,a,t)=>`${t+1}`,align:"center"},screening_date:{label:_("Screening_date"),format:(e,a)=>{var t,l,s;return(null==(t=a.last_visit)?void 0:t.primary_screening_result)&&L(new Date(null==(s=null==(l=a.last_visit)?void 0:l.primary_screening_result)?void 0:s.created_at),"DD.MM.YYYY")}},name:{label:_("Donor_fullname")},birth_date:{label:_("Date-of-birth")},visit_date:{label:_("Visit_date"),format:(e,a)=>{var t;return null==(t=a.last_visit)?void 0:t.created_at}},visit_type:{label:_("Visit_type"),format:(e,a)=>{var t,l;return(null==(t=a.last_visit)?void 0:t.visit_type)&&_(null==(l=a.last_visit)?void 0:l.visit_type)}},hemoglobin:{label:`${_("Hemoglobin")}, ${_("g/l")}`,format:(e,a)=>{var t,l;return null==(l=null==(t=a.last_visit)?void 0:t.primary_screening_result)?void 0:l.value},align:"center"},preliminary_blood_type:{label:_("Preliminary_blood_type"),format:(e,a)=>{var t,l,s;return null==(s=null==(l=null==(t=a.last_visit)?void 0:t.primary_screening_result)?void 0:l.blood_type)?void 0:s.label},align:"center"},laboratory_assistant_fullname:{label:_("Laboratory_assistant_fullname"),format:(e,a)=>{var t,l;return null==(l=null==(t=a.last_visit)?void 0:t.primary_screening_result)?void 0:l.created_by}}},h=g({start_date:[],end_date:[],donor_category_id:[],visit_type_id:[]}),k=g({page:1});async function S(e){var a,t;try{u.value=!0,Object.assign(k,e);const a=await H(e);Object.assign(p,a.result)}catch(l){Object.assign(h,null==(t=null==(a=l.response)?void 0:a.data)?void 0:t.errors)}finally{u.value=!1}}async function M(){await S(k)}return[r,o]=y((()=>S(k))),await r,o(),f((()=>p.pagination.current_page),(async e=>{e&&(k.page=e,await S(k))})),(i,r)=>{const o=N,_=Z,m=l,v=e,g=n,y=a,b=s,f=t;return j(),O("div",z,[$("div",Q,[$("div",X,[w(o,{"with-icons":"",separator:"bullet",items:[{label:D(d).app.name,hideLabel:!0,icon:"feather:home",to:{name:"/app/dashboard"}},{label:i.$t("Screening")},{label:i.$t("Screening-passed-donors-list")}]},null,8,["items"])])]),$("div",ee,[$("div",ae,[w(_,{"is-loading":D(u),onSearch:S,onClearForm:M},null,8,["is-loading"])])]),$("div",te,[$("div",le,[w(f,{columns:D(c),data:D(p).data,limit:D(p).pagination.per_page,total:D(p).pagination.total},{default:V((()=>[w(y,{rounded:"","no-header":!D(u)&&0===D(p).data.length},{"header-column":V((({column:e})=>["orderNumber"===e.key?(j(),O("span",{key:0,textContent:C(i.$t("donor_no"))},null,8,se)):B("",!0)])),body:V((()=>[D(u)?(j(),O("div",ne,[(j(!0),O(U,null,Y(D(p).pagination.per_page,(e=>(j(),O("div",{key:e,class:"flex-table-item"},[w(v,null,{default:V((()=>[w(m,{lines:2,"last-line-width":"70%",class:"mx-2"})])),_:1})])))),128))])):B("",!0),0===D(p).data.length?(j(),x(g,{key:1})):B("",!0)])),"body-cell":V((({row:e,column:a})=>["name"===a.key?(j(),O("span",ie,C(e.first_name)+" "+C(e.last_name)+" "+C(e.father_name),1)):B("",!0)])),_:1},8,["no-header"]),D(p).data.length?(j(),x(b,{key:0,"current-page":D(p).pagination.current_page,"onUpdate:current-page":r[0]||(r[0]=e=>D(p).pagination.current_page=e),class:"mt-5","item-per-page":D(p).pagination.per_page,"total-items":D(p).pagination.total,"no-router":""},null,8,["current-page","item-per-page","total-items"])):B("",!0)])),_:1},8,["columns","data","limit","total"])])])])}}}),[["__scopeId","data-v-db6f01a8"]]);export{re as default};
