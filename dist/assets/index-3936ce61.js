import{_ as a}from"./VModal.vue_vue_type_style_index_0_lang-1ec5e12b.js";import{_ as t}from"./SubmitButton.vue_vue_type_script_setup_true_lang-ca217c20.js";import{_ as e}from"./VFlex.vue_vue_type_style_index_0_lang-8f30b873.js";import{_ as l,a as o}from"./VControl-b713a764.js";import{_ as n}from"./IMaskDateInput.vue_vue_type_script_setup_true_lang-38070980.js";import{_ as i}from"./VFlexItem.vue_vue_type_style_index_0_lang-ce376e13.js";import{q as s,H as r,C as d,x as _,r as u,o as p,a as m,w as c,e as b,t as g,m as v,k as f,i as y,j as h,K as x,E as j,J as V,c as $,a6 as Y,d as D,g as M,F as w,l as k,S as F,L as B,M as C}from"./index-568ad137.js";import{m as O}from"./moment-78dc6435.js";import{c as S,f as I}from"./patient-33059bc9.js";import{_ as U,a as z,b as L}from"./VFlexTable.vue_vue_type_style_index_0_lang-68179e43.js";import{_ as E,a as q,b as T,c as N,d as P}from"./search-7-dark-b6479367.js";import{_ as A}from"./VCard.vue_vue_type_script_setup_true_lang-3b674ece.js";import{_ as W}from"./VButton.vue_vue_type_style_index_0_lang-fc4409cd.js";import{_ as G}from"./lodash-c54dbb06.js";import{v as H,d as J}from"./additionals-54944bbf.js";import{_ as K}from"./VBreadcrumb.vue_vue_type_style_index_0_lang-faf20e2b.js";import{u as X}from"./main-7fc6984e.js";import{u as Z}from"./viewWrapper-feca89b2.js";import{_ as Q}from"./_plugin-vue_export-helper-1b428a4d.js";import"./VIMaskInput.vue_vue_type_script_lang-6492e1cb.js";import"./VPlaceload-33f57994.js";const R={class:"columns"},aa={class:"column"},ta={class:"is-size-5 has-text-weight-medium"},ea={class:"column"},la={class:"is-size-5 has-text-weight-medium"},oa={class:"table"},na=["onSubmit"],ia={class:"is-size-5 has-text-weight-medium"},sa=b("br",null,null,-1),ra={class:"help has-text-danger"},da=b("br",null,null,-1),_a={class:"table is-fullwidth"},ua={class:"help has-text-danger"},pa={class:"help has-text-danger"},ma=O.__esModule?O.default:O,ca=s({__name:"BloodSamplingFormModal",props:{isOpen:{type:Boolean,default:!1},patient:null},emits:["update:isOpen","update:list"],setup(s,{emit:h}){const x=s,j=r(),{t:V}=d(),$=_(V("Sampling_data_entry_form")),Y=_(!1),D=u({blood_sampling_date:ma().format("YYYY-MM-DD"),bloodborne_infections_laboratory_date:ma().format("YYYY-MM-DD"),clinical_biochemical_laboratory_date:ma().format("YYYY-MM-DD")}),M=u({blood_sampling_date:[],bloodborne_infections_laboratory_date:[],clinical_biochemical_laboratory_date:[]});async function w(){var a,t,e,l,o;try{Y.value=!0,await S(null==(a=x.patient)?void 0:a.id,D),h("update:list"),k()}catch(n){(null==(t=n.response)?void 0:t.data.error)?j.error(null==(e=n.response)?void 0:e.data.error):Object.assign(M,null==(o=null==(l=n.response)?void 0:l.data)?void 0:o.errors)}finally{Y.value=!1}}function k(){Object.assign(D,{blood_sampling_date:ma().format("YYYY-MM-DD"),bloodborne_infections_laboratory_date:ma().format("YYYY-MM-DD"),clinical_biochemical_laboratory_date:ma().format("YYYY-MM-DD")}),Object.assign(M,{blood_sampling_date:[],bloodborne_infections_laboratory_date:[],clinical_biochemical_laboratory_date:[]}),h("update:isOpen",!1)}return(r,d)=>{const _=i,u=n,h=l,x=o,j=e,V=t,F=a;return p(),m(F,{open:s.isOpen,size:"big",title:$.value,actions:"right",onClose:k},{content:c((()=>{var a;return[b("div",R,[b("div",aa,[b("h5",ta,g(r.$t("Donor_information"))+" # "+g(s.patient.id),1)]),b("div",ea,[b("h5",la,g(r.$t("Visit_date"))+": "+g(s.patient.created_at),1)])]),b("table",oa,[b("tbody",null,[b("tr",null,[b("th",null,g(r.$t("Last_name")),1),b("td",null,g(s.patient.last_name),1)]),b("tr",null,[b("th",null,g(r.$t("First_name")),1),b("td",null,g(s.patient.first_name),1)]),b("tr",null,[b("th",null,g(r.$t("Middlename")),1),b("td",null,g(s.patient.father_name),1)]),b("tr",null,[b("th",null,g(r.$t("Date-of-birth")),1),b("td",null,g(s.patient.birth_date),1)]),b("tr",null,[b("th",null,g(r.$t("Gender")),1),b("td",null,g(s.patient.gender),1)]),b("tr",null,[b("th",null,g(r.$t("Visit_type")),1),b("td",null,g(null==(a=s.patient.visit)?void 0:a.visit_type),1)]),b("tr",null,[b("th",null,g(r.$t("Donor_category")),1),b("td",null,g(s.patient.patient_category_id),1)]),b("tr",null,[b("th",null,g(r.$t("Passport_series_number")),1),b("td",null,g(s.patient.passport_series)+g(s.patient.passport_number)+", "+g(s.patient.issued_by)+", "+g(s.patient.when_issued),1)])])]),b("form",{id:"blood-sampling-form",class:"modal-form",onSubmit:v(w,["prevent"])},[b("h5",ia,g(r.$t("Information_about_blood_sampling")),1),sa,f(j,{"column-gap":"1rem","align-items":"center"},{default:c((()=>[f(_,null,{default:c((()=>[y(g(r.$t("Blood_sampling_date")),1)])),_:1}),f(_,null,{default:c((()=>[f(x,null,{default:c((()=>[f(h,null,{default:c((()=>[f(u,{modelValue:D.blood_sampling_date,"onUpdate:modelValue":d[0]||(d[0]=a=>D.blood_sampling_date=a)},null,8,["modelValue"]),b("p",ra,g(M.blood_sampling_date[0]),1)])),_:1})])),_:1})])),_:1})])),_:1}),da,b("table",_a,[b("thead",null,[b("tr",null,[b("th",null,g(r.$t("Blood_sample_transferred_where")),1),b("th",null,g(r.$t("Blood_sample_transferred_when")),1)])]),b("tbody",null,[b("tr",null,[b("td",null,g(r.$t("Bloodborne-infections-laboratory")),1),b("td",null,[f(x,{required:""},{default:c((()=>[f(h,null,{default:c((()=>[f(u,{modelValue:D.bloodborne_infections_laboratory_date,"onUpdate:modelValue":d[1]||(d[1]=a=>D.bloodborne_infections_laboratory_date=a)},null,8,["modelValue"]),b("p",ua,g(M.bloodborne_infections_laboratory_date[0]),1)])),_:1})])),_:1})])]),b("tr",null,[b("td",null,g(r.$t("Clinical-biochemical-laboratory")),1),b("td",null,[f(x,{required:""},{default:c((()=>[f(h,null,{default:c((()=>[f(u,{modelValue:D.clinical_biochemical_laboratory_date,"onUpdate:modelValue":d[2]||(d[2]=a=>D.clinical_biochemical_laboratory_date=a)},null,8,["modelValue"]),b("p",pa,g(M.clinical_biochemical_laboratory_date[0]),1)])),_:1})])),_:1})])])])])],40,na)]})),action:c((({close:a})=>[f(V,{loading:Y.value,form:"blood-sampling-form"},null,8,["loading"])])),_:1},8,["open","title"])}}}),ba=["onSubmit"],ga={class:"columns"},va={class:"column is-3"},fa={class:"help has-text-danger"},ya={class:"column is-3"},ha={class:"help has-text-danger"},xa={class:"navigation-buttons"},ja={class:"buttons is-right"},Va=G.isEmpty,$a=G.values,Ya=s({__name:"BloodSamplingFilterForm",props:{isLoading:{type:Boolean},errors:null},emits:["search","clearError","clearForm"],setup(a,{emit:t}){const{t:e}=d(),n=r(),i=u({visit_type_id:"",donation_type_id:""}),s=async()=>{$a(i).every(Va)?n.error(e("Form_fields_are_empty")):t("search",i)},_=async()=>{Object.assign(i,{visit_type_id:"",donation_type_id:""}),t("clearForm")};return(t,e)=>{const n=h("Multiselect"),r=l,d=o,u=W,j=A;return p(),m(j,null,{default:c((()=>[b("form",{onSubmit:v(s,["prevent"])},[b("div",ga,[b("div",va,[f(d,{class:"is-curved-select",label:t.$t("Visit_type")},{default:c((({id:l})=>[f(r,null,{default:c((()=>[f(n,{modelValue:x(i).visit_type_id,"onUpdate:modelValue":e[0]||(e[0]=a=>x(i).visit_type_id=a),attrs:{id:l},options:x(H),placeholder:t.$t("All")},null,8,["modelValue","attrs","options","placeholder"]),b("p",fa,g(a.errors.visit_type_id[0]),1)])),_:2},1024)])),_:1},8,["label"])]),b("div",ya,[f(d,{class:"is-curved-select",label:t.$t("Donation_type")},{default:c((({id:l})=>[f(r,null,{default:c((()=>[f(n,{modelValue:x(i).donation_type_id,"onUpdate:modelValue":e[1]||(e[1]=a=>x(i).donation_type_id=a),attrs:{id:l},options:x(J),placeholder:t.$t("All"),label:"name","value-prop":"id"},null,8,["modelValue","attrs","options","placeholder"]),b("p",ha,g(a.errors.donation_type_id[0]),1)])),_:2},1024)])),_:1},8,["label"])])]),b("div",xa,[b("div",ja,[f(u,{type:"button",color:"warning",bold:"",disabled:a.isLoading,tabindex:"0",onClick:_},{default:c((()=>[y(g(t.$t("Clear")),1)])),_:1},8,["disabled"]),f(u,{type:"submit",color:"primary",bold:"",loading:a.isLoading,tabindex:"0"},{default:c((()=>[y(g(t.$t("Search")),1)])),_:1},8,["loading"])])])],40,ba)])),_:1})}}}),Da=a=>(B("data-v-01408fef"),a=a(),C(),a),Ma={class:"page-content-inner"},wa={class:"columns mb-3"},ka={class:"column"},Fa={class:"columns mt-1"},Ba={class:"column"},Ca={class:"columns"},Oa={class:"column is-12"},Sa={key:0,class:"is-flex-grow-0",textContent:"#"},Ia={key:0,class:"flex-list-inner"},Ua={key:1,class:"flex-list-inner"},za=Da((()=>b("img",{class:"light-image",src:N,alt:""},null,-1))),La=Da((()=>b("img",{class:"dark-image",src:P,alt:""},null,-1))),Ea=["onClick"],qa=G.isEmpty,Ta=Q(s({__name:"index",setup(a){j();const t=r(),{t:e}=d(),l=X(),o=_(!1);Z().setPageTitle(e("Blood_sampling")),V({title:`${e("Donor_list_for_blood_sampling")} - ${l.app.name}`});const n=u({data:[],pagination:{total:10,count:10,per_page:10,current_page:1,total_pages:1}}),i=$({get:()=>n.pagination.current_page,set:async a=>{y.page=a,await C(y)}}),s={orderNumber:{format:(a,t,e)=>`${e+1}`,cellClass:"is-flex-grow-0"},name:{label:e("Fullname")},birth_date:{label:e("Date-of-birth")},visit_date:{label:e("Visit_date"),format:(a,t)=>{var e,l;return(null==(e=t.last_visit)?void 0:e.created_at)&&Y(new Date(null==(l=t.last_visit)?void 0:l.created_at),"YYYY-MM-DD")}},visit_type:{label:e("Visit_type"),format:(a,t)=>{var l,o;return(null==(l=t.last_visit)?void 0:l.visit_type)&&e(null==(o=t.last_visit)?void 0:o.visit_type)}},donation_number:{label:e("Donation_number"),format:(a,t)=>{var e;return null==(e=t.last_visit)?void 0:e.personalized_donation}},donation_type:{label:e("Donation_type"),format:(a,t)=>{var e;return null==(e=t.last_visit)?void 0:e.personalized_donation}}};_();const v=u({visit_type_id:[],donation_type_id:[]}),y=u({page:1}),h=u({}),B=_(!1);async function C(a){var l,i;try{Object.assign(y,a),o.value=!0;const l=await I(a);Object.assign(n,l.result),qa(l.result.data)?t.warning(e("Data_not_found")):t.success(`${e("Found")}: ${l.result.pagination.total} ${e("records")}`)}catch(s){Object.assign(v,null==(i=null==(l=s.response)?void 0:l.data)?void 0:i.errors)}finally{o.value=!1}}function O(a){v[a]=""}async function S(){n.data=[]}return(a,t)=>{const e=K,r=Ya,d=E,_=U,u=q,y=z,j=T,V=L,$=ca;return p(),D("div",Ma,[b("div",wa,[b("div",ka,[f(e,{"with-icons":"",separator:"bullet",items:[{label:x(l).app.name,hideLabel:!0,icon:"feather:home",to:{name:"/app/dashboard"}},{label:a.$t("Blood_sampling")},{label:a.$t("Donor_list_for_blood_sampling")}]},null,8,["items"])])]),b("div",Fa,[b("div",Ba,[f(r,{"is-loading":x(o),errors:x(v),onSearch:C,onClearForm:S,onClearError:O},null,8,["is-loading","errors"])])]),b("div",Ca,[b("div",Oa,[f(V,{columns:x(s),data:x(n).data,limit:x(n).pagination.per_page,total:x(n).pagination.total},{default:c((()=>[f(y,{rounded:"","no-header":!x(o)&&0===x(n).data.length},{"header-column":c((({column:a})=>["orderNumber"===a.key?(p(),D("span",Sa)):M("",!0)])),body:c((()=>[x(o)?(p(),D("div",Ia,[(p(!0),D(w,null,k(x(n).pagination.per_page,(a=>(p(),D("div",{key:a,class:"flex-table-item"},[f(_,null,{default:c((()=>[f(d,{lines:2,"last-line-width":"70%",class:"mx-2"})])),_:1})])))),128))])):M("",!0),0===x(n).data.length?(p(),D("div",Ua,[f(u,{title:"No matches",subtitle:"There is no data that match your query.",class:"my-6"},{image:c((()=>[za,La])),_:1})])):M("",!0)])),"body-cell":c((({row:a,column:t})=>["name"===t.key?(p(),D("a",{key:0,href:"javascript:;",class:"has-text-primary",onClick:t=>{return e=a,Object.assign(h,e),void(B.value=!0);var e}},g(a.first_name)+" "+g(a.last_name)+" "+g(a.father_name)+" ",9,Ea)):M("",!0)])),_:1},8,["no-header"]),x(n).data.length?(p(),m(j,{key:0,"current-page":x(i),"onUpdate:current-page":t[0]||(t[0]=a=>F(i)?i.value=a:null),class:"mt-5","item-per-page":x(n).pagination.per_page,"total-items":x(n).pagination.total,"no-router":""},null,8,["current-page","item-per-page","total-items"])):M("",!0)])),_:1},8,["columns","data","limit","total"])])]),f($,{"is-open":x(B),"onUpdate:is-open":t[1]||(t[1]=a=>F(B)?B.value=a:null),patient:x(h)},null,8,["is-open","patient"])])}}}),[["__scopeId","data-v-01408fef"]]);export{Ta as default};
