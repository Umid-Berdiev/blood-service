import{_ as e}from"./VModal.vue_vue_type_style_index_0_lang-1ec5e12b.js";import{_ as a}from"./SubmitButton.vue_vue_type_script_setup_true_lang-ca217c20.js";import{_ as t}from"./VFlex.vue_vue_type_style_index_0_lang-8f30b873.js";import{_ as l}from"./VFlexItem.vue_vue_type_style_index_0_lang-ce376e13.js";import{_ as n,a as s}from"./VControl-b713a764.js";import{_ as o}from"./IMaskDateInput.vue_vue_type_script_setup_true_lang-38070980.js";import{q as i,H as r,C as u,x as d,r as _,j as p,o as m,a as c,w as v,e as y,t as b,m as g,k as h,A as f,K as V,i as x,E as $,J as j,c as w,a6 as D,ag as k,d as M,g as F,F as I,l as C,S as O,L as S,M as Y}from"./index-568ad137.js";import{m as B}from"./moment-78dc6435.js";import{q as P,p as U,a as z}from"./patient-33059bc9.js";import{_ as A,a as L,b as q}from"./VFlexTable.vue_vue_type_style_index_0_lang-68179e43.js";import{_ as E,a as N,b as T,c as W,d as G}from"./search-7-dark-b6479367.js";import{_ as H}from"./VCard.vue_vue_type_script_setup_true_lang-3b674ece.js";import{_ as J}from"./VButton.vue_vue_type_style_index_0_lang-fc4409cd.js";import{_ as K}from"./VBreadcrumb.vue_vue_type_style_index_0_lang-faf20e2b.js";import{_ as X}from"./lodash-c54dbb06.js";import{u as Z}from"./main-7fc6984e.js";import{u as Q}from"./viewWrapper-feca89b2.js";import{_ as R}from"./_plugin-vue_export-helper-1b428a4d.js";import"./VIMaskInput.vue_vue_type_script_lang-6492e1cb.js";import"./VPlaceload-33f57994.js";const ee={class:"columns"},ae={class:"column"},te={class:"is-size-5 has-text-weight-medium"},le={class:"column"},ne={class:"is-size-5 has-text-weight-medium"},se={class:"table"},oe=["onSubmit"],ie={class:"is-size-5 has-text-weight-medium"},re={class:"table is-fullwidth"},ue={class:"help has-text-danger"},de={class:"help has-text-danger"},_e=["value"],pe={class:"help has-text-danger"},me=B.__esModule?B.default:B,ce=i({__name:"PrimaryScreeningFormModal",props:{isOpen:{type:Boolean,default:!1},patient:null},emits:["update:isOpen","update:list"],setup(i,{emit:f}){const V=i,x=r(),{t:$}=u(),j=d($("Primary_screening_form")),w=d(!1),D=d([{value:"o1",label:"O(I)"},{value:"a2",label:"A(II)"},{value:"b3",label:"B(III)"},{value:"ab4",label:"AB(IV)"}]),k=d([{value:"normal",label:$("Normal")},{value:"below_normal",label:$("Below_normal")},{value:"above_normal",label:$("Above_normal")}]),M=_({analysis_date:me().format("YYYY-MM-DD"),preliminary_blood_type:"o1",hemoglobin:"normal"}),F=_({analysis_date:[],preliminary_blood_type:[],hemoglobin:[]});async function I(){var e,a,t,l,n;try{w.value=!0,await P(null==(e=V.patient)?void 0:e.id,M),f("update:list"),C()}catch(s){(null==(a=s.response)?void 0:a.data.error)?x.error(null==(t=s.response)?void 0:t.data.error):Object.assign(F,null==(n=null==(l=s.response)?void 0:l.data)?void 0:n.errors)}finally{w.value=!1}}function C(){Object.assign(M,{analysis_date:me().format("YYYY-MM-DD"),preliminary_blood_type:"o1",hemoglobin:"normal"}),Object.assign(F,{analysis_date:[],preliminary_blood_type:[],hemoglobin:[]}),f("update:isOpen",!1)}return(r,u)=>{const d=o,_=n,f=s,V=p("Multiselect"),x=l,$=t,O=a,S=e;return m(),c(S,{open:i.isOpen,size:"big",title:j.value,actions:"right",onClose:C},{content:v((()=>{var e;return[y("div",ee,[y("div",ae,[y("h5",te,b(r.$t("Information_about_donor"))+" # "+b(i.patient.id),1)]),y("div",le,[y("h5",ne,b(r.$t("Visit_date"))+": "+b(i.patient.created_at),1)])]),y("table",se,[y("tbody",null,[y("tr",null,[y("th",null,b(r.$t("Last_name")),1),y("td",null,b(i.patient.last_name),1)]),y("tr",null,[y("th",null,b(r.$t("First_name")),1),y("td",null,b(i.patient.first_name),1)]),y("tr",null,[y("th",null,b(r.$t("Middlename")),1),y("td",null,b(i.patient.father_name),1)]),y("tr",null,[y("th",null,b(r.$t("Date-of-birth")),1),y("td",null,b(i.patient.birth_date),1)]),y("tr",null,[y("th",null,b(r.$t("Gender")),1),y("td",null,b(i.patient.gender),1)]),y("tr",null,[y("th",null,b(r.$t("Visit_type")),1),y("td",null,b(null==(e=i.patient.visit)?void 0:e.visit_type),1)]),y("tr",null,[y("th",null,b(r.$t("Donor_category")),1),y("td",null,b(i.patient.patient_category_id),1)]),y("tr",null,[y("th",null,b(r.$t("Passport_series_number")),1),y("td",null,b(i.patient.passport_series)+b(i.patient.passport_number)+", "+b(i.patient.issued_by)+", "+b(i.patient.when_issued),1)])])]),y("form",{id:"primary-screening-form",class:"modal-form",onSubmit:g(I,["prevent"])},[y("h5",ie,b(r.$t("Primary_screening_results")),1),y("table",re,[y("tbody",null,[y("tr",null,[y("th",null,b(r.$t("Date_of_an_analysis")),1),y("td",null,[h(f,{required:""},{default:v((()=>[h(_,null,{default:v((()=>[h(d,{modelValue:M.analysis_date,"onUpdate:modelValue":u[0]||(u[0]=e=>M.analysis_date=e)},null,8,["modelValue"]),y("p",ue,b(F.analysis_date[0]),1)])),_:1})])),_:1})])]),y("tr",null,[y("th",null,b(r.$t("Preliminary_blood_type")),1),y("td",null,[h(f,{required:""},{default:v((()=>[h(_,null,{default:v((()=>[h(V,{modelValue:M.preliminary_blood_type,"onUpdate:modelValue":u[1]||(u[1]=e=>M.preliminary_blood_type=e),options:D.value},null,8,["modelValue","options"]),y("p",de,b(F.analysis_date[0]),1)])),_:1})])),_:1})])]),y("tr",null,[y("th",null,b(r.$t("Hemoglobin")),1),y("td",null,[h(f,{required:""},{default:v((()=>[h(_,null,{default:v((()=>[h($,null,{default:v((()=>[h(x,{"flex-grow":1},{default:v((()=>[h(V,{modelValue:M.hemoglobin,"onUpdate:modelValue":u[2]||(u[2]=e=>M.hemoglobin=e),options:k.value},null,8,["modelValue","options"])])),_:1}),h(x,null,{default:v((()=>[y("input",{class:"input",type:"text",value:r.$t("g/l"),style:{width:"3rem"}},null,8,_e)])),_:1})])),_:1}),y("p",pe,b(F.analysis_date[0]),1)])),_:1})])),_:1})])])])])],40,oe)]})),action:v((({close:e})=>[h(O,{loading:w.value,form:"primary-screening-form"},null,8,["loading"])])),_:1},8,["open","title"])}}}),ve=["onSubmit"],ye={class:"columns"},be={class:"column"},ge={class:"help has-text-danger"},he={class:"column"},fe={class:"help has-text-danger"},Ve={class:"column"},xe={class:"help has-text-danger"},$e={class:"navigation-buttons"},je={class:"buttons is-right"},we=i({__name:"ForScreeningDonorsFilterForm",props:{isLoading:{type:Boolean},errors:null},emits:["search","clearError","clearForm"],setup(e,{emit:a}){const{t:t}=u();r();const l=_({donor_category_id:"",visit_type:"",donation_type_id:""}),o=d([]),i=d([{value:"gratuitous",label:t("Gratuitous")},{value:"chargeable",label:t("Chargeable")}]),$=d([{id:1,name:t("Whole_blood_donation")},{id:2,name:t("Plasmapheresis")},{id:3,name:t("Plateletpheresis")}]);f((async()=>{o.value=await U().then((e=>e.result))}));const j=async()=>{a("search",l)},w=async()=>{Object.assign(l,{donor_category_id:"",visit_type:"",donation_type_id:""}),a("clearForm")};return(a,t)=>{const r=p("Multiselect"),u=n,d=s,_=J,f=H;return m(),c(f,null,{default:v((()=>[y("form",{onSubmit:g(j,["prevent"])},[y("div",ye,[y("div",be,[h(d,{class:"is-curved-select",label:a.$t("Donor_categories")},{default:v((({id:n})=>[h(u,null,{default:v((()=>[h(r,{modelValue:V(l).donor_category_id,"onUpdate:modelValue":t[0]||(t[0]=e=>V(l).donor_category_id=e),attrs:{id:n},options:V(o),placeholder:a.$t("All"),label:"name","value-prop":"id"},null,8,["modelValue","attrs","options","placeholder"]),y("p",ge,b(e.errors.donor_category_id[0]),1)])),_:2},1024)])),_:1},8,["label"])]),y("div",he,[h(d,{class:"is-curved-select",label:a.$t("Visit_type")},{default:v((({id:n})=>[h(u,null,{default:v((()=>[h(r,{modelValue:V(l).visit_type,"onUpdate:modelValue":t[1]||(t[1]=e=>V(l).visit_type=e),attrs:{id:n},options:V(i),placeholder:a.$t("All")},null,8,["modelValue","attrs","options","placeholder"]),y("p",fe,b(e.errors.visit_type[0]),1)])),_:2},1024)])),_:1},8,["label"])]),y("div",Ve,[h(d,{class:"is-curved-select",label:a.$t("Donation_type")},{default:v((({id:n})=>[h(u,null,{default:v((()=>[h(r,{modelValue:V(l).donation_type_id,"onUpdate:modelValue":t[2]||(t[2]=e=>V(l).donation_type_id=e),attrs:{id:n},options:V($),placeholder:a.$t("All"),label:"name","value-prop":"id"},null,8,["modelValue","attrs","options","placeholder"]),y("p",xe,b(e.errors.donation_type_id[0]),1)])),_:2},1024)])),_:1},8,["label"])])]),y("div",$e,[y("div",je,[h(_,{type:"button",color:"warning",bold:"",disabled:e.isLoading,tabindex:"0",onClick:w},{default:v((()=>[x(b(a.$t("Clear")),1)])),_:1},8,["disabled"]),h(_,{type:"submit",color:"primary",bold:"",loading:e.isLoading,tabindex:"0"},{default:v((()=>[x(b(a.$t("Search")),1)])),_:1},8,["loading"])])])],40,ve)])),_:1})}}}),De=e=>(S("data-v-38ef7292"),e=e(),Y(),e),ke={class:"page-content-inner"},Me={class:"columns mb-3"},Fe={class:"column"},Ie={class:"columns mt-1"},Ce={class:"column"},Oe={class:"columns"},Se={class:"column is-12"},Ye=["textContent"],Be={key:0,class:"flex-list-inner"},Pe={key:1,class:"flex-list-inner"},Ue=De((()=>y("img",{class:"light-image",src:W,alt:""},null,-1))),ze=De((()=>y("img",{class:"dark-image",src:G,alt:""},null,-1))),Ae=["onClick"],Le=X.isEmpty,qe=R(i({__name:"index",async setup(e){let a,t;$();const l=r(),{t:n}=u(),s=Z(),o=d(!1);Q().setPageTitle(n("Screening")),j({title:`${n("Donors-list-for-primary-screening")} - ${s.app.name}`});const i=_({data:[],pagination:{total:10,count:10,per_page:10,current_page:1,total_pages:1}}),p=w({get:()=>i.pagination.current_page,set:async e=>{x.page=e,await B(x)}}),g={orderNumber:{format:(e,a,t)=>`${t+1}`},name:{label:n("Fullname")},birth_date:{label:n("Date-of-birth")},visit_date:{label:n("Visit_date"),format:(e,a)=>{var t,l;return(null==(t=a.last_visit)?void 0:t.created_at)&&D(new Date(null==(l=a.last_visit)?void 0:l.created_at),"YYYY-MM-DD")}},visit_type:{label:n("Visit_type"),format:(e,a)=>{var t,l;return(null==(t=a.last_visit)?void 0:t.visit_type)&&n(null==(l=a.last_visit)?void 0:l.visit_type)}},medical_inspection_date:{label:n("Medical_inspection_date"),format:(e,a)=>{var t,l;return(null==(t=a.last_visit)?void 0:t.directed_by)&&n(null==(l=a.last_visit)?void 0:l.directed_by)}},medical_inspection_conclusion:{label:n("Medical_inspection_conclusion"),format:(e,a)=>{var t;return null==(t=a.last_visit)?void 0:t.personalized_donation}},linked_donation_number:{label:n("Linked_donation_number"),format:(e,a)=>{var t;return null==(t=a.last_visit)?void 0:t.personalized_donation}},donation_type:{label:n("Donation_type"),format:(e,a)=>{var t;return null==(t=a.last_visit)?void 0:t.personalized_donation}},blood_component_amount:{label:n("Blood_component_amount"),format:(e,a)=>{var t;return null==(t=a.status)?void 0:t.name}}};d();const f=_({donor_category_id:[],visit_type:[],donation_type_id:[]}),x=_({page:1}),S=_({}),Y=d(!1);async function B(e){var a,t;try{Object.assign(x,e),o.value=!0;const a=await z(e);Object.assign(i,a.result),Le(a.result.data)?l.warning(n("Data_not_found")):l.success(`${n("Found")}: ${a.result.pagination.total} ${n("records")}`)}catch(s){Object.assign(f,null==(t=null==(a=s.response)?void 0:a.data)?void 0:t.errors)}finally{o.value=!1}}function P(e){f[e]=""}async function U(){i.data=[]}return[a,t]=k((()=>B(x))),await a,t(),(e,a)=>{const t=K,l=we,n=E,r=A,u=N,d=L,_=T,x=q,$=ce;return m(),M("div",ke,[y("div",Me,[y("div",Fe,[h(t,{"with-icons":"",separator:"bullet",items:[{label:V(s).app.name,hideLabel:!0,icon:"feather:home",to:{name:"/app/dashboard"}},{label:e.$t("Screening")},{label:e.$t("Donors-list-for-primary-screening")}]},null,8,["items"])])]),y("div",Ie,[y("div",Ce,[h(l,{"is-loading":V(o),errors:V(f),onSearch:B,onClearForm:U,onClearError:P},null,8,["is-loading","errors"])])]),y("div",Oe,[y("div",Se,[h(x,{columns:V(g),data:V(i).data,limit:V(i).pagination.per_page,total:V(i).pagination.total},{default:v((()=>[h(d,{rounded:"","no-header":!V(o)&&0===V(i).data.length},{"header-column":v((({column:a})=>["orderNumber"===a.key?(m(),M("span",{key:0,textContent:b(e.$t("Donor_register_number"))},null,8,Ye)):F("",!0)])),body:v((()=>[V(o)?(m(),M("div",Be,[(m(!0),M(I,null,C(V(i).pagination.per_page,(e=>(m(),M("div",{key:e,class:"flex-table-item"},[h(r,null,{default:v((()=>[h(n,{lines:2,"last-line-width":"70%",class:"mx-2"})])),_:1})])))),128))])):F("",!0),0===V(i).data.length?(m(),M("div",Pe,[h(u,{title:"No matches",subtitle:"There is no data that match your query.",class:"my-6"},{image:v((()=>[Ue,ze])),_:1})])):F("",!0)])),"body-cell":v((({row:e,column:a})=>["name"===a.key?(m(),M("button",{key:0,class:"button button-link",onClick:a=>{return t=e,Object.assign(S,t),void(Y.value=!0);var t}},b(e.first_name)+" "+b(e.last_name)+" "+b(e.father_name)+" ",9,Ae)):F("",!0)])),_:1},8,["no-header"]),V(i).data.length?(m(),c(_,{key:0,"current-page":V(p),"onUpdate:current-page":a[0]||(a[0]=e=>O(p)?p.value=e:null),class:"mt-5","item-per-page":V(i).pagination.per_page,"total-items":V(i).pagination.total,"no-router":""},null,8,["current-page","item-per-page","total-items"])):F("",!0)])),_:1},8,["columns","data","limit","total"])])]),h($,{"is-open":V(Y),"onUpdate:is-open":a[1]||(a[1]=e=>O(Y)?Y.value=e:null),patient:V(S)},null,8,["is-open","patient"])])}}}),[["__scopeId","data-v-38ef7292"]]);export{qe as default};
