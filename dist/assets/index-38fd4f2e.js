import{_ as t}from"./VModal.vue_vue_type_style_index_0_lang-b0507e96.js";import{_ as e}from"./SubmitButton.vue_vue_type_script_setup_true_lang-e5001c63.js";import{_ as a}from"./VFlex.vue_vue_type_style_index_0_lang-0938e556.js";import{_ as l,a as s}from"./VControl-fc151345.js";import{_ as n}from"./IMaskDateInput.vue_vue_type_script_setup_true_lang-5ce26ef4.js";import{_ as o}from"./VFlexItem.vue_vue_type_style_index_0_lang-ff50e60d.js";import{a as i,b as r,r as d,l as u,t as _,q as m,Q as p,V as c,X as v,p as f,v as h,s as g,u as b,c as y,m as j,y as V,M as $,W as D,i as x,$ as Y,a0 as w}from"./chunk-BGPNDDXN-dcda8805.js";import{m as M}from"./moment-e00bdeae.js";import{u as k}from"./chunk-3UEUFEGV-d557e6b1.js";import{u as B}from"./useNotyf-1536ae84.js";import{a as F}from"./userSession-0c0e9684.js";import{_ as O,a as C,b as S}from"./VFlexTable.vue_vue_type_style_index_0_lang-f8ff2f75.js";import{_ as U,a as I,b as z,c as N,d as P}from"./search-7-dark-f0facebe.js";import{_ as q}from"./VCard.vue_vue_type_script_setup_true_lang-a9232da9.js";import{_ as E}from"./VButton.vue_vue_type_style_index_0_lang-27d6885c.js";import{_ as L}from"./VInput.vue_vue_type_script_setup_true_lang-29181b77.js";import{v as T,d as A}from"./additionals-5276c916.js";import{_ as G}from"./VBreadcrumb.vue_vue_type_style_index_0_lang-d3c7c667.js";import{u as Q}from"./chunk-DRAQDPQ2-4514f14e.js";import{f as W}from"./@vueuse_core-098eb702.js";import{u as X}from"./@vueuse_head-0d019878.js";import{_ as R}from"./lodash-94527813.js";import{u as H}from"./main-a3a6220c.js";import{u as J}from"./viewWrapper-c60f0ce7.js";import{_ as K}from"./_plugin-vue_export-helper-1b428a4d.js";import"./VIMaskInput.vue_vue_type_script_lang-06d40a07.js";import"./pinia-3af6ce52.js";import"./VPlaceload-2a65ae53.js";import"./app-a24ed2b3.js";import"./darkmode-b70c06f1.js";const Z=F();const tt={class:"columns"},et={class:"column"},at={class:"is-size-5 has-text-weight-medium"},lt={class:"column"},st={class:"is-size-5 has-text-weight-medium"},nt={class:"table"},ot=["onSubmit"],it={class:"is-size-5 has-text-weight-medium"},rt=p("br",null,null,-1),dt={class:"help has-text-danger"},ut=p("br",null,null,-1),_t={class:"table is-fullwidth"},mt={class:"help has-text-danger"},pt={class:"help has-text-danger"},ct=M.__esModule?M.default:M,vt=i({__name:"BloodSamplingFormModal",props:{isOpen:{type:Boolean,default:!1},patient:null},emits:["update:isOpen","update:list"],setup(i,{emit:g}){const b=i,y=B(),{t:j}=k(),V=r(j("Sampling_data_entry_form")),$=r(!1),D=d({date:ct().format("YYYY-MM-DD"),hemotransmissible_date:ct().format("YYYY-MM-DD"),chemical_date:ct().format("YYYY-MM-DD")}),x=d({date:[],hemotransmissible_date:[],chemical_date:[]});async function Y(){var t,e,a,l,s,n;try{$.value=!0,await async function(t,e){try{const{data:a}=await Z({url:`/visit-cards/${t}/blood-samples`,method:"POST",data:e});return a}catch(a){throw a}}(null==(e=null==(t=b.patient)?void 0:t.last_visit)?void 0:e.id,D),g("update:list"),w()}catch(o){(null==(a=o.response)?void 0:a.data.error)?y.error(null==(l=o.response)?void 0:l.data.error):Object.assign(x,null==(n=null==(s=o.response)?void 0:s.data)?void 0:n.errors)}finally{$.value=!1}}function w(){Object.assign(D,{date:ct().format("YYYY-MM-DD"),hemotransmissible_date:ct().format("YYYY-MM-DD"),chemical_date:ct().format("YYYY-MM-DD")}),Object.assign(x,{date:[],hemotransmissible_date:[],chemical_date:[]}),g("update:isOpen",!1)}return(r,d)=>{const g=o,b=n,y=l,j=s,M=a,k=e,B=t;return u(),_(B,{open:i.isOpen,size:"big",title:V.value,actions:"right",onClose:w},{content:m((()=>{var t;return[p("div",tt,[p("div",et,[p("h5",at,c(r.$t("Donor_information"))+" # "+c(i.patient.id),1)]),p("div",lt,[p("h5",st,c(r.$t("Visit_date"))+": "+c(i.patient.created_at),1)])]),p("table",nt,[p("tbody",null,[p("tr",null,[p("th",null,c(r.$t("Last_name")),1),p("td",null,c(i.patient.last_name),1)]),p("tr",null,[p("th",null,c(r.$t("First_name")),1),p("td",null,c(i.patient.first_name),1)]),p("tr",null,[p("th",null,c(r.$t("Middlename")),1),p("td",null,c(i.patient.father_name),1)]),p("tr",null,[p("th",null,c(r.$t("Date-of-birth")),1),p("td",null,c(i.patient.birth_date),1)]),p("tr",null,[p("th",null,c(r.$t("Gender")),1),p("td",null,c(i.patient.gender),1)]),p("tr",null,[p("th",null,c(r.$t("Visit_type")),1),p("td",null,c(null==(t=i.patient.last_visit)?void 0:t.visit_type),1)]),p("tr",null,[p("th",null,c(r.$t("Donor_category")),1),p("td",null,c(i.patient.patient_category_id),1)]),p("tr",null,[p("th",null,c(r.$t("Passport_series_number")),1),p("td",null,c(i.patient.passport_series)+c(i.patient.passport_number)+", "+c(i.patient.issued_by)+", "+c(i.patient.when_issued),1)])])]),p("form",{id:"blood-sampling-form",class:"modal-form",onSubmit:v(Y,["prevent"])},[p("h5",it,c(r.$t("Information_about_blood_sampling")),1),rt,f(M,{"column-gap":"1rem","align-items":"center"},{default:m((()=>[f(g,null,{default:m((()=>[h(c(r.$t("Blood_sampling_date")),1)])),_:1}),f(g,null,{default:m((()=>[f(j,null,{default:m((()=>[f(y,null,{default:m((()=>[f(b,{modelValue:D.date,"onUpdate:modelValue":d[0]||(d[0]=t=>D.date=t)},null,8,["modelValue"]),p("p",dt,c(x.date[0]),1)])),_:1})])),_:1})])),_:1})])),_:1}),ut,p("table",_t,[p("thead",null,[p("tr",null,[p("th",null,c(r.$t("Blood_sample_transferred_where")),1),p("th",null,c(r.$t("Blood_sample_transferred_when")),1)])]),p("tbody",null,[p("tr",null,[p("td",null,c(r.$t("Bloodborne-infections-laboratory")),1),p("td",null,[f(j,{required:""},{default:m((()=>[f(y,null,{default:m((()=>[f(b,{modelValue:D.hemotransmissible_date,"onUpdate:modelValue":d[1]||(d[1]=t=>D.hemotransmissible_date=t)},null,8,["modelValue"]),p("p",mt,c(x.hemotransmissible_date[0]),1)])),_:1})])),_:1})])]),p("tr",null,[p("td",null,c(r.$t("Clinical-biochemical-laboratory")),1),p("td",null,[f(j,{required:""},{default:m((()=>[f(y,null,{default:m((()=>[f(b,{modelValue:D.chemical_date,"onUpdate:modelValue":d[2]||(d[2]=t=>D.chemical_date=t)},null,8,["modelValue"]),p("p",pt,c(x.chemical_date[0]),1)])),_:1})])),_:1})])])])])],40,ot)]})),action:m((()=>[f(k,{loading:$.value,form:"blood-sampling-form"},null,8,["loading"])])),_:1},8,["open","title"])}}}),ft=["onSubmit"],ht={class:"columns"},gt={class:"column is-3"},bt={class:"help has-text-danger"},yt={class:"column is-3"},jt={class:"help has-text-danger"},Vt={class:"column is-3"},$t={class:"help has-text-danger"},Dt={class:"navigation-buttons"},xt={class:"buttons is-right"},Yt=i({__name:"BloodSamplingFilterForm",props:{isLoading:{type:Boolean},errors:null},emits:["search","clearError","clearForm"],setup(t,{emit:e}){const{t:a}=k(),n=B(),o=d({visit_type:"",donation_type_id:null,donation_code:""}),i=async()=>{Object.values(o).some((t=>Boolean(t)))?e("search",o):n.error(a("Form_fields_are_empty"))},r=async()=>{Object.assign(o,{visit_type:"",donation_type_id:null,donation_code:""}),e("clearForm")};return(e,a)=>{const n=g("Multiselect"),d=l,y=s,j=L,V=E,$=q;return u(),_($,null,{default:m((()=>[p("form",{onSubmit:v(i,["prevent"])},[p("div",ht,[p("div",gt,[f(y,{class:"is-curved-select",label:e.$t("Visit_type")},{default:m((({id:l})=>[f(d,null,{default:m((()=>[f(n,{modelValue:b(o).visit_type,"onUpdate:modelValue":a[0]||(a[0]=t=>b(o).visit_type=t),attrs:{id:l},options:b(T),placeholder:e.$t("All")},null,8,["modelValue","attrs","options","placeholder"]),p("p",bt,c(t.errors.visit_type[0]),1)])),_:2},1024)])),_:1},8,["label"])]),p("div",yt,[f(y,{class:"is-curved-select",label:e.$t("Donation_type")},{default:m((({id:l})=>[f(d,null,{default:m((()=>[f(n,{modelValue:b(o).donation_type_id,"onUpdate:modelValue":a[1]||(a[1]=t=>b(o).donation_type_id=t),attrs:{id:l},options:b(A),placeholder:e.$t("All"),label:"name","value-prop":"id"},null,8,["modelValue","attrs","options","placeholder"]),p("p",jt,c(t.errors.donation_type_id[0]),1)])),_:2},1024)])),_:1},8,["label"])]),p("div",Vt,[f(y,{class:"is-curved-select",label:e.$t("Donation_code")},{default:m((({id:l})=>[f(d,null,{default:m((()=>[f(j,{modelValue:b(o).donation_code,"onUpdate:modelValue":a[2]||(a[2]=t=>b(o).donation_code=t),attrs:{id:l},placeholder:e.$t("Donation_code")},null,8,["modelValue","attrs","placeholder"]),p("p",$t,c(t.errors.donation_code[0]),1)])),_:2},1024)])),_:1},8,["label"])])]),p("div",Dt,[p("div",xt,[f(V,{type:"button",color:"warning",bold:"",disabled:t.isLoading,tabindex:"0",onClick:r},{default:m((()=>[h(c(e.$t("Clear")),1)])),_:1},8,["disabled"]),f(V,{type:"submit",color:"primary",bold:"",loading:t.isLoading,tabindex:"0"},{default:m((()=>[h(c(e.$t("Search")),1)])),_:1},8,["loading"])])])],40,ft)])),_:1})}}}),wt=t=>(Y("data-v-af7e94c2"),t=t(),w(),t),Mt={class:"page-content-inner"},kt={class:"columns mb-3"},Bt={class:"column"},Ft={class:"columns mt-1"},Ot={class:"column"},Ct={class:"columns"},St={class:"column is-12"},Ut={key:0,class:"is-flex-grow-0",textContent:"#"},It={key:0,class:"flex-list-inner"},zt={key:1,class:"flex-list-inner"},Nt=wt((()=>p("img",{class:"light-image",src:N,alt:""},null,-1))),Pt=wt((()=>p("img",{class:"dark-image",src:P,alt:""},null,-1))),qt=["onClick"],Et=R.isEmpty,Lt=K(i({__name:"index",setup(t){Q();const e=B(),{t:a}=k(),l=H(),s=r(!1);J().setPageTitle(a("Blood_sampling")),X({title:`${a("Donor_list_for_blood_sampling")} - ${l.app.name}`});const n=d({data:[],pagination:{total:10,count:10,per_page:10,current_page:1,total_pages:1}}),o=y({get:()=>n.pagination.current_page,set:async t=>{h.page=t,await w(h)}}),i={orderNumber:{format:(t,e,a)=>`${a+1}`,cellClass:"is-flex-grow-0"},name:{label:a("Fullname")},birth_date:{label:a("Date-of-birth")},visit_date:{label:a("Visit_date"),format:(t,e)=>{var a,l;return(null==(a=e.last_visit)?void 0:a.created_at)&&W(new Date(null==(l=e.last_visit)?void 0:l.created_at),"YYYY-MM-DD")}},visit_type:{label:a("Visit_type"),format:(t,e)=>{var l,s;return(null==(l=e.last_visit)?void 0:l.visit_type)&&a(null==(s=e.last_visit)?void 0:s.visit_type)}},donation_type:{label:a("Donation_type"),format:(t,e)=>{var a;return null==(a=e.last_visit)?void 0:a.personalized_donation}},donation_number:{label:a("Donation_number"),format:(t,e)=>{var a;return null==(a=e.last_visit)?void 0:a.personalized_donation}}};r();const v=d({visit_type:[],donation_type_id:[],donation_code:[]}),h=d({page:1}),g=d({}),Y=r(!1);async function w(t){var l,o;try{Object.assign(h,t),s.value=!0;const l=await async function(t){try{const{data:e}=await Z({url:"/patients/blood-samples",params:t});return e}catch(e){throw e}}(t);Object.assign(n,l.result),Et(l.result.data)?e.warning(a("Data_not_found")):e.success(`${a("Found")}: ${l.result.pagination.total} ${a("records")}`)}catch(i){Object.assign(v,null==(o=null==(l=i.response)?void 0:l.data)?void 0:o.errors)}finally{s.value=!1}}function M(t){v[t]=""}async function F(){n.data=[]}return(t,e)=>{const a=G,r=Yt,d=U,h=O,y=I,k=C,B=z,N=S,P=vt;return u(),j("div",Mt,[p("div",kt,[p("div",Bt,[f(a,{"with-icons":"",separator:"bullet",items:[{label:b(l).app.name,hideLabel:!0,icon:"feather:home",to:{name:"/app/dashboard"}},{label:t.$t("Blood_sampling")},{label:t.$t("Donor_list_for_blood_sampling")}]},null,8,["items"])])]),p("div",Ft,[p("div",Ot,[f(r,{"is-loading":b(s),errors:b(v),onSearch:w,onClearForm:F,onClearError:M},null,8,["is-loading","errors"])])]),p("div",Ct,[p("div",St,[f(N,{columns:b(i),data:b(n).data,limit:b(n).pagination.per_page,total:b(n).pagination.total},{default:m((()=>[f(k,{rounded:"","no-header":!b(s)&&0===b(n).data.length},{"header-column":m((({column:t})=>["orderNumber"===t.key?(u(),j("span",Ut)):V("",!0)])),body:m((()=>[b(s)?(u(),j("div",It,[(u(!0),j($,null,D(b(n).pagination.per_page,(t=>(u(),j("div",{key:t,class:"flex-table-item"},[f(h,null,{default:m((()=>[f(d,{lines:2,"last-line-width":"70%",class:"mx-2"})])),_:1})])))),128))])):V("",!0),0===b(n).data.length?(u(),j("div",zt,[f(y,{title:"No matches",subtitle:"There is no data that match your query.",class:"my-6"},{image:m((()=>[Nt,Pt])),_:1})])):V("",!0)])),"body-cell":m((({row:t,column:e})=>["name"===e.key?(u(),j("a",{key:0,href:"javascript:;",class:"has-text-primary",onClick:e=>{return a=t,Object.assign(g,a),void(Y.value=!0);var a}},c(t.first_name)+" "+c(t.last_name)+" "+c(t.father_name)+" ",9,qt)):V("",!0)])),_:1},8,["no-header"]),b(n).data.length?(u(),_(B,{key:0,"current-page":b(o),"onUpdate:current-page":e[0]||(e[0]=t=>x(o)?o.value=t:null),class:"mt-5","item-per-page":b(n).pagination.per_page,"total-items":b(n).pagination.total,"no-router":""},null,8,["current-page","item-per-page","total-items"])):V("",!0)])),_:1},8,["columns","data","limit","total"])])]),f(P,{"is-open":b(Y),"onUpdate:is-open":e[1]||(e[1]=t=>x(Y)?Y.value=t:null),patient:b(g)},null,8,["is-open","patient"])])}}}),[["__scopeId","data-v-af7e94c2"]]);export{Lt as default};
