import{c as a,d as e,a as l,_ as t,b as s}from"./FilterForm.vue_vue_type_script_setup_true_lang-28f3908d.js";import{_ as i,a as n,b as o}from"./VFlexTable.vue_vue_type_style_index_0_lang-9e54e133.js";import{_ as u,a as r,b as d,c as _,d as p}from"./search-7-dark-e44eeced.js";import{_ as c}from"./VBreadcrumb.vue_vue_type_style_index_0_lang-d2aaa355.js";import{q as m,H as v,C as y,x as g,r as f,y as b,j as h,o as x,a as j,w as V,e as k,t as w,k as z,i as C,d as $,g as D,L as O,M as B,E as F,J as I,c as M,a7 as U,a8 as q,K as S,F as Y,l as N,S as T}from"./index-10a7bb68.js";import{_ as E}from"./VModal.vue_vue_type_style_index_0_lang-929f8778.js";import{_ as L}from"./SubmitButton.vue_vue_type_script_setup_true_lang-3fd94ade.js";import{_ as P}from"./VButton.vue_vue_type_style_index_0_lang-73c8b1df.js";import{_ as R}from"./VCheckbox.vue_vue_type_style_index_0_lang-2e6b52db.js";import{_ as A}from"./VFlex.vue_vue_type_style_index_0_lang-4effb675.js";import{_ as H}from"./IMaskDateInput.vue_vue_type_script_setup_true_lang-369c18cd.js";import{_ as J}from"./VFlexItem.vue_vue_type_style_index_0_lang-cf815e4d.js";import{b as K,_ as W,a as X}from"./VControl-5569cf53.js";import{_ as Z}from"./VInput.vue_vue_type_script_setup_true_lang-88e8cbff.js";import{_ as G}from"./_plugin-vue_export-helper-1b428a4d.js";import{u as Q}from"./main-e68c1ccc.js";import{u as aa}from"./viewWrapper-dc426096.js";import"./VTextarea.vue_vue_type_script_setup_true_lang-905c77e1.js";import"./VRadio.vue_vue_type_style_index_0_lang-c4e6eacc.js";import"./moment-aa9a2fad.js";import"./VCard.vue_vue_type_script_setup_true_lang-2f7124ba.js";import"./additional-9e169b33.js";import"./VPlaceload-686e62ec.js";import"./VIMaskInput.vue_vue_type_script_lang-dbe9f41c.js";const ea=a=>(O("data-v-d07a358b"),a=a(),B(),a),la={class:"columns"},ta={class:"column"},sa={class:"is-size-5 has-text-weight-medium"},ia={class:"box"},na={class:"has-text-weight-bold"},oa=ea((()=>k("br",null,null,-1))),ua={class:"box"},ra={class:"columns is-multiline"},da={class:"column is-6 is-flex is-align-items-center"},_a={key:0,class:"has-text-danger"},pa=ea((()=>k("span",null,"Реакция Хендельсона (бруцеллез)",-1))),ca={class:"column is-6 is-flex is-align-items-center"},ma={key:0,class:"has-text-danger"},va=ea((()=>k("span",null,"Титр антистафилококковый антител",-1))),ya={class:"column is-narrow is-flex is-align-items-center"},ga=ea((()=>k("br",null,null,-1))),fa=ea((()=>k("p",{class:"has-text-danger"}," Красным цветом указаны показатели, заданные врачом-терапевтом, как обязательные для определения ",-1))),ba=G(m({__name:"FormModal",props:{isOpen:{type:Boolean,default:!1},patient:null},emits:["update:isOpen","update:list","emergency-noticing"],setup(l,{emit:t}){const s=l,i=v(),{t:n}=y(),o=g(n("Serological_research_results")),u=g(!1),r=f({blood_samples_taken_date:[],analysis_date:[]}),d=f({data:{date_analysis:"",heddelson:"",staphylococcal:"",hemolysis:!1,chilez:!1},required_fields:[]}),_=g(!1),p=g([{value:0,label:n("negative")},{value:1,label:n("positive")},{value:2,label:n("doubtful")}]);async function c(){var a,l,o,_,p,c;try{u.value=!0,await e(null==(l=null==(a=s.patient)?void 0:a.last_visit)?void 0:l.id,d.data),i.success(n("Data_saved_successfully")),t("update:list"),m()}catch(v){(null==(o=v.response)?void 0:o.data.error)?i.error(null==(_=v.response)?void 0:_.data.error):Object.assign(r,null==(c=null==(p=v.response)?void 0:p.data)?void 0:c.errors)}finally{u.value=!1}}function m(){d.data.date_analysis="",Object.assign(r,{date_analysis:[]}),t("update:isOpen",!1)}function O(){t("emergency-noticing"),m()}return b((()=>{var a,e;return null==(e=null==(a=s.patient)?void 0:a.last_visit)?void 0:e.id}),(async e=>{if(e){const l=await a(e);Object.assign(d,l.result)}})),b([()=>d.data.hemolysis,()=>d.data.chilez],(async a=>{a.includes(!0)?_.value=!0:_.value=!1})),(a,e)=>{const t=K,s=Z,i=W,n=X,r=J,_=H,v=A,y=h("Multiselect"),g=R,f=P,b=L,B=E;return x(),j(B,{open:l.isOpen,size:"big",title:o.value,actions:"right",onClose:m},{content:V((()=>{var o,u;return[k("div",la,[k("div",ta,[k("h5",sa,w(a.$t("Donor_code"))+": "+w(null==(u=null==(o=l.patient)?void 0:o.last_visit)?void 0:u.donation_code),1)])]),k("div",ia,[z(v,{"flex-wrap":"wrap","row-gap":"2rem","justify-content":"space-between"},{default:V((()=>[z(r,{"flex-basis":"45%"},{default:V((()=>[z(n,{horizontal:""},{default:V((()=>[z(t,{class:"my-auto mr-3 is-size-6"},{default:V((()=>[C(w(a.$t("Blood_sampling_date")),1)])),_:1}),z(i,null,{default:V((()=>{var a,e,t;return[z(s,{value:null==(t=null==(e=null==(a=l.patient)?void 0:a.last_visit)?void 0:e.blood_sample)?void 0:t.date,disabled:""},null,8,["value"])]})),_:1})])),_:1})])),_:1}),z(r,{"flex-basis":"45%"},{default:V((()=>[z(n,{horizontal:""},{default:V((()=>{var e,i,n;return[z(t,{class:"my-auto mr-3 is-size-6"},{default:V((()=>[C(w(a.$t("Blood_samples_taken_date")),1)])),_:1}),z(s,{value:null==(n=null==(i=null==(e=l.patient)?void 0:e.last_visit)?void 0:i.blood_sample)?void 0:n.chemical_date,disabled:""},null,8,["value"])]})),_:1})])),_:1}),z(r,{"flex-basis":"45%"},{default:V((()=>[z(n,{horizontal:""},{default:V((()=>[z(t,{class:"my-auto mr-3 is-size-6"},{default:V((()=>[C(w(a.$t("Analysis_date")),1)])),_:1}),z(i,null,{default:V((()=>[z(_,{modelValue:d.data.date_analysis,"onUpdate:modelValue":e[0]||(e[0]=a=>d.data.date_analysis=a)},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),z(r,{"flex-basis":"45%"},{default:V((()=>{var e,t;return[k("h5",null,[k("span",na,w(a.$t("Visit_stage")),1),k("span",null,w(null==(t=null==(e=l.patient)?void 0:e.last_visit)?void 0:t.stage),1)])]})),_:1})])),_:1})]),oa,k("div",ua,[k("div",ra,[k("div",da,[z(n,null,{default:V((()=>[z(t,{class:"is-size-6 my-auto mr-3 has-text-right"},{default:V((()=>[d.required_fields.includes("heddelson")?(x(),$("span",_a,"*")):D("",!0),pa])),_:1}),z(i,null,{default:V((()=>[z(y,{modelValue:d.data.heddelson,"onUpdate:modelValue":e[1]||(e[1]=a=>d.data.heddelson=a),options:p.value,placeholder:a.$t("Select"),style:{"min-width":"15rem"}},null,8,["modelValue","options","placeholder"])])),_:1})])),_:1})]),k("div",ca,[z(n,{class:"is-justify-content-end"},{default:V((()=>[z(t,{class:"is-size-6 my-auto mr-3 has-text-right"},{default:V((()=>[d.required_fields.includes("staphylococcal")?(x(),$("span",ma,"*")):D("",!0),va])),_:1}),z(i,null,{default:V((()=>[z(s,{modelValue:d.data.staphylococcal,"onUpdate:modelValue":e[2]||(e[2]=a=>d.data.staphylococcal=a)},null,8,["modelValue"])])),_:1})])),_:1})]),k("div",ya,[z(n,{horizontal:""},{default:V((()=>[z(i,null,{default:V((()=>[z(g,{modelValue:d.data.chilez,"onUpdate:modelValue":e[3]||(e[3]=a=>d.data.chilez=a),color:"primary",label:"Хилез"},null,8,["modelValue"])])),_:1})])),_:1}),z(n,{horizontal:"",style:{"margin-bottom":"0.75rem"}},{default:V((()=>[z(i,null,{default:V((()=>[z(g,{modelValue:d.data.hemolysis,"onUpdate:modelValue":e[4]||(e[4]=a=>d.data.hemolysis=a),color:"primary",label:"Гемолиз"},null,8,["modelValue"])])),_:1})])),_:1})])]),ga,fa])]})),action:V((()=>[z(f,{type:"button",color:"warning",outlined:"",onClick:O},{default:V((()=>[C(" Экстренное извещение ")])),_:1}),z(b,{loading:u.value,onClick:c},null,8,["loading"])])),_:1},8,["open","title"])}}}),[["__scopeId","data-v-d07a358b"]]),ha=a=>(O("data-v-8fea351b"),a=a(),B(),a),xa={class:"page-content-inner"},ja={class:"columns mb-3"},Va={class:"column"},ka={class:"columns mt-1"},wa={class:"column"},za={class:"columns"},Ca={class:"column is-12"},$a={key:0,class:"is-flex-grow-0",textContent:"#"},Da={key:0,class:"flex-list-inner"},Oa={key:1,class:"flex-list-inner"},Ba=ha((()=>k("img",{class:"light-image",src:_,alt:""},null,-1))),Fa=ha((()=>k("img",{class:"dark-image",src:p,alt:""},null,-1))),Ia=["onClick"],Ma=G(m({__name:"index",async setup(a){let e,_;F(),v();const{t:p}=y(),m=Q(),b=g(!1);aa().setPageTitle(p("Clinical-biochemical-laboratory")),I({title:`${p("Donor_list_for_blood_sampling")} - ${m.app.name}`});const h=f({data:[],pagination:{total:10,count:10,per_page:10,current_page:1,total_pages:1}}),C=M({get:()=>h.pagination.current_page,set:async a=>{await A(E)}}),O={orderNumber:{format:(a,e,l)=>`${l+1}`,cellClass:"is-flex-grow-0"},donation_code:{label:p("Donation_code"),format:(a,e)=>{var l;return null==(l=e.last_visit)?void 0:l.donation_code}},blood_sampling_date:{label:p("Blood_sampling_date"),format:(a,e)=>{var l,t;return null==(t=null==(l=e.last_visit)?void 0:l.blood_sample)?void 0:t.date}},name:{label:p("Donor_fullname")},birth_date:{label:p("Date-of-birth")},visit_type:{label:p("Visit_type"),format:(a,e)=>{var l,t;return(null==(l=e.last_visit)?void 0:l.visit_type)&&p(null==(t=e.last_visit)?void 0:t.visit_type)}},visit_date:{label:p("Visit_date"),format:(a,e)=>{var l,t;return(null==(l=e.last_visit)?void 0:l.created_at)&&U(new Date(null==(t=e.last_visit)?void 0:t.created_at),"YYYY-MM-DD")}},donation_type:{label:p("Donation_type"),format:(a,e)=>{var l,t;return null==(t=null==(l=e.last_visit)?void 0:l.donation_type)?void 0:t.name}},visit_stage:{label:p("Visit_stage"),format:(a,e)=>{var l,t;return null==(t=null==(l=e.last_visit)?void 0:l.stage)?void 0:t.name}}},B=f({visit_type_id:[],donation_type_id:[],donation_code:[]}),E=f({visit_type_id:"",donation_type_id:null,donation_code:""}),L=g(null),P=g(!1),R=g(!1);async function A(a){var e,t;try{b.value=!0,Object.assign(E,a);const e={...a,page:C.value},t=await l(e);Object.assign(h,t.result)}catch(s){Object.assign(B,null==(t=null==(e=s.response)?void 0:e.data)?void 0:t.errors)}finally{b.value=!1}}function H(a){B[a]=""}async function J(){h.data=[]}function K(){L.value=null}return[e,_]=q((()=>A(E))),await e,_(),(a,e)=>{const l=c,_=t,p=u,v=i,y=r,g=n,f=d,F=o,I=s;return x(),$("div",xa,[k("div",ja,[k("div",Va,[z(l,{"with-icons":"",separator:"bullet",items:[{label:S(m).app.name,hideLabel:!0,icon:"feather:home",to:{name:"/app/dashboard"}},{label:a.$t("Buck-laboratory")},{label:a.$t("Research-aimed-donations-list")}]},null,8,["items"])])]),k("div",ka,[k("div",wa,[z(_,{"is-loading":S(b),errors:S(B),onSearch:A,onClearForm:J,onClearError:H},null,8,["is-loading","errors"])])]),k("div",za,[k("div",Ca,[z(F,{columns:S(O),data:S(h).data,limit:S(h).pagination.per_page,total:S(h).pagination.total},{default:V((()=>[z(g,{rounded:"","no-header":!S(b)&&0===S(h).data.length},{"header-column":V((({column:a})=>["orderNumber"===a.key?(x(),$("span",$a)):D("",!0)])),body:V((()=>[S(b)?(x(),$("div",Da,[(x(!0),$(Y,null,N(S(h).pagination.per_page,(a=>(x(),$("div",{key:a,class:"flex-table-item"},[z(v,null,{default:V((()=>[z(p,{lines:2,"last-line-width":"70%",class:"mx-2"})])),_:1})])))),128))])):D("",!0),0===S(h).data.length?(x(),$("div",Oa,[z(y,{title:a.$t("No_data"),subtitle:a.$t("There_is_no_data_that_match_your_query"),class:"my-6"},{image:V((()=>[Ba,Fa])),_:1},8,["title","subtitle"])])):D("",!0)])),"body-cell":V((({row:a,column:e})=>["name"===e.key?(x(),$("a",{key:0,href:"javascript:;",class:"has-text-primary",onClick:e=>{return l=a,L.value=l,void(P.value=!0);var l}},w(a.first_name)+" "+w(a.last_name)+" "+w(a.father_name),9,Ia)):D("",!0)])),_:1},8,["no-header"]),S(h).data.length?(x(),j(f,{key:0,"current-page":S(C),"onUpdate:current-page":e[0]||(e[0]=a=>T(C)?C.value=a:null),class:"mt-5","item-per-page":S(h).pagination.per_page,"total-items":S(h).pagination.total,"no-router":""},null,8,["current-page","item-per-page","total-items"])):D("",!0)])),_:1},8,["columns","data","limit","total"])])]),z(ba,{"is-open":S(P),"onUpdate:is-open":e[1]||(e[1]=a=>T(P)?P.value=a:null),patient:S(L),onClose:K,onEmergencyNoticing:e[2]||(e[2]=a=>R.value=!S(R))},null,8,["is-open","patient"]),z(I,{"is-open":S(R),"onUpdate:is-open":e[3]||(e[3]=a=>T(R)?R.value=a:null),patient:S(L)},null,8,["is-open","patient"])])}}}),[["__scopeId","data-v-8fea351b"]]);export{Ma as default};
