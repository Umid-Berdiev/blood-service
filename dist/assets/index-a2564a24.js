import{f as a,s as e,a as t,_ as l,b as s}from"./FilterForm.vue_vue_type_script_setup_true_lang-d0848924.js";import{_ as n}from"./VModal.vue_vue_type_style_index_0_lang-52241399.js";import{_ as i}from"./SubmitButton.vue_vue_type_script_setup_true_lang-9075dd9c.js";import{b as o,_ as d,a as u}from"./VControl-c4bfd6d4.js";import{_ as r}from"./VInput.vue_vue_type_script_setup_true_lang-fcf9b43c.js";import{_}from"./VFlex.vue_vue_type_style_index_0_lang-84415715.js";import{_ as p}from"./DatePicker.vue_vue_type_script_setup_true_lang-30441cda.js";import{_ as c}from"./VFlexItem.vue_vue_type_style_index_0_lang-919d6b99.js";import{q as m,H as v,C as y,x as h,r as b,a7 as g,y as f,o as x,a as V,w as j,e as k,t as w,k as $,$ as z,ad as C,d as U,g as D,i as O,L as B,M as F,E as H,J as T,K as q,F as A,l as I,U as R}from"./index-c5546e3f.js";import{_ as M}from"./_plugin-vue_export-helper-1b428a4d.js";import{_ as P,a as S,b as Y}from"./VFlexTable.vue_vue_type_style_index_0_lang-0fb083a3.js";import{_ as L,a as N}from"./VPlaceloadText.vue_vue_type_style_index_0_lang-1679fcf5.js";import{_ as W}from"./NoDataPlaceholder-02547c33.js";import{_ as E}from"./VBreadcrumb.vue_vue_type_style_index_0_lang-d20f193a.js";import{u as J}from"./main-94385ff1.js";import{u as K}from"./viewWrapper-911093a6.js";import"./VTextarea.vue_vue_type_script_setup_true_lang-5e0ed005.js";import"./VCheckbox.vue_vue_type_style_index_0_lang-494fdb99.js";import"./VRadio.vue_vue_type_style_index_0_lang-39e5fd57.js";import"./moment-6d6279b4.js";import"./VCard.vue_vue_type_script_setup_true_lang-9ddefd9d.js";import"./ClearButton.vue_vue_type_script_setup_true_lang-e2cdf555.js";import"./VButton.vue_vue_type_style_index_0_lang-6deaaf11.js";import"./additional-2c3a91bb.js";import"./ClientOnly.vue_vue_type_script_lang-fed4a332.js";const Z=a=>(B("data-v-341eabf2"),a=a(),F(),a),G={class:"columns"},Q={class:"column"},X={class:"is-size-5 has-text-weight-medium"},aa={class:"box"},ea={class:"mr-3 is-size-6"},ta={class:"has-text-weight-bold"},la=Z((()=>k("br",null,null,-1))),sa={class:"table-container"},na={class:"table box is-fullwidth"},ia={for:"hbsag"},oa=["disabled"],da={class:"ml-2"},ua={key:0,class:"has-text-danger ml-2"},ra={for:"hiv"},_a=["disabled"],pa={class:"ml-2"},ca={key:0,class:"has-text-danger ml-2"},ma={for:"antihcv"},va=["disabled"],ya={class:"ml-2"},ha={key:0,class:"has-text-danger ml-2"},ba={for:"rw"},ga=["disabled"],fa={class:"ml-2"},xa={key:0,class:"has-text-danger ml-2"},Va={for:"hemolysis"},ja={class:"ml-2"},ka={for:"chilez"},wa={class:"ml-2"},$a=Z((()=>k("p",{class:"has-text-danger"}," Красным цветом указаны показатели, заданные врачом-терапевтом, как обязательные для определения ",-1))),za=M(m({__name:"ResearchAimedFormModal",props:{isOpen:{type:Boolean,default:!1},patient:null},emits:["update:isOpen","update:list"],setup(t,{emit:l}){const s=t,m=v(),{t:B}=y(),F=h(B("Hemotransmission_research_results")),H=h(!1),T=b({date_analysis:[]}),q=g(new Date,"YYYY-MM-DD"),A=b({data:{date_analysis:q,hbsag:!1,hbsag_test_system:"",hiv:!1,hiv_test_system:"",antihcv:!1,antihcv_test_system:"",rw:!1,rw_test_system:"",hemolysis:!1,chilez:!1},required_fields:[]}),I=h(!1);async function R(){var a,t,n,i,o,d;try{H.value=!0,await e(null==(t=null==(a=s.patient)?void 0:a.last_visit)?void 0:t.id,A.data),m.success(B("Data_saved_successfully")),l("update:list"),M()}catch(u){(null==(n=u.response)?void 0:n.data.error)?m.error(null==(i=u.response)?void 0:i.data.error):Object.assign(T,null==(d=null==(o=u.response)?void 0:o.data)?void 0:d.errors)}finally{H.value=!1}}function M(){A.data={date_analysis:q,hbsag:!1,hbsag_test_system:"",hiv:!1,hiv_test_system:"",antihcv:!1,antihcv_test_system:"",rw:!1,rw_test_system:"",hemolysis:!1,chilez:!1},Object.assign(T,{date_analysis:[]}),l("update:isOpen",!1)}return f((()=>{var a,e;return null==(e=null==(a=s.patient)?void 0:a.last_visit)?void 0:e.id}),(async e=>{var t;if(e){const l=await a(e);Object.assign(A,l.result),(t=A.data).date_analysis||(t.date_analysis=q)}})),f([()=>A.data.hemolysis,()=>A.data.chilez],(async a=>{a.includes(!0)?(A.data.hbsag=!1,A.data.hiv=!1,A.data.antihcv=!1,A.data.rw=!1,I.value=!0):I.value=!1})),(a,e)=>{const l=c,s=p,m=_,v=o,y=r,h=d,b=u,g=i,f=n;return x(),V(f,{ref:"hemotransmissionLaboratoryForm",open:t.isOpen,size:"big",title:F.value,actions:"right",onClose:M},{content:j((()=>{var n,i;return[k("div",G,[k("div",Q,[k("h5",X,w(a.$t("Donation_code"))+": "+w(null==(i=null==(n=t.patient)?void 0:n.last_visit)?void 0:i.donation_code),1)])]),k("div",aa,[$(m,{"flex-wrap":"wrap","row-gap":"2rem","justify-content":"space-between"},{default:j((()=>[$(l,{"flex-basis":"45%"},{default:j((()=>{var e,l,s;return[k("span",null,w(a.$t("Blood_sampling_date"))+": ",1),k("span",null,w(null==(s=null==(l=null==(e=t.patient)?void 0:e.last_visit)?void 0:l.blood_sample)?void 0:s.date),1)]})),_:1}),$(l,{"flex-basis":"45%"},{default:j((()=>{var e,l,s;return[k("span",null,w(a.$t("Blood_samples_taken_date"))+": ",1),k("span",null,w(null==(s=null==(l=null==(e=t.patient)?void 0:e.last_visit)?void 0:l.blood_sample)?void 0:s.hemotransmissible_date),1)]})),_:1}),$(l,{"flex-basis":"45%"},{default:j((()=>[k("span",ea,w(a.$t("Analysis_date"))+": ",1),$(s,{modelValue:A.data.date_analysis,"onUpdate:modelValue":e[0]||(e[0]=a=>A.data.date_analysis=a)},null,8,["modelValue"])])),_:1}),$(l,{"flex-basis":"45%",class:"is-flex is-align-items-center"},{default:j((()=>{var e,l;return[k("h5",null,[k("span",ta,w(a.$t("Visit_stage")),1),k("span",null,w(null==(l=null==(e=t.patient)?void 0:e.last_visit)?void 0:l.stage),1)])]})),_:1})])),_:1})]),la,k("div",sa,[k("table",na,[k("tbody",null,[k("tr",null,[k("td",null,[k("label",ia,[z(k("input",{id:"hbsag","onUpdate:modelValue":e[1]||(e[1]=a=>A.data.hbsag=a),class:"checkbox",type:"checkbox",disabled:I.value},null,8,oa),[[C,A.data.hbsag]]),k("span",da,w(a.$t("HBsAg")),1),A.required_fields.includes("hbsag")?(x(),U("span",ua,"*")):D("",!0)])]),k("td",null,[$(b,{horizontal:"",class:"is-justify-content-end"},{default:j((()=>[$(v,{class:"is-size-6 my-auto mr-3"},{default:j((()=>[O(w(a.$t("Testing_system"))+" ("+w(a.$t("HBsAg"))+")",1)])),_:1}),$(h,null,{default:j((()=>[$(y,{modelValue:A.data.hbsag_test_system,"onUpdate:modelValue":e[2]||(e[2]=a=>A.data.hbsag_test_system=a)},null,8,["modelValue"])])),_:1})])),_:1})])]),k("tr",null,[k("td",null,[k("label",ra,[z(k("input",{id:"hiv","onUpdate:modelValue":e[3]||(e[3]=a=>A.data.hiv=a),class:"checkbox",type:"checkbox",disabled:I.value},null,8,_a),[[C,A.data.hiv]]),k("span",pa,w(a.$t("OIDS")),1),A.required_fields.includes("hiv")?(x(),U("span",ca,"*")):D("",!0)])]),k("td",null,[$(b,{horizontal:"",class:"is-justify-content-end"},{default:j((()=>[$(v,{class:"is-size-6 my-auto mr-3"},{default:j((()=>[O(w(a.$t("Testing_system"))+" ("+w(a.$t("OIDS"))+")",1)])),_:1}),$(h,null,{default:j((()=>[$(y,{modelValue:A.data.hiv_test_system,"onUpdate:modelValue":e[4]||(e[4]=a=>A.data.hiv_test_system=a)},null,8,["modelValue"])])),_:1})])),_:1})])]),k("tr",null,[k("td",null,[k("label",ma,[z(k("input",{id:"antihcv","onUpdate:modelValue":e[5]||(e[5]=a=>A.data.antihcv=a),class:"checkbox",type:"checkbox",disabled:I.value},null,8,va),[[C,A.data.antihcv]]),k("span",ya,w(a.$t("AntiHCV")),1),A.required_fields.includes("antihcv")?(x(),U("span",ha,"*")):D("",!0)])]),k("td",null,[$(b,{horizontal:"",class:"is-justify-content-end"},{default:j((()=>[$(v,{class:"is-size-6 my-auto mr-3"},{default:j((()=>[O(w(a.$t("Testing_system"))+" ("+w(a.$t("AntiHCV"))+")",1)])),_:1}),$(h,null,{default:j((()=>[$(y,{modelValue:A.data.antihcv_test_system,"onUpdate:modelValue":e[6]||(e[6]=a=>A.data.antihcv_test_system=a)},null,8,["modelValue"])])),_:1})])),_:1})])]),k("tr",null,[k("td",null,[k("label",ba,[z(k("input",{id:"rw","onUpdate:modelValue":e[7]||(e[7]=a=>A.data.rw=a),class:"checkbox",type:"checkbox",disabled:I.value},null,8,ga),[[C,A.data.rw]]),k("span",fa,w(a.$t("RW")),1),A.required_fields.includes("rw")?(x(),U("span",xa,"*")):D("",!0)])]),k("td",null,[$(b,{horizontal:"",class:"is-justify-content-end"},{default:j((()=>[$(v,{class:"is-size-6 my-auto mr-3"},{default:j((()=>[O(w(a.$t("Testing_system"))+" ("+w(a.$t("RW"))+")",1)])),_:1}),$(h,null,{default:j((()=>[$(y,{modelValue:A.data.rw_test_system,"onUpdate:modelValue":e[8]||(e[8]=a=>A.data.rw_test_system=a)},null,8,["modelValue"])])),_:1})])),_:1})])]),k("tr",null,[k("td",null,[k("label",Va,[z(k("input",{id:"hemolysis","onUpdate:modelValue":e[9]||(e[9]=a=>A.data.hemolysis=a),class:"checkbox",type:"checkbox"},null,512),[[C,A.data.hemolysis]]),k("span",ja,w(a.$t("Hemolis")),1)])])]),k("tr",null,[k("td",null,[k("label",ka,[z(k("input",{id:"chilez","onUpdate:modelValue":e[10]||(e[10]=a=>A.data.chilez=a),class:"checkbox",type:"checkbox"},null,512),[[C,A.data.chilez]]),k("span",wa,w(a.$t("Hiles")),1)])])])])]),$a])]})),action:j((()=>[$(g,{loading:H.value,onClick:R},null,8,["loading"])])),_:1},8,["open","title"])}}}),[["__scopeId","data-v-341eabf2"]]),Ca={class:"page-content-inner"},Ua={class:"columns mb-3"},Da={class:"column"},Oa={class:"columns mt-1"},Ba={class:"column"},Fa={class:"columns"},Ha={class:"column is-12"},Ta={key:0,class:"is-flex-grow-0",textContent:"#"},qa={key:0,class:"flex-list-inner"},Aa=["onClick"],Ia=M(m({__name:"index",setup(a){H(),v();const{t:e}=y(),n=J(),i=h(!1);K().setPageTitle(e("Bloodborne-infections-laboratory")),T({title:`${e("Research-aimed-donations-list")} - ${n.app.name}`});const o=b({data:[],pagination:{total:10,count:10,per_page:10,current_page:1,total_pages:1}}),d={orderNumber:{format:(a,e,t)=>`${t+1}`,cellClass:"is-flex-grow-0"},donation_code:{label:e("Donation_code"),format:(a,e)=>{var t;return null==(t=e.last_visit)?void 0:t.donation_code}},blood_sampling_date:{label:e("Blood_sampling_date"),format:(a,e)=>{var t,l;return null==(l=null==(t=e.last_visit)?void 0:t.blood_sample)?void 0:l.date}},name:{label:e("Donor_fullname")},birth_date:{label:e("Date-of-birth")},visit_type:{label:e("Visit_type"),format:(a,t)=>{var l,s;return(null==(l=t.last_visit)?void 0:l.visit_type)&&e(null==(s=t.last_visit)?void 0:s.visit_type)}},visit_date:{label:e("Visit_date"),format:(a,e)=>{var t;return null==(t=e.last_visit)?void 0:t.created_at}},donation_type:{label:e("Donation_type"),format:(a,e)=>{var t,l;return null==(l=null==(t=e.last_visit)?void 0:t.donation_type)?void 0:l.name}},visit_stage:{label:e("Visit_stage"),format:(a,e)=>{var t,l;return null==(l=null==(t=e.last_visit)?void 0:t.stage)?void 0:l.name}}},u=b({visit_type_id:[],donation_type_id:[],donation_code:[]}),r=b({visit_type_id:"",donation_type_id:null,donation_code:"",page:1}),_=h(null),p=h(!1),c=h(!1);async function m(a){var e,l;try{i.value=!0,Object.assign(r,a);const e=await t(a);Object.assign(o,e.result)}catch(s){Object.assign(u,null==(l=null==(e=s.response)?void 0:e.data)?void 0:l.errors)}finally{i.value=!1}}async function g(){await m(r)}function z(){_.value=null}return f((()=>o.pagination.current_page),(async a=>{a&&(r.page=a,await m(r))}),{immediate:!0}),(a,e)=>{const t=E,u=L,r=P,v=W,y=S,h=N,b=Y,f=za,C=s;return x(),U("div",Ca,[k("div",Ua,[k("div",Da,[$(t,{"with-icons":"",separator:"bullet",items:[{label:q(n).app.name,hideLabel:!0,icon:"feather:home",to:{name:"/app/dashboard"}},{label:a.$t("Bloodborne-infections-laboratory")},{label:a.$t("Research-aimed-donations-list")}]},null,8,["items"])])]),k("div",Oa,[k("div",Ba,[$(l,{"is-loading":q(i),onSearch:m,onClearForm:g},null,8,["is-loading"])])]),k("div",Fa,[k("div",Ha,[$(b,{columns:q(d),data:q(o).data,limit:q(o).pagination.per_page,total:q(o).pagination.total},{default:j((()=>[$(y,{rounded:"","no-header":!q(i)&&0===q(o).data.length},{"header-column":j((({column:a})=>["orderNumber"===a.key?(x(),U("span",Ta)):D("",!0)])),body:j((()=>[q(i)?(x(),U("div",qa,[(x(!0),U(A,null,I(q(o).pagination.per_page,(a=>(x(),U("div",{key:a,class:"flex-table-item"},[$(r,null,{default:j((()=>[$(u,{lines:2,"last-line-width":"70%",class:"mx-2"})])),_:1})])))),128))])):D("",!0),0===q(o).data.length?(x(),V(v,{key:1})):D("",!0)])),"body-cell":j((({row:a,column:e})=>["name"===e.key?(x(),U("a",{key:0,href:"javascript:;",class:"has-text-primary",onClick:e=>{return t=a,_.value=t,void(p.value=!0);var t}},w(a.first_name)+" "+w(a.last_name)+" "+w(a.father_name)+" ",9,Aa)):D("",!0)])),_:1},8,["no-header"]),q(o).data.length?(x(),V(h,{key:0,"current-page":q(o).pagination.current_page,"onUpdate:current-page":e[0]||(e[0]=a=>q(o).pagination.current_page=a),class:"mt-5","item-per-page":q(o).pagination.per_page,"total-items":q(o).pagination.total,"no-router":""},null,8,["current-page","item-per-page","total-items"])):D("",!0)])),_:1},8,["columns","data","limit","total"])])]),$(f,{"is-open":q(p),"onUpdate:is-open":e[1]||(e[1]=a=>R(p)?p.value=a:null),patient:q(_),onClose:z},null,8,["is-open","patient"]),$(C,{"is-open":q(c),"onUpdate:is-open":e[2]||(e[2]=a=>R(c)?c.value=a:null),patient:q(_)},null,8,["is-open","patient"])])}}}),[["__scopeId","data-v-8d105eb6"]]);export{Ia as default};
